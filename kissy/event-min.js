/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Jul 20 18:42
*/
KISSY.add("event/base",function(p,c,m,j){function o(a,d,l){if((l=p.trim(l))&&l.indexOf(r)>0){var q=p.makeArray(arguments);p.each(l.split(r),function(k){var g=p.clone(q);g.splice(0,3,d,k);b[a].apply(b,g)});return true}return j}function e(a){return a&&a.nodeType!==3&&a.nodeType!==8}function n(a,d,l,q,k){var g=b.special[d]||{};if(!q.length&&(!g.setup||g.setup.call(a)===false))i(a,d,l);g.add&&g.add.call(a,k)}var f=document,i=f.addEventListener?function(a,d,l,q){a.addEventListener&&a.addEventListener(d,
l,!!q)}:function(a,d,l){a.attachEvent&&a.attachEvent("on"+d,l)},u=f.removeEventListener?function(a,d,l,q){a.removeEventListener&&a.removeEventListener(d,l,!!q)}:function(a,d,l){a.detachEvent&&a.detachEvent("on"+d,l)},r=" ",t="",h="trigger-none-"+p.now(),z="ksEventTargetId"+p.now(),b={_data:function(){var a=p.makeArray(arguments);a.splice(1,0,z);return c.data.apply(c,a)},_removeData:function(){var a=p.makeArray(arguments);a.splice(1,0,z);return c.removeData.apply(c,a)},special:{},add:function(a,d,
l,q,k){if(o("add",a,d,l,q,k))return a;c.query(a).each(function(g){var w=!g.isCustomEventTarget,s;if(!(!g||!d||!p.isFunction(l)||w&&!e(g))){(s=b._data(g))||b._data(g,s={});var v=s.events=s.events||{};v=v[d]=v[d]||[];var A={fn:l,scope:q||g,data:k},x=s.handler;if(!x){x=s.handler=function(y,B){if(!(y&&y.type==t)){var D=x.target;if(!y||!y.fixed)y=new m(D,y);p.isPlainObject(B)&&p.mix(y,B);return b._handle(D,y)}};x.target=g}if(w){n(g,d,x,v,A);g=null}v.push(A)}});return a},__getListeners:function(a,d){return(b.__getEvents(a)||
{})[d]||[]},__getEvents:function(a){return(a=b._data(a))&&a.events},remove:function(a,d,l,q,k){if(o("remove",a,d,l,q))return a;c.query(a).each(function(g){var w=b._data(g),s=w&&w.events,v,A,x,y,B,D=!g.isCustomEventTarget,F=D&&b.special[d]||{};if(!(!g||!D&&!e(g)||!s))if(d===j)for(d in s)b.remove(g,d);else{q=q||g;if(v=s[d]){A=v.length;if(p.isFunction(l)&&A){y=x=0;for(B=[];x<A;++x){var G=false,C=v[x];if(l!==C.fn||q!==C.scope){B[y++]=C;G=true}else if(k!==E){var E=C.data;if(!k&&E||E&&!k){B[y++]=C;G=true}else if(k&&
E)if(k.equals&&E.equals)if(!E.equals(k)){B[y++]=C;G=true}}!G&&F.remove&&F.remove.call(g,C)}s[d]=B;A=B.length}if(l===j||A===0){if(D&&(!F.tearDown||F.tearDown.call(g)===false))u(g,d,w.handler);delete s[d]}}if(p.isEmptyObject(s)){w.handler.target=null;delete w.handler;delete w.events;b._removeData(g)}}});return a},_handle:function(a,d){for(var l=b.__getListeners(a,d.type).slice(0),q,k,g=0,w=l.length;g<w;++g){q=l[g];q=q.fn.call(q.scope,d,q.data);if(q!==j){if(k!==false)k=q;q===false&&d.halt()}if(d.isImmediatePropagationStopped)break}return k},
fire:function(a,d,l){if(!o("fire",a,d,l)){var q;c.query(a).each(function(k){var g=!k.isCustomEventTarget;l=l||{};l.type=d;if(g){g=l;var w;if(e(k)){g=new m(k,g);var s=g.target=k,v="on"+d;do{var A=(b._data(s)||{}).handler;g.currentTarget=s;A&&A.call(s,g);if(s[v]&&s[v].call(s)===false){w=false;g.preventDefault()}s=s.parentNode||s.ownerDocument||s===k.ownerDocument&&window}while(s&&!g.isPropagationStopped);if(!g.isDefaultPrevented)if(!(d==="click"&&k.nodeName.toLowerCase()=="a")){var x;try{if(v&&k[d]){if(x=
k[v])k[v]=null;t=d;k[d]()}}catch(y){}if(x)k[v]=x;t=h}}k=w;if(k!==j)q=k}else if((k=b._data(k))&&p.isFunction(k.handler))q=k.handler(j,l)});return q}},_batchForType:o,_simpleAdd:i,_simpleRemove:u};b.on=b.add;b.detach=b.remove;return b},{requires:["dom","event/object"]});
KISSY.add("event/delegate",function(p,c,m){function j(f){return f.fn===undefined&&f.selector===undefined?true:f.fn===undefined?this.selector==f.selector:this.fn==f.fn&&this.selector==f.selector&&this.scope==f.scope}function o(f,i){var u,r=c.closest(f.target,[i.selector],this);if(r)for(var t=0;t<r.length;t++){f.currentTarget=r[t];var h=i.fn.call(i.scope||this,f);if(h===false||f.isPropagationStopped||f.isImmediatePropagationStopped){if(h===false)u=h;if(f.isPropagationStopped||f.isImmediatePropagationStopped)break}}return u}
var e=m._batchForType,n={focus:"focusin",blur:"focusout"};p.mix(m,{delegate:function(f,i,u,r,t){if(e("delegate",f,i,u,r,t))return f;c.query(f).each(function(h){if(!h.isCustomEventTarget){i=n[i]||i;m.on(h,i,o,h,{fn:r,selector:u,scope:t,equals:j})}});return f},undelegate:function(f,i,u,r,t){if(e("undelegate",f,i,u,r,t))return f;c.query(f).each(function(h){if(!h.isCustomEventTarget){i=n[i]||i;m.remove(h,i,o,h,{fn:r,selector:u,scope:t,equals:j})}});return f}});return m},{requires:["dom","./base"]});
KISSY.add("event/focusin",function(p,c,m){c.ie||p.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(j){function o(n){return m.fire(n.target,j.name)}var e=0;m.special[j.name]={setup:function(){e++===0&&document.addEventListener(j.fix,o,true)},tearDown:function(){--e===0&&document.removeEventListener(j.fix,o,true)}}});return m},{requires:["ua","./base"]});
KISSY.add("event/hashchange",function(p,c,m,j){j=document.documentMode||j.ie;if(!("onhashchange"in window)||j<8){var o=function(){return"#"+location.href.replace(/^[^#]*#?(.*)$/,"$1")},e=function(){n()},n=function(){var h=o();if(h!==t){f(h);t=h}u=setTimeout(n,50)},f=function(h){i(h)},i=function(){for(var h=0;h<r.length;h++)c._handle(r[h],{type:"hashchange"})},u,r=[],t=o();c.special.hashchange={setup:function(){-1===p.indexOf(this,r)&&r.push(this);u||e()},tearDown:function(){var h=p.indexOf(this,r);
h>=0&&r.splice(h,1);if(r.length===0){u&&clearTimeout(u);u=null}}};j<8&&function(){var h;e=function(){if(!h){h=m.create('<iframe style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');m.prepend(h,document.documentElement);c.add(h,"load",function(){c.remove(h,"load");f(o());c.add(h,"load",z);n()});var z=function(){var b=p.trim(h.contentWindow.document.body.innerHTML),a=o();if(b!=a)t=location.hash=b;i(b)}}};f=function(z){z="<html><body>"+z+"</body></html>";var b=h.contentWindow.document;
try{b.open();b.write(z);b.close();return true}catch(a){return false}}}()}},{requires:["./base","dom","ua"]});
KISSY.add("event/mouseenter",function(p,c,m,j){j.ie||p.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(o){function e(n){var f=this,i=n.relatedTarget;n.type=o.name;try{if(!(i&&i!==document&&!i.parentNode)){i=m.closest(i,function(r){return r==f});i!==f&&c._handle(f,n)}}catch(u){}}c.special[o.name]={setup:function(){c.add(this,o.fix,e)},tearDown:function(){c.remove(this,o.fix,e)}}});return c},{requires:["./base","dom","ua"]});
KISSY.add("event/object",function(p,c){function m(e,n,f){this.currentTarget=e;this.originalEvent=n||{};if(n){this.type=n.type;this._fix()}else{this.type=f;this.target=e}this.currentTarget=e;this.fixed=true}var j=document,o="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
p.augment(m,{_fix:function(){var e=this.originalEvent,n=o.length,f,i=this.currentTarget;for(i=i.nodeType===9?i:i.ownerDocument||j;n;){f=o[--n];this[f]=e[f]}if(!this.target)this.target=this.srcElement||j;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===c&&this.clientX!==c){e=i.documentElement;n=i.body;this.pageX=this.clientX+(e&&e.scrollLeft||n&&n.scrollLeft||
0)-(e&&e.clientLeft||n&&n.clientLeft||0);this.pageY=this.clientY+(e&&e.scrollTop||n&&n.scrollTop||0)-(e&&e.clientTop||n&&n.clientTop||0)}if(this.which===c)this.which=this.charCode!==c?this.charCode:this.keyCode;if(this.metaKey===c)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==c)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var e=this.originalEvent;if(e.preventDefault)e.preventDefault();else e.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var e=
this.originalEvent;if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var e=this.originalEvent;e.stopImmediatePropagation?e.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(e){e?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return m});
KISSY.add("event/target",function(p,c){return{isCustomEventTarget:true,fire:function(m,j){return c.fire(this,m,j)},on:function(m,j,o){c.add(this,m,j,o);return this},detach:function(m,j,o){c.remove(this,m,j,o);return this}}},{requires:["./base","dom"]});
KISSY.add("event/valuechange",function(p,c,m){function j(b){var a=m.data(b,r);if(!a){a=+new Date;m.data(b,r,a)}return a}function o(b){b=j(b);delete t[b];if(h[b]){clearTimeout(h[b]);delete h[b]}}function e(b){o(b.target)}function n(b){var a=j(b);h[a]||(h[a]=setTimeout(function(){var d=b.value;if(d!==t[a]){c._handle(b,{type:u,prevVal:t[a],newVal:d});t[a]=d}h[a]=setTimeout(arguments.callee,z)},z))}function f(b){var a=b.target;if(b.type=="focus"){b=j(a);t[b]=a.value}n(a)}function i(b){o(b);c.remove(b,
"blur",e);c.remove(b,"mousedown keyup keydown focus",f);m.removeData(b,r)}var u="valueChange",r="event/valuechange",t={},h={},z=50;c.special[u]={fix:false,setup:function(){var b=this.nodeName.toLowerCase();if("input"==b||"textarea"==b){i(this);c.on(this,"blur",e);c.on(this,"mousedown keyup keydown focus",f)}},tearDown:function(){i(this)}};return c},{requires:["./base","dom"]});
KISSY.add("event",function(p,c,m,j){c.Target=m;c.Object=j;return c},{requires:["event/base","event/target","event/object","event/focusin","event/hashchange","event/valuechange","event/delegate","event/mouseenter"]});
