/*
 Constructor for kissy editor,dependency moved to independent module
 thanks to CKSource's intelligent work on CKEditor
 @author: yiminghe@gmail.com, lifesinger@gmail.com
 @version: 2.1.5
 @buildtime: 2011-01-12 23:00:39
*/
var T=true,U=null,Y=false;
KISSY.add("editor",function(k){function y(s,q){var m=this;if(!(m instanceof y))return new y(s,q);if(k.isString(s))s=k.one(s);s=I.C(s);q=q||{};q.Af=q.pluginConfig||{};m.va=q;q.pluginConfig=q.Af;m.cfg=q;k.app(m,k.EventTarget);var e=["htmldataprocessor","enterkey","clipboard"],f=A;m.use=function(d,i){d=d.split(",");if(!f)for(var u=0;u<e.length;u++){var j=e[u];k.inArray(j,d)||d.unshift(j)}m.ready(function(){k.use.call(m,d.join(","),function(){for(var a=0;a<d.length;a++)m.Yd(d[a]);i&&i.call(m);if(!f){m.setData(s.val());
if(q.focus)m.focus();else(a=m.getSelection())&&a.removeAllRanges();f=C}},{global:y})});return m};m.use=m.use;m.Config.base=y.Config.base;m.Config.debug=y.Config.debug;m.Config.componentJsName=p;m.qf(s);return m}function p(){return"plugin-min.js?t=2011-01-12 23:00:39"}var I=k.DOM,C=T,A=Y;k.app(y,k.EventTarget);y.Config.base=k.Config.base+"editor/plugins/";y.Config.debug=k.Config.debug;y.Config.componentJsName=p;k.Editor=y;k.Editor=y});
KISSY.Editor.add("utils",function(k){var y=U,p=KISSY,I=p.Node,C=p.DOM,A=p.UA,s=p.Event,q;if(A.ie)q=document.documentMode||A.ie;var m={nd:function(e){e=e.replace(/-min\.(js|css)/i,".$1");k.Config.Kg||(e=e.replace(/\.(js|css)/i,"-min.$1"));if(e.indexOf("?t")==-1){e+=e.indexOf("?")!=-1?"&":"?";e+="t=2011-01-12 19:32:53"}return k.Config.Dg+e},Hd:function(e,f,d){var i=e[f],u=e[d];e[f]=function(){i.apply(this,arguments);e[f]=e[d];return u.apply(this,arguments)}},mf:function(e,f,d,i){d=d.defaultView||d.parentWindow;
e-=C.scrollLeft(d);f-=C.scrollTop(d);if(i)if(d!=(i.defaultView||i.parentWindow)&&d.frameElement){i=C.Qb(d.frameElement,i);e+=i.left;f+=i.top}return{left:e,top:f}},Xd:function(){for(var e,f=0,d=arguments.length;f<d;f++){var i=arguments[f];try{e=i();break}catch(u){}}return e},Me:function(e,f){if(!e&&!f)return T;if(!e||!f||e.length!=f.length)return Y;for(var d=0;d<e.length;d++)if(e[d]!==f[d])return Y;return T},vd:function(e,f,d){e=e.documentElement;for(var i=0;e&&i<f.length;i++){var u=f[i];if(d)for(var j=
-1,a=0;a<e.childNodes.length;a++){var b=e.childNodes[a];if(!(d===T&&b.nodeType==3&&b.previousSibling&&b.previousSibling.nodeType==3)){j++;if(j==u){e=b;break}}}else e=e.childNodes[u]}return e?new I(e):y},Ue:function(e){for(var f in e)e[f].Pc(e,T)},pc:function(e){return e.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/,"&gt;")},Qa:function(e){return e.replace(/^\s+/,"")},Sa:function(e){return e.replace(/\s+$/,"")},trim:function(e){return this.Qa(this.Sa(e))},mix:function(){for(var e={},f=0;f<
arguments.length;f++)e=p.mix(e,arguments[f]);return e},qb:function(){if(!A.ie)return Y;var e=document.domain,f=window.location.hostname;return e!=f&&e!="["+f+"]"},af:function(e,f){return Array(f+1).join(e)},Lf:function(e,f,d){d=d||150;if(d===-1)return function(){e.apply(f,arguments)};var i=(new Date).getTime();return function(){var u=(new Date).getTime();if(u-i>d){i=u;e.apply(f,arguments)}}},Qe:function(e,f,d){d=d||0;var i=y;return function(){i&&clearTimeout(i);var u=arguments;i=setTimeout(function(){return e.apply(f,
u)},d)}},isNumber:function(e){return/^\d+(.\d+)?$/.test(p.trim(e))},Nf:function(e){for(var f=0;f<e.length;f++){var d=C.C(e[f]),i=p.trim(d.val()),u=d.attr("data-verify");d=d.attr("data-warning");if(u&&!RegExp(u).test(i)){alert(d);return Y}}return T},Hf:function(e,f){e.on("sourcemode",f.od,f);e.on("wysiwygmode",f.qd,f)},Df:function(e){var f=e.attr("placeholder");if(f&&!A.webkit){e.addClass("ke-input-tip");e.val(f)}else A.webkit&&e.val("")},kh:function(e,f){e.removeClass("ke-input-tip");e.val(f)},zf:function(e,
f){e.attr("placeholder",f);if(!A.webkit){e.on("blur",function(){if(!p.trim(e.val())){e.addClass("ke-input-tip");e.val(f)}});e.on("focus",function(){e.removeClass("ke-input-tip");p.trim(e.val())==f&&e.val("")})}},Te:function(e){e=e[0]||e;for(var f=p.makeArray(e.childNodes),d=0;d<f.length;d++){var i=f[d];i.nodeType==k.n.f&&!p.trim(i.nodeValue)&&e.removeChild(i)}},pf:function(e){return!e?e:String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},of:function(e){return!e?
e:String(e).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},ef:function(e,f){return e.toLowerCase()==f.toLowerCase()},Id:function(e){e=p.clone(e);for(var f in e)if(e.hasOwnProperty(f)){var d=e[f];if(p.isFunction(d))e[f]=d()}return e},$e:function(e,f,d){function i(){var z={responseText:"",responseXML:y};z.Le=e?e.Le:y;try{var B;if((B=A.ie?j.contentWindow.document:j.contentDocument||window.frames[u].document)&&B.body)z.responseText=B.body.innerHTML;z.responseXML=
B&&B.XMLDocument?B.XMLDocument:B}catch(r){p.log(r)}s.remove(j,"load",i);e.Re&&e.Re(z);setTimeout(function(){C.h(j)},100)}var u=p.guid("form-upload-"),j=document.createElement("iframe");j.id=u;j.name=u;j.className="ke-hidden";var a="document.open();"+(m.qb()?'document.domain="'+document.domain+'";':"")+"document.close();";if(A.ie)j.src=A.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";p.log("doFormUpload : "+j.src);document.body.appendChild(j);if(A.ie)document.frames[u].name=u;a=C.Wc(e.form);
var b={target:a.target,method:a.method,encoding:a.encoding,enctype:a.enctype,action:a.action};a.target=u;a.method="POST";a.enctype=a.encoding="multipart/form-data";if(d)a.action=d;var g;if(f){g=[];f=k.k.Id(f);for(var o in f)if(f.hasOwnProperty(o)){d=document.createElement("input");d.type="hidden";d.name=o;d.value=f[o];a.appendChild(d);g.push(d)}}s.on(j,"load",i);a.submit();a.target=b.target;a.method=b.method;a.enctype=b.enctype;a.encoding=b.encoding;a.action=b.action;if(g){f=0;for(o=g.length;f<o;f++)C.h(g[f])}return j},
o:function(e,f){for(var d in f)e[d]=f[d]},map:function(e,f){for(var d=0;d<e.length;d++)e[d]=f(e[d]);return e},Ba:q,Bf:function(e){A.ie?e.ta():e.attr("onmousedown","return false;")},Wg:function(e){e=e.attributes;return e.type=="application/x-shockwave-flash"||/\.swf(?:$|\?)/i.test(e.src||"")},Je:function(){var e=this.ib=this.ib||[];e.push.apply(e,p.makeArray(arguments))},Ze:function(){for(var e=this.ib||[],f=0;f<e.length;f++){var d=e[f];if(p.isFunction(d))d();else{d.detach&&d.detach();d.za&&d.za();
d.nodeType&&d.remove&&d.remove()}}this.ib=[]}};k.k=m;k.Utils=m;A.Ba=m.Ba;m.o(m,{debugUrl:m.nd,lazyRun:m.Hd,getXY:m.mf,tryThese:m.Xd,arrayCompare:m.Me,getByAddress:m.vd,clearAllMarkers:m.Ue,htmlEncodeAttr:m.pc,ltrim:m.Qa,rtrim:m.Sa,trim:m.trim,mix:m.mix,isCustomDomain:m.qb,duplicateStr:m.af,buffer:m.Qe,isNumber:m.isNumber,verifyInputs:m.Nf,sourceDisable:m.Hf,resetInput:m.Df,placeholder:m.zf,clean:m.Te,htmlEncode:m.pf,htmlDecode:m.of,equalsIgnoreCase:m.ef,normParams:m.Id,throttle:m.Lf,doFormUpload:m.$e,
map:m.map})});
KISSY.Editor.add("dom",function(k){function y(a){if(a&&!a[0])return new q(a);return a}function p(a){return a[0]||a}function I(a){return a.replace(/-(\w)/g,function(b,g){return g.toUpperCase()})}var C=KISSY,A=C.DOM,s=C.UA,q=C.Node,m=k.k,e={abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1};k.n={e:1,f:3,de:8,cg:11};k.NODE=k.n;k.$a={ea:0,fe:1,da:2,$:4,Z:8,Kc:16};k.POSITION=
k.$a;var f=k.n,d=k.$a,i={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},u={hr:1},j={C:y,Wc:p,g:function(a,b){if(!a&&!b)return T;if(!a||!b)return Y;a=p(a);b=p(b);return a===b},qa:function(a,b){a=y(a);var g=C.mix(C.mix({},u),b||{});return i[a.css("display")]||g[a.d()]},ga:function(a){return a&&"scrollTo"in a&&a.document?a:a&&a.nodeType===9?a.defaultView||a.parentWindow:
Y},t:function(a){a=p(a);for(var b=a.parentNode.childNodes,g=0;g<b.length;g++)if(b[g]===a)return g;return-1},le:function(a,b){a=p(a);var g=a.firstChild;if((g=g&&new q(g))&&b&&!b(g))g=g.Ka(b);return g},Uc:function(a,b,g){a=p(a);A.h(a);b=p(b);g?b.insertBefore(a,b.firstChild):b.appendChild(a)},d:function(a){a=p(a);var b=a.nodeName.toLowerCase();if(s.ie)if((a=a.scopeName)&&a!="HTML")b=a.toLowerCase()+":"+b;return b},Sc:function(a,b){if(a.d()!=b.d())return Y;var g=a[0].attributes,o=b[0].attributes,z=g.length,
B=o.length;if(z!=B)return Y;for(var r=0;r<z;r++){var x=g[r],w=x.name;if(x.specified&&a.attr(w)!=b.attr(w))return Y}if(m.Ba<8)for(r=0;r<B;r++){x=o[r];w=x.name;if(x.specified&&a.attr(w)!=b.attr(w))return Y}return T},Sb:function(a){a=p(a).childNodes;for(var b=0,g=a.length;b<g;b++){var o=a[b],z=o.nodeType;if(!(z==f.e&&o.getAttribute("_ke_bookmark")))if(z==f.e&&!j.Sb(o)||z==f.f&&C.trim(o.nodeValue))return Y}return T},Tb:function(a,b,g){a=p(a);b=b[0]||b;if(a!=b)if(g)for(;g=a.lastChild;)b.insertBefore(a.removeChild(g),
b.firstChild);else for(;g=a.firstChild;)b.appendChild(a.removeChild(g))},ra:function(){function a(b,g,o){if(g[0]&&g[0].nodeType==f.e){for(var z=[];g.attr("_ke_bookmark")||g.Sb();){z.push(g);g=o?new q(g[0].nextSibling):new q(g[0].previousSibling);if(!g[0]||g[0].nodeType!=f.e)return}if(b.Sc(g)){for(var B=o?b[0].lastChild:b[0].firstChild;z.length;)z.shift().Uc(b,!o);g.Tb(b,!o);g.h();B[0]&&B[0].nodeType==f.e&&B.ra()}}}return function(b){if(b[0])if(e[b.d()]||b.d()=="a"){a(b,new q(b[0].nextSibling),T);
a(b,new q(b[0].previousSibling))}}}(),ta:s.gecko?function(a){a=p(a);a.style.MozUserSelect="none"}:s.webkit?function(a){a=p(a);a.style.$f="none"}:function(a){a=p(a);if(s.ie||s.opera){var b=0;a.setAttribute("unselectable","on");for(var g=a.getElementsByTagName("*");a=g[b++];)switch(a.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:a.setAttribute("unselectable","on")}}},Qb:function(a,b){a=p(a);var g,o=0;g=0;var z=a.ownerDocument.defaultView||a.ownerDocument.parentWindow,
B=a.ownerDocument,r=B.documentElement;b=b||B;if(a.getBoundingClientRect){if(a!==B.body&&r!==a){g=a.getBoundingClientRect();o=g.left+(b===B?A.scrollLeft(z):0);g=g.top+(b===B?A.scrollTop(z):0)}if(b)if(z!=(b.defaultView||b.parentWindow)&&z.frameElement){z=j.Qb(z.frameElement,b);o+=z.left;g+=z.top}}return{left:o,top:g}},ne:function(a){return(a=p(a))&&a.contentWindow.document},ia:function(a,b){a=p(a);var g=a.ownerDocument;if(!(!a||a.nodeType!=f.f)){if(s.ie&&b==a.nodeValue.length){var o=g.createTextNode("");
A.insertAfter(o,a);return new q(o)}o=new q(a.splitText(b));if(g.documentMode){g=g.createTextNode("");A.insertAfter(g,o[0]);A.h(g)}return o}},Ub:function(a,b){a=y(a);var g=[];do g[b?"push":"unshift"](a);while(a=a.parent());return g},K:function(a,b,g){a=p(a);a=a.cloneNode(b);if(!g){var o=function(z){if(z.nodeType==f.e){z.removeAttribute("id");z=z.childNodes;for(var B=0;B<z.length;B++)o(z[B])}};o(a)}return new q(a)},v:function(a,b,g,o){a=p(a);if(o&&!o.call){var z=o[0]||o;o=function(r){r=r[0]||r;return r!==
z}}b=!b&&a.firstChild;var B=new q(a);if(!b){if(a.nodeType==f.e&&o&&o(a,T)===Y)return U;b=a.nextSibling}for(;!b&&(B=B.parent());){if(o&&o(B,T)===Y)return U;b=B[0].nextSibling}if(!b)return U;b=A.C(b);if(o&&o(b)===Y)return U;if(g&&g!=b[0].nodeType)return b.v(Y,g,o);return b},ha:function(a,b,g,o){a=p(a);if(o&&!o.call){var z=o[0]||o;o=function(r){r=r[0]||r;return r!==z}}b=!b&&a.lastChild;var B=new q(a);if(!b){if(a.nodeType==f.e&&o&&o(a,T)===Y)return U;b=a.previousSibling}for(;!b&&(B=B.parent());){if(o&&
o(B,T)===Y)return U;b=B[0].previousSibling}if(!b)return U;b=A.C(b);if(o&&o(b)===Y)return U;if(g&&b[0].nodeType!=g)return b.ha(Y,g,o);return b},Pb:function(a,b){if(a.g(b))return a;if(b[0].nodeType!=f.f&&b.contains(a))return b;var g=a[0].nodeType==f.f?a.parent():a;do if(g[0].nodeType!=f.f&&g.contains(b))return g;while(g=g.parent());return U},Oc:function(a,b,g){a=p(a);if(!g)a=a.parentNode;if(b&&!C.isFunction(b)){var o=b;b=function(z){return z.d()==o}}for(;a&&a.nodeType!=9;){if(!b||b(new q(a))===T)return new q(a);
a=a.parentNode}return U},Rb:m.Ba<9?function(a,b){a=p(a);var g=a.attributes[b];return!!(g&&g.specified)}:function(a,b){a=p(a);return a.hasAttribute(b)},eb:m.Ba<9?function(a){a=p(a);for(var b=a.attributes,g=0;g<b.length;g++){var o=b[g];switch(o.name){case "class":if(a.getAttribute("class"))return T;break;default:if(o.specified)return T}}return Y}:function(a){a=p(a);s.gecko&&a.removeAttribute("_moz_dirty");return a.hasAttributes()},La:function(a,b){var g=p(a),o=p(b);if(g.compareDocumentPosition)return g.compareDocumentPosition(o);
if(g==o)return d.ea;if(g.nodeType==f.e&&o.nodeType==f.e){if(g.contains){if(g.contains(o))return d.Kc+d.$;if(o.contains(g))return d.Z+d.da}if("sourceIndex"in g)return g.sourceIndex<0||o.sourceIndex<0?d.fe:g.sourceIndex<o.sourceIndex?d.$:d.da}g=a.Ja();o=b.Ja();for(var z=Math.min(g.length,o.length),B=0;B<=z-1;B++)if(g[B]!=o[B]){if(B<z)return g[B]<o[B]?d.$:d.da;break}return g.length<o.length?d.Kc+d.$:d.Z+d.da},Ja:function(a,b){a=p(a);for(var g=[],o=a.ownerDocument.documentElement,z=a;z&&z!=o;){var B=
z.parentNode,r=-1;if(B){for(var x=0;x<B.childNodes.length;x++){var w=B.childNodes[x];if(!(b&&w.nodeType==3&&w.previousSibling&&w.previousSibling.nodeType==3)){r++;if(w==z)break}}g.unshift(r)}z=B}return g},Ob:function(a,b){var g=new k.Range(a[0].ownerDocument);g.setStartAfter(a);g.setEndAfter(b);var o=g.extractContents();g.insertNode(a.h());a[0].parentNode.insertBefore(o,a[0].nextSibling)},L:function(a,b,g){a=y(a);if(g!==undefined)return a.css(b,g);a=p(a);return a.style[I(b)]},h:function(a,b){var g=
p(a),o=g.parentNode;if(o){if(b)for(var z;z=g.firstChild;)o.insertBefore(g.removeChild(z),g);o.removeChild(g)}return a},gb:function(a){A.Tc(a);A.Vc(a)},Tc:function(a){a=p(a);for(var b;b=a.firstChild;){if(b.nodeType==f.f){var g=m.Qa(b.nodeValue),o=b.nodeValue.length;if(g){if(g.length<o){(new q(b)).ia(o-g.length);a.removeChild(a.firstChild)}}else{a.removeChild(b);continue}}break}},Vc:function(a){a=p(a);for(var b;b=a.lastChild;){if(b.type==f.f){var g=m.Sa(b.nodeValue),o=b.nodeValue.length;if(g){if(g.length<
o){(new q(b)).ia(g.length);a.removeChild(a.lastChild)}}else{a.removeChild(b);continue}}break}if(!s.ie&&!s.opera)(b=a.lastChild)&&b.nodeType==1&&b.nodeName.toLowerCase()=="br"&&b.parentNode.removeChild(b)},Nb:function(a){a=p(a);for(var b=a.lastChild;b&&b.nodeType==f.f&&!C.trim(b.nodeValue);)b=b.previousSibling;if(!b||b.nodeType==f.f||A.d(b)!=="br"){b=s.opera?a.ownerDocument.createTextNode(""):a.ownerDocument.createElement("br");s.gecko&&b.setAttribute("type","_moz");a.appendChild(b)}},sa:function(a,
b){var g=p(a),o;do o=(g=g.previousSibling)&&new q(g);while(o&&b&&!b(o));return o},pe:function(a,b){a=A.C(a);var g=a[0].lastChild;if((g=g&&new q(g))&&b&&!b(g))g=g.sa(b);return g},Ka:function(a,b){var g=p(a),o;do o=(g=g.nextSibling)&&new q(g);while(o&&b&&!b(o));return o},fb:function(a){a=p(a);if(a.outerHTML)return a.outerHTML.replace(/<\?[^>]*>/,"");var b=a.ownerDocument.createElement("div");b.appendChild(a.cloneNode(T));return b.innerHTML},qe:function(a,b,g,o){a=A.C(a);var z=a.data("list_marker_id")||
a.data("list_marker_id",C.guid()).data("list_marker_id"),B=a.data("list_marker_names")||a.data("list_marker_names",{}).data("list_marker_names");b[z]=a;B[g]=1;return a.data(g,o)},Pc:function(a,b,g){a=y(a);var o=a.data("list_marker_names"),z=a.data("list_marker_id"),B;for(B in o)a.removeData(B);a.removeData("list_marker_names");if(g){a.removeData("list_marker_id");delete b[z]}},Qc:function(a,b,g){a=p(a);b=y(b);var o=a.attributes;g=g||{};for(var z=0;z<o.length;z++){var B=o[z],r=B.name.toLowerCase(),
x;if(!(r in g))if(r=="checked"&&(x=A.attr(a,r)))b.attr(r,x);else if(B.specified||s.ie&&B.value&&r=="value"){x=A.attr(a,r);if(x===U)x=B.nodeValue;b.attr(r,x)}}if(a.style.cssText!=="")b[0].style.cssText=a.style.cssText},Rc:function(a){a=A.d(a);var b=k.m;return(a=!b.Hc[a]&&(b[a]||b.span))&&a["#"]},Vb:function(a){a=y(a);var b=a[0].ownerDocument,g=A.scrollLeft(b),o=A.scrollTop(b),z=a.offset(),B=z.left;z=z.top;if(A.viewportHeight(b)+o<z||z<o||A.viewportWidth(b)+g<B||B<g)a.scrollIntoView(b)},me:function(a,
b,g){a=p(a);if(!s.ie&&g)b=g+":"+b;g=[];a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)g.push(new q(a[b]));return g}};C.DOM.oe=function(a){C.mix(A,a);for(var b in a)a.hasOwnProperty(b)&&function(g){q.prototype[g]=function(){var o=[].slice.call(arguments,0);o.unshift(this);return a[g].apply(U,o)}}(b)};m.o(j,{_4e_wrap:j.C,_4e_unwrap:j.Wc,_4e_equals:j.g,_4e_isBlockBoundary:j.qa,_4e_getWin:j.ga,_4e_index:j.t,_4e_first:j.le,_4e_move:j.Uc,_4e_name:j.d,_4e_isIdentical:j.Sc,_4e_isEmptyInlineRemoveable:j.Sb,
_4e_moveChildren:j.Tb,_4e_mergeSiblings:j.ra,_4e_unselectable:j.ta,_4e_getOffset:j.Qb,_4e_getFrameDocument:j.ne,_4e_splitText:j.ia,_4e_parents:j.Ub,_4e_clone:j.K,_4e_nextSourceNode:j.v,_4e_previousSourceNode:j.ha,_4e_commonAncestor:j.Pb,_4e_ascendant:j.Oc,_4e_hasAttribute:j.Rb,_4e_hasAttributes:j.eb,_4e_position:j.La,_4e_address:j.Ja,_4e_breakParent:j.Ob,_4e_style:j.L,_4e_remove:j.h,_4e_trim:j.gb,_4e_ltrim:j.Tc,_4e_rtrim:j.Vc,_4e_appendBogus:j.Nb,_4e_last:j.pe,_4e_previous:j.sa,_4e_next:j.Ka,_4e_outerHtml:j.fb,
_4e_setMarker:j.qe,_4e_clearMarkers:j.Pc,_4e_getUniqueId:j.og,_4e_copyAttributes:j.Qc,_4e_isEditable:j.Rc,_4e_scrollIntoView:j.Vb,_4e_getElementsByTagName:j.me});A.oe(j)});
KISSY.Editor.add("focusmanager",function(k){function y(){this.qc=m;q=this}function p(){this.qc=e;q=f}var I=KISSY,C=I.DOM,A=I.Event,s={},q;I={dh:function(){for(var d in s){var i=s[d];i.document.designMode="off";i.document.designMode="on"}},Ig:function(){return q},hf:function(d){return s[d]},add:function(d){var i=C.ga(d.document);A.on(i,"focus",y,d);A.on(i,"blur",p,d)},Cf:function(d){s[d.Wb]=d},remove:function(d){delete s[d.Wb];var i=C.ga(d.document);A.remove(i,"focus",y,d);A.remove(i,"blur",p,d)}};
var m=T,e=Y,f=U;k.sd=I;k.focusManager=I;k.jf=function(){return s};k.getInstances=k.jf});
KISSY.Editor.add("definition",function(k){var y=T,p=Y,I=k.k,C=document,A=KISSY,s=A.UA,q=A.DOM,m=A.Node,e=A.Event,f=k.sd,d=I.Xd,i=1,u="document.open();"+(I.qb()?'document.domain="'+C.domain+'";':"")+"document.close();",j="<div  class='ke-editor-wrap'  > <div class='"+".ke-editor-tools".substring(1)+"' ></div><div class='"+".ke-textarea-wrap".substring(1)+'\'><iframe  style="width:100%;height:100%;border:none;"  width="100%"  height="100%"  frameborder="0"  title="kissy-editor"  src="'+(s.ie?"javascript:void(function(){"+
encodeURIComponent(u)+"}())":"")+'"  tabIndex="'+(s.webkit?-1:"$(tabIndex)")+'"  allowTransparency="true" ></iframe></div><div class=\''+".ke-editor-status".substring(1)+"'></div></div>";k.Mc=0;k.db=1;k.SOURCE_MODE=k.Mc;k.WYSIWYG_MODE=k.db;A.augment(k,{qf:function(a){var b=this;b.hb={};b.Ma={};b.ua={};s.ie&&q.addClass(C.body,"ke-ie"+s.ie);if(s.trident)q.addClass(C.body,"ke-trident"+s.trident);else if(s.gecko)q.addClass(C.body,"ke-gecko");else s.webkit&&q.addClass(C.body,"ke-webkit");var g=new m(j.replace(/\$\(tabIndex\)/,
a.attr("tabIndex")));b.cf=g;b.Wb=i++;f.Cf(b);b.Wa=g.one(".ke-textarea-wrap");b.wrap=b.Wa;b.Ca=b.Wa.one("iframe");b.iframe=b.Ca;b.Wd=g.one(".ke-editor-tools");b.toolBarDiv=b.Wd;b.W=a;b.textarea=b.W;b.Jf=g.one(".ke-editor-status");b.statusDiv=b.Jf;I.Bf(b.Wd);var o=a.L("width"),z=a.L("height");if(o){g.css("width",o);a.css("width","100%")}b.W.css("display","none");g.insertAfter(a);b.Wa[0].appendChild(a[0]);if(z){b.Wa.css("height",z);a.css("height","100%")}g=b.Ca;b.on("dataReady",function(){b.Ae=y;k.fire("instanceCreated",
{bf:b})});s.gecko?g.on("load",b.cd,b):b.cd();b.va.attachForm&&a[0].form&&b.ve()},za:function(){if(!this.te){var a=this.cf,b=this.W,g=this.document,o=this.Ca[0].contentWindow;this.Bb();k.sd.remove(this);e.remove(g);e.remove(g.documentElement);e.remove(g.body);e.remove(o);this.Ca.detach();g=this.ua;for(var z in g)if(g.hasOwnProperty(z)){o=g[z];o.za&&o.za()}this.fire("destroy");b.insertBefore(a);a.remove();b.css({width:a.css("width"),height:this.Wa.css("height")});b.show();this.hb=this.Ma=this.ua=U;
this.detach();this.te=T}},ve:function(){var a=this,b=new m(a.W[0].form);b.on("submit",a.Bb,a);a.on("destroy",function(){b.detach("submit",a.Bb,a)})},Mf:function(a,b){var g=this,o=k.ee;o&&o.sc();g.use(a,function(){var z=g.wd(a);if(z){b(z);o&&o.jh()}else A.later(arguments.callee,50,Y,g)})},Ie:function(a,b){this.Ma[a]=b},wd:function(a){return this.Ma[a]},Mg:function(a){var b=this.Ma[a];b&&b.za();this.Ma[a]=U},Ge:function(a,b){this.hb[a]=b},nf:function(a){return this.hb[a]},execCommand:function(a){var b=
this.hb[a],g=A.makeArray(arguments);g.shift();g.unshift(this);return b.exec.apply(b,g)},lc:function(){return this.W.css("display")=="none"?k.db:k.Mc},getData:function(a){var b;b=this.lc()==k.db?this.document&&this.document.body?this.document.body.innerHTML:"":this.W.val();if(this.htmlDataProcessor)b=a?this.htmlDataProcessor.toHtml(b,"p"):this.htmlDataProcessor.toServer(b,"p");b=A.trim(b);if(/^<p>((&nbsp;)|\s)*<\/p>$/.test(b))b="";return b},setData:function(a){var b=a;if(this.htmlDataProcessor)b=this.htmlDataProcessor.toDataFormat(a,
"p");this.document.body.innerHTML=b;this.lc()!=k.db&&this.W.val(a)},Bb:function(){this.W.val(this.getData())},qg:function(){return this.document.body.innerHTML},ug:function(a){this.document.body.innerHTML=a},ze:function(a){var b=this.va,g=b.ec;b=b.ya;var o="",z=k.k.nd("../theme/editor-iframe.css");if(b)for(var B=0;B<b.length;B++)o+='<link href="'+b[B]+'" rel="stylesheet"/>';return"<!doctype html><html><head><title>${title}</title><link href='"+z+"' rel='stylesheet'/><style>"+(g||"")+"</style>"+o+
"</head><body class='ke-editor'>&nbsp;"+(a?'<script id="ke_actscript" type="text/javascript">'+(I.qb()?'document.domain="'+C.domain+'";':"")+'window.parent.KISSY.Editor._initIFrame("'+a+'");<\/script>':"")+"</body></html>"},getSelection:function(){return k.Nc.getSelection(this.document)},focus:function(){var a=this.document,b=q.ga(a);s.webkit&&b&&b.parent&&b.parent.focus();s.webkit&&b&&b.focus();a&&a.body.focus();this.ub()},blur:function(){q.ga(this.document).blur();this.document&&this.document.body.blur()},
He:function(a){var b=this.va,g=this.document;b.ec=b.ec||"";b.ec+="\n"+a;b=g.createElement("style");g.getElementsByTagName("head")[0].appendChild(b);if(b.styleSheet)b.styleSheet.cssText=a;else b.appendChild(g.createTextNode(a))},Ag:function(a){var b=this.va,g=this.document;b.ya=b.ya||[];b.ya.push(a);b=g.createElement("link");b.rel="stylesheet";g.getElementsByTagName("head")[0].appendChild(b);b.href=a},eh:function(a){for(var b=this.va,g=A.makeArray(this.document.getElementsByTagName("link")),o=0;o<
g.length;o++)g[o].href==a&&q.h(g[o]);b.ya=b.ya||[];b=b.ya;a=A.indexOf(a,b);a!=-1&&b.splice(a,1)},cd:function(){function a(){B=z.document;b.document=B;g.detach();B.open("text/html","replace");B.write(o);B.close()}var b=this,g=b.Ca,o=b.ze(b.Wb),z=g[0].contentWindow,B;try{B=z.document}catch(r){g[0].src=g[0].src;if(s.ie<7){setTimeout(a,10);return}}a()},ready:function(a){this.Ae?a():this.on("dataReady",a)},Bg:function(a,b,g){this.ua=this.ua;g=g||{};g.gf=b;this.ua[a]=g},Yd:function(a){var b=this.ua[a];
if(b)if(!(b.status&&!b.duplicate)){a=this.Env.mods[a].requires||[];for(var g=0;g<a.length;g++)this.Yd(a[g]);b.gf.call(b);b.status=1}},jb:function(){var a=this;a.$c&&clearTimeout(a.$c);a.$c=setTimeout(function(){var b=a.getSelection();if(b&&!b.Ed){var g=b.ob(),o=new k.Za(g);if(!a.xc||!a.xc.ld(o)){a.xc=o;a.fire("selectionChange",{selection:b,path:o,element:g})}}},100)},ub:function(){this.xc=U;this.jb()},Dd:function(a,b,g){var o=this;o.focus();setTimeout(function(){var z,B=a.d(),r=k.m,x=k.oa,w=k.n,J=
r.Xa[B],t=o.getSelection(),c=t&&t.H(),h,l,v,n;if(!c||c.length==0){var E=arguments,Q=E.callee;setTimeout(function(){Q.apply(o,E)},30)}else{o.fire("save");for(var P=c.length-1;P>=0;P--){h=c[P];h.deleteContents();z=!P&&a||a.K(y);b&&b(z);if(J)for(;(v=h.Aa(p,y))&&(n=r[v.d()])&&!(n&&n[B]);)if(v.d()in r.span)h.Cc(v);else if(h.wa()&&h.ka()){h.setStartBefore(v);h.collapse(y);v.h()}else h.Bc();h.insertNode(z);l||(l=z)}if(l){B=l.v(y);r=o.document;n=k.m;if(n.Db[z.d()]){B=new m(r.createTextNode(" "));B.insertAfter(l)}else if(B){if(B.d()==
"br"&&n[B.parent().d()].p){n=new m("<p>&nbsp;</p>",U,r);B[0].parentNode.replaceChild(n[0],B[0]);B=n}}else{n=new m("<p>&nbsp;</p>",U,r);n.insertAfter(l);B=n}h.G(l,x.r);B&&B[0].nodeType==w.e&&h.sb(B);t.Ab([h]);o.focus();z&&z.Vb();setTimeout(function(){o.fire("save")},10);g&&g(z)}}},0)},rf:function(a){var b=this;if(b.htmlDataProcessor)a=b.htmlDataProcessor.toDataFormat(a);if(s.webkit){var g=q.create(a,U,b.document);g=g.nodeType==11?A.makeArray(g.childNodes):[g];for(var o=0;o<g.length;o++)b.Dd(new m(g[o]))}else{b.focus();
setTimeout(function(){var z=b.getSelection();z=z&&z.H();if(!z||z.length==0){var B=arguments,r=B.callee;setTimeout(function(){r.apply(b,B)},30)}else{b.fire("save");if(document.selection){z=document.selection;z.type=="Control"&&z.clear();z.createRange().pasteHTML(a)}else b.document.execCommand("inserthtml",p,a);setTimeout(function(){b.fire("save")},10)}},0)}}});k._initIFrame=function(a){function b(t){d(function(){z.designMode="on";setTimeout(function(){z.designMode="off";r.focus();if(!arguments.callee.Ef)arguments.callee.Ef=
y},50)},function(){z.designMode="off";q.attr(r,"contentEditable",p);q.attr(r,"contentEditable",y);!t&&b(1)})}var g=f.hf(a);a=g.W[0];var o=g.Ca[0].contentWindow,z=g.document,B=g.va;q.h(z.getElementById("ke_actscript"));var r=z.body;if(s.ie){r.hideFocus=y;r.disabled=y;r.contentEditable=y;r.removeAttribute("disabled")}else setTimeout(function(){if(s.gecko||s.opera)r.contentEditable=y;else if(s.webkit)r.parentNode.contentEditable=y;else z.designMode="on"},0);if(s.webkit){e.on(z,"click",function(t){var c=
new m(t.target);A.inArray(c.d(),["input","select"])&&t.preventDefault()});e.on(z,"mouseup",function(t){var c=new m(t.target);A.inArray(c.d(),["input","textarea"])&&t.preventDefault()})}if(s.gecko||s.ie||s.opera){var x;x=new m(q.insertAfter((new m('<span tabindex="-1" style="position:absolute; left:-10000" role="presentation"></span>'))[0],a));x.on("focus",function(){g.focus()});g.zg=function(){s.gecko&&g.qc&&x[0].focus()};g.on("destroy",function(){x.detach();x.remove()})}if(z.documentMode||s.gecko||
s.opera){var w=z.documentElement;e.on(w,"mousedown",function(t){if((new m(t.target))[0]==w){s.gecko&&b(p);x[0].focus()}})}e.on(o,"focus",function(){if(s.gecko)b(p);else s.opera&&r.focus();g.ub()});s.gecko&&e.on(g.document,"mousedown",function(){g.qc||b(p)});if(s.ie){e.on(z,"keydown",function(t){if(t.keyCode in{8:1,46:1}){var c=g.getSelection(),h=c.mc();if(h){g.fire("save");var l=c.H()[0].O();h.h();c.Sd([l]);g.fire("save");t.preventDefault()}}});if(z.compatMode=="CSS1Compat"){var J={33:1,34:1};e.on(z,
"keydown",function(t){t.keyCode in J&&setTimeout(function(){g.getSelection().scrollIntoView()},0)})}}setTimeout(function(){s.ie&&setTimeout(function(){if(z){r.runtimeStyle.marginBottom="0px";r.runtimeStyle.marginBottom=""}},1E3)},0);setTimeout(function(){g.fire("dataReady");var t=B.disableObjectResizing,c=B.disableInlineTableEditing;if(t||c)try{z.execCommand("enableObjectResizing",p,!t);z.execCommand("enableInlineTableEditing",p,!c)}catch(h){e.on(r,s.ie?"resizestart":"resize",function(l){var v=new m(l.target);
if(t||v.d()==="table"&&c)l.preventDefault()})}},10);s.webkit&&e.on(z,"mousedown",function(t){t=new m(t.target);A.inArray(t.d(),["img","hr","input","textarea","select"])&&g.getSelection().Ac(t)});s.gecko&&e.on(z,"dragstart",function(t){var c=new m(t.target);c.d()==="img"&&/ke_/.test(c[0].className)&&t.preventDefault()});f.add(g)};document.documentMode>7&&function(){for(var a=A.all("link"),b=0;b<a.length;b++){var g=new m(a[b]),o=g.attr("href");o.indexOf("editor-pkg-min-mhtml.css")!=-1&&g.attr("href",
o.replace(/editor-pkg-min-mhtml\.css/g,"editor-pkg-min-datauri.css"))}}();u=k.prototype;I.o(u,{setData:u.setData,getData:u.getData,insertElement:u.Dd,insertHtml:u.rf,ready:u.ready,addCustomStyle:u.He,addCommand:u.Ge,hasCommand:u.nf,execCommand:u.execCommand,useDialog:u.Mf,addDialog:u.Ie,getDialog:u.wd,getMode:u.lc,sync:u.Bb,getSelection:u.getSelection,focus:u.focus,blur:u.blur,notifySelectionChange:u.ub})});
KISSY.Editor.add("zindex",function(){var k=KISSY.Editor;if(!k.Dc){k.Dc={Tf:1100,ig:1200,Vf:99999,bg:900,hg:9999,LOADING:11E3,ag:12E3,ge:1200};k.$b=function(y){return(k.Uf.$b||1E4)+y};k.baseZIndex=k.$b;k.zIndexManager=k.Dc}});
KISSY.Editor.add("dtd",function(k){k.m=function(){function y(r){for(var x=arguments.length-1;x>0;)KISSY.mix(r,arguments[x--]);return r}var p={isindex:1,fieldset:1},I={input:1,button:1,select:1,textarea:1,label:1},C=y({a:1},I),A=y({iframe:1},C),s={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},q={ins:1,del:1,script:1,style:1},m=y({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,
s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},q),e=y({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},m),f=y({p:1},e);I=y({iframe:1},e,I);e={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,
del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};var d=y({a:1},I),i={tr:1},u={"#":1},j=y({param:1},e),a=y({form:1},p,A,s,f),b={li:1},g={base:1,link:1,meta:1,title:1},o=y(g,{style:1,script:1}),z={head:1,body:1},B={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1};return{Fb:y({html:1},z,g),Xa:B,Rf:{body:1,div:1,td:1,th:1,caption:1,
form:1},Db:d,Ec:y({script:1,style:1},B),Fc:{script:1,style:1},Cb:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},Eb:{dd:1,dt:1,li:1},Zd:{ul:1,ol:1,dl:1},Hc:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},ca:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},Sf:{a:1,area:1,button:1,input:1,object:1,select:1,
textarea:1},Ic:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:z,head:o,style:u,body:a,base:{},link:{},meta:{},title:u,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:a,td:a,br:{},th:a,center:a,kbd:d,button:y(f,s),basefont:{},h5:d,h4:d,samp:d,h6:d,ol:b,h1:d,h3:d,option:u,h2:d,form:y(p,A,s,f),select:{optgroup:1,option:1},font:d,ins:d,menu:b,abbr:d,label:d,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:d,script:u,tfoot:i,cite:d,li:a,input:{},iframe:a,
strong:d,textarea:u,noframes:a,big:d,small:d,span:d,hr:{},dt:d,sub:d,optgroup:{option:1},param:{},bdo:d,"var":d,div:a,object:j,sup:d,dd:a,strike:d,area:{},dir:b,map:y({area:1,form:1,p:1},p,q,s),applet:j,dl:{dt:1,dd:1},del:d,isindex:{},fieldset:y({Xg:1},e),thead:i,ul:b,acronym:d,b:d,a:I,blockquote:a,caption:d,i:d,u:d,tbody:i,s:d,address:y(A,f),tt:d,legend:d,q:d,pre:y(m,C),p:d,em:d,dfn:d}}();k.XHTML_DTD=k.m});
KISSY.Editor.add("elementpath",function(k){function y(e){var f=A,d=A,i=[];for(e=e;e&&e[0];){if(e[0].nodeType==C.e){if(!this.vf)this.vf=e;var u=e.d();if(!d){if(!f&&s[u])f=e;if(q[u]){var j;if(j=!f){if(j=u=="div"){a:{j=e;j=j[0]||j;j=j.childNodes;for(var a=0,b=j.length;a<b;a++){var g=j[a];if(g.nodeType==C.e&&I.Xa[g.nodeName.toLowerCase()]){j=T;break a}}j=Y}j=!j}j=j}if(j)f=e;else d=e}}i.push(e);if(u=="body")break}e=e.parent()}this.block=this.w=f;this.blockLimit=this.D=d;this.elements=this.elements=i}var p=
KISSY.DOM,I=k.m,C=k.n,A=U,s={address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,dd:1},q={body:1,div:1,table:1,tbody:1,tr:1,td:1,th:1,caption:1,form:1};y.prototype={ld:function(e){var f=this.elements;e=e&&e.elements;if(!e||f.length!=e.length)return Y;for(var d=0;d<f.length;d++)if(!p.g(f[d],e[d]))return Y;return T},contains:function(e){for(var f=this.elements,d=0;d<f.length;d++)if(f[d].d()in e)return f[d];return A}};k.ElementPath=k.Za=y;var m=y.prototype;k.k.o(m,{compare:m.ld,
contains:m.contains})});
KISSY.Editor.add("walker",function(k){function y(i,u){if(this.c.end)return s;var j,a=this.Ea,b,g=this.nc,o=this.type,z=i?"_4e_previousSourceNode":"_4e_nextSourceNode";if(!this.c.start){this.c.start=1;a.trim();if(a.collapsed){this.end();return s}}if(!i&&!this.c.zd){var B=a.endContainer,r=new f(B[0].childNodes[a.endOffset]);this.c.zd=function(t,c){return(t=e.C(t))&&t[0]&&(!c||!e.g(B,t))&&(!r[0]||!t.g(r))&&(t[0].nodeType!=m.e||!c||t.d()!="body")}}if(i&&!this.c.Ad){var x=a.startContainer,w=a.startOffset>
0&&new f(x[0].childNodes[a.startOffset-1]);this.c.Ad=function(t,c){return(t=e.C(t))&&t[0]&&(!c||!t.g(x))&&(!w[0]||!t.g(w))&&(t[0].nodeType!=m.e||!c||t.d()!="body")}}var J=i?this.c.Ad:this.c.zd;b=g?function(t,c){if(J(t,c)===A)return A;return g(t,c)}:J;if(this.mb)j=this.mb[z](A,o,b);else if(i){j=a.endContainer;if(a.endOffset>0){j=new f(j[0].childNodes[a.endOffset-1]);if(b(j)===A)j=s}else j=b(j,C)===A?s:j.ha(C,o,b)}else{j=a.startContainer;if((j=new f(j[0].childNodes[a.startOffset]))&&j[0]){if(b(j)===
A)j=s}else j=b(a.startContainer,C)===A?s:a.startContainer.v(C,o,b)}for(;j&&j[0]&&!this.c.end;){this.mb=j;if(!this.R||this.R(j)!==A){if(!u)return j}else if(u&&this.R)return A;j=j[z](A,o,b)}this.end();return this.mb=s}function p(i){for(var u,j=s;u=y.call(this,i);)j=u;return j}function I(i){this.Ea=i;this.c={}}var C=T,A=Y,s=U,q=KISSY,m=k.n,e=q.DOM,f=q.Node;q.augment(I,{end:function(){this.c.end=1},next:function(){return y.call(this)},xb:function(){return y.call(this,C)},kd:function(){return y.call(this,
A,C)!==A},jd:function(){return y.call(this,C,C)!==A},Gd:function(){return p.call(this)},Fd:function(){return p.call(this,C)},reset:function(){delete this.mb;this.c={}}});I.ac=function(i){return function(u){u=e.C(u);return!(u&&u[0].nodeType==m.e&&u.qa(i))}};I.xf=function(){return this.ac({bc:1})};I.Na=function(i,u){function j(a){return a&&a[0]&&a.d()=="span"&&a.attr("_ke_bookmark")}return function(a){var b,g;b=a&&a[0]&&a[0].nodeType==m.f&&(g=a.parent())&&j(g);b=i?b:b||j(a);return u^b}};I.Va=function(i){return function(u){u=
(u=u[0]||u)&&u.nodeType==m.f&&!q.trim(u.nodeValue);return i^u}};I.sf=function(i){var u=I.Va();return function(j){j=u(j)||j[0].nodeType==m.e&&!j[0].offsetHeight;return i^j}};k.Ia=I;k.Walker=I;var d=I.prototype;k.k.o(d,{end:d.end,next:d.next,previous:d.xb,checkForward:d.kd,checkBackward:d.jd,lastForward:d.Gd,lastBackward:d.Fd,reset:d.reset});k.k.o(I,{blockBoundary:I.ac,listItemBoundary:I.xf,bookmark:I.Na,whitespaces:I.Va,invisible:I.sf})});
KISSY.Editor.add("range",function(k){function y(c){this.endOffset=this.endContainer=this.startOffset=this.startContainer=e;this.collapsed=q;this.document=c}function p(c){var h=c[0].nodeType!=d.f&&c.d()in o.ca,l=!f.trim(c[0].nodeValue);c=!!c.parent().attr("_ke_bookmark");return h||l||c}function I(c){return!w(c)&&!J(c)}function C(c){var h=m,l=j.Na(q);return function(v){if(l(v))return q;if(v[0].nodeType==d.f){if(f.trim(v[0].nodeValue).length)return m}else if(v[0].nodeType==d.e)if(!x[v.d()])if(!c&&!g.ie&&
v.d()=="br"&&!h)h=q;else return m;return q}}function A(c,h){function l(v){return v&&v.nodeName=="span"&&v.getAttribute("_ke_bookmark")}return function(v){var n,E;n=v&&!v.nodeName&&(E=v.parentNode)&&l(E);n=c?n:n||l(v);return h^n}}function s(c){return function(h){h=(h=h[0]||h)&&h.nodeType==d.f&&!f.trim(h.nodeValue);return c^h}}k.oa={Y:1,J:2,B:3,r:4,Ib:1,Hb:2,Ya:3,bb:1,ce:2,jg:3,fa:1,Lc:2};k.RANGE=k.oa;var q=T,m=Y,e=U,f=KISSY,d=k.n,i=k.oa,u=k.$a,j=k.Ia,a=f.DOM,b=k.k.vd,g=f.UA,o=k.m,z=k.Za,B=f.Node,r=
{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1};y.prototype.toString=function(){var c=[];c.push((this.startContainer[0].id||this.startContainer[0].nodeName)+":"+this.startOffset);c.push((this.endContainer[0].id||this.endContainer[0].nodeName)+":"+this.endOffset);return c.join("<br/>")};f.augment(y,{Ua:function(){this.collapsed=this.startContainer&&this.endContainer&&a.g(this.startContainer,this.endContainer)&&this.startOffset==this.endOffset},vc:function(){var c=this.startContainer,
h=this.startOffset;if(c[0].nodeType!=d.e)if(h)h>=c[0].nodeValue.length&&this.setStartAfter(c);else this.setStartBefore(c);c=this.endContainer;h=this.endOffset;if(c[0].nodeType!=d.e)if(h)h>=c[0].nodeValue.length&&this.setEndAfter(c);else this.setEndBefore(c)},setStartAfter:function(c){this.setStart(c.parent(),c.t()+1)},setStartBefore:function(c){this.setStart(c.parent(),c.t())},setEndAfter:function(c){this.setEnd(c.parent(),c.t()+1)},setEndBefore:function(c){this.setEnd(c.parent(),c.t())},wc:function(){var c=
this.startContainer,h=this.endContainer;c&&c.d()=="span"&&c.attr("_ke_bookmark")&&this.V(c,i.B);h&&h.d()=="span"&&h.attr("_ke_bookmark")&&this.U(h,i.r)},setStart:function(c,h){if(c[0].nodeType==d.e&&r[c.d()]){c=c.parent();h=c.t()}this.startContainer=c;this.startOffset=h;if(!this.endContainer){this.endContainer=c;this.endOffset=h}this.Ua()},setEnd:function(c,h){if(c[0].nodeType==d.e&&r[c.d()]){c=c.parent();h=c.t()+1}this.endContainer=c;this.endOffset=h;if(!this.startContainer){this.startContainer=
c;this.startOffset=h}this.Ua()},V:function(c,h){switch(h){case i.Y:this.setStart(c,0);break;case i.J:c[0].nodeType==d.f?this.setStart(c,c[0].nodeValue.length):this.setStart(c,c[0].childNodes.length);break;case i.B:this.setStartBefore(c);break;case i.r:this.setStartAfter(c)}this.Ua()},U:function(c,h){switch(h){case i.Y:this.setEnd(c,0);break;case i.J:c[0].nodeType==d.f?this.setEnd(c,c[0].nodeValue.length):this.setEnd(c,c[0].childNodes.length);break;case i.B:this.setEndBefore(c);break;case i.r:this.setEndAfter(c)}this.Ua()},
hc:function(c,h){var l=this.startContainer,v=this.endContainer,n=this.startOffset,E=this.endOffset,Q,P=this.document,N;this.wc();if(v[0].nodeType==d.f)v=v.ia(E);else if(v[0].childNodes.length>0)if(E>=v[0].childNodes.length){v=new B(v[0].appendChild(P.createTextNode("")));N=q}else v=new B(v[0].childNodes[E]);if(l[0].nodeType==d.f){l.ia(n);if(l.g(v))v=new B(l[0].nextSibling)}else if(n)if(n>=l[0].childNodes.length){Q=new B(P.createTextNode(""));l.append(Q);l=Q;Q=q}else l=new B(l[0].childNodes[n].previousSibling);
else{Q=new B(P.createTextNode(""));l.prepend(Q);l=Q;Q=q}n=l.Ub();E=v.Ub();var O,V,X;for(O=0;O<n.length;O++){V=n[O];X=E[O];if(!V.g(X))break}P=h;for(var W,aa,ca,F=O;F<n.length;F++){W=n[F];aa=P&&!W.g(l)?P.appendChild(W.K()[0]):U;for(W=W[0].nextSibling;W;){if(a.g(E[F],W)||a.g(v,W))break;ca=W.nextSibling;if(c==2)P.appendChild(W.cloneNode(q));else{a.h(W);c==1&&P.appendChild(W)}W=ca}if(aa)P=aa}P=h;for(O=O;O<E.length;O++){W=E[O];aa=P&&c>0&&!W.g(v)?P.appendChild(W.K()[0]):U;if(!n[O]||!W.parent().g(n[O].parent()))for(W=
W[0].previousSibling;W;){if(a.g(n[O],W)||a.g(l,W))break;ca=W.previousSibling;if(c==2)P.insertBefore(W.cloneNode(q),P.firstChild);else{a.h(W);c==1&&P.insertBefore(W,P.firstChild)}W=ca}if(aa)P=aa}if(c==2){X=this.startContainer[0];if(X.nodeType==d.f&&X.nextSibling&&X.nextSibling.nodeType==d.f){X.data+=X.nextSibling.data;X.parentNode.removeChild(X.nextSibling)}X=this.endContainer[0];if(X.nodeType==d.f&&X.nextSibling&&X.nextSibling.nodeType==d.f){X.data+=X.nextSibling.data;X.parentNode.removeChild(X.nextSibling)}}else{if(V&&
X&&(!l.parent().g(V.parent())||!v.parent().g(X.parent()))){V=X.t();Q&&X.parent().g(l.parent())&&V--;this.setStart(X.parent(),V)}this.collapse(q)}Q&&l.h();N&&v[0].parentNode&&v.h()},collapse:function(c){if(c){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this.collapsed=q},clone:function(){var c=new y(this.document);c.startContainer=this.startContainer;c.startOffset=this.startOffset;c.endContainer=this.endContainer;
c.endOffset=this.endOffset;c.collapsed=this.collapsed;return c},xd:function(){var c=this.clone();c.vc();if(c.startContainer[0].nodeType!=d.e||c.endContainer[0].nodeType!=d.e)return e;var h=new k.Ia(c),l=A(q,undefined),v=s(q);c.R=function(n){return v(n)&&l(n)};c=h.next();h.reset();h=h.xb();return c&&c.g(h)?c:e},Ta:function(c,h){if(!this.collapsed){c=c||i.Lc;var l=this.clone(),v=this.startContainer,n=this.endContainer,E=this.startOffset,Q=this.endOffset,P=1,N=1;if(v&&v[0].nodeType==d.f)if(E)if(E>=v[0].nodeValue.length)l.setStartAfter(v);
else{l.setStartBefore(v);P=0}else l.setStartBefore(v);if(n&&n[0].nodeType==d.f)if(Q)if(Q>=n[0].nodeValue.length)l.setEndAfter(n);else{l.setEndAfter(n);N=0}else l.setEndBefore(n);l=new j(l);l.R=function(V){V=V[0]||V;return V.nodeType==(c==i.fa?d.e:d.f)};var O;l.nc=function(V,X){V=V[0]||V;if(c==i.fa&&V.nodeType==d.f)return m;if(X&&V==O)return m;if(!X&&V.nodeType==d.e)O=V;return q};if(P)(v=l[c==i.fa?"lastForward":"next"]())&&this.V(v,h?i.Y:i.B);if(N){l.reset();(l=l[c==i.fa?"lastBackward":"previous"]())&&
this.U(l,h?i.J:i.r)}return!!(P||N)}},lf:function(){var c=this.startContainer;if(this.collapsed||c[0].nodeType!=d.e)return c;return c.childNodes[this.startOffset]||c},md:function(c){var h=this.startContainer,l=this.endContainer,v=this.startOffset,n=this.endOffset,E,Q;if(!h||!l)return{start:0,end:0};if(c){if(h[0].nodeType==d.e)if((E=new B(h[0].childNodes[v]))&&E[0]&&E[0].nodeType==d.f&&v>0&&E[0].previousSibling.nodeType==d.f){h=E;v=0}for(;h[0].nodeType==d.f&&(Q=h.sa())&&Q[0].nodeType==d.f;){h=Q;v+=
Q[0].nodeValue.length}if(!this.collapsed){if(l[0].nodeType==d.e)if((E=new B(l[0].childNodes[n]))&&E[0]&&E[0].nodeType==d.f&&n>0&&E[0].previousSibling.nodeType==d.f){l=E;n=0}for(;l[0].nodeType==d.f&&(Q=l.sa())&&Q[0].nodeType==d.f;){l=Q;n+=Q[0].nodeValue.length}}}return{start:h.Ja(c),end:this.collapsed?e:l.Ja(c),startOffset:v,endOffset:n,Jd:c,tf:q}},O:function(c){var h,l,v,n,E=this.collapsed;h=new B("<span>",e,this.document);h.attr("_ke_bookmark",1);h.css("display","none");h.html("&nbsp;");if(c){v=
f.guid("ke_bm_");h.attr("id",v+"S")}if(!E){l=h.K();l.html("&nbsp;");c&&l.attr("id",v+"E");n=this.clone();n.collapse();n.insertNode(l)}n=this.clone();n.collapse(q);n.insertNode(h);if(l){this.setStartAfter(h);this.setEndBefore(l)}else this.G(h,i.r);return{aa:c?v+"S":h,Q:c?v+"E":l,Ud:c,collapsed:E}},G:function(c,h){this.V(c,h);this.collapse(q)},trim:function(c,h){var l=this.startContainer,v=this.startOffset,n=this.collapsed;if((!c||n)&&l[0]&&l[0].nodeType==d.f){if(v)if(v>=l[0].nodeValue.length){v=l.t()+
1;l=l.parent()}else{var E=l.ia(v);v=l.t()+1;l=l.parent();if(a.g(this.startContainer,this.endContainer))this.setEnd(E,this.endOffset-this.startOffset);else if(a.g(l,this.endContainer))this.endOffset+=1}else{v=l.t();l=l.parent()}this.setStart(l,v);if(n){this.collapse(q);return}}l=this.endContainer;v=this.endOffset;if(!(h||n)&&l[0]&&l[0].nodeType==d.f){if(v){v>=l.nodeValue.length||l.ia(v);v=l.t()+1}else v=l.t();l=l.parent();this.setEnd(l,v)}},insertNode:function(c){this.wc();this.trim(m,q);var h=this.startContainer;
h[0].insertBefore(c[0]||c,h[0].childNodes[this.startOffset]||U);a.g(c.parent(),this.endContainer)&&this.endOffset++;this.setStartBefore(c)},moveToBookmark:function(c){if(c.tf){var h=b(this.document,c.start,c.Jd),l=c.startOffset,v=c.end&&b(this.document,c.end,c.Jd);c=c.endOffset;this.setStart(h,l);v?this.setEnd(v,c):this.collapse(q)}else{h=(l=c.Ud)?f.one("#"+c.aa,this.document):c.aa;c=l?f.one("#"+c.Q,this.document):c.Q;this.setStartBefore(h);h.h();if(c&&c[0]){this.setEndBefore(c);c.h()}else this.collapse(q)}},
Aa:function(c,h){var l=this.startContainer,v=this.endContainer;l=a.g(l,v)?c&&l[0].nodeType==d.e&&this.startOffset==this.endOffset-1?new B(l[0].childNodes[this.startOffset]):l:l.Pb(v);return h&&l[0].nodeType==d.f?l.parent():l},Oa:function(c){switch(c){case i.Ib:if(this.collapsed)break;c=this.Aa();var h=new B(this.document.body),l,v,n,E,Q,P=m,N,O;N=this.startContainer;O=this.startOffset;if(N[0].nodeType==d.f){if(O){N=!f.trim(N[0].nodeValue.substring(0,O)).length&&N;P=!!N}if(N)if(!(E=N[0].previousSibling))n=
N.parent()}else{if(O)E=N[0].childNodes[O-1]||N[0].lastChild;E||(n=N)}for(;n||E;){if(n&&!E){if(!Q&&a.g(n,c))Q=q;if(!h.contains(n))break;if(!P||n.css("display")!="inline"){P=m;if(Q)l=n;else this.setStartBefore(n)}E=n[0].previousSibling}for(;E;){N=m;if(E.nodeType==d.f){O=E.nodeValue;if(/[^\s\ufeff]/.test(O))E=e;N=/[\s\ufeff]$/.test(O)}else if(E.offsetWidth>0&&!E.getAttribute("_ke_bookmark"))if(P&&o.ca[E.nodeName.toLowerCase()]){O=a.text(E);if(/[^\s\ufeff]/.test(O))E=e;else for(var V=E.all||E.getElementsByTagName("*"),
X=0,W;W=V[X++];)if(!o.ca[W.nodeName.toLowerCase()]){E=e;break}if(E)N=!!O.length}else E=e;if(N)if(P)if(Q)l=n;else n&&this.setStartBefore(n);else P=q;if(E){N=E.previousSibling;if(!n&&!N){n=new B(E);E=e;break}E=N}else n=e}if(n)n=n.parent()}N=this.endContainer;O=this.endOffset;n=E=e;Q=P=m;if(N[0].nodeType==d.f){N=!f.trim(N[0].nodeValue.substring(O)).length&&N;P=!(N&&N[0].nodeValue.length);if(N)if(!(E=N[0].nextSibling))n=N.parent()}else(E=N[0].childNodes[O])||(n=N);for(;n||E;){if(n&&!E){if(!Q&&a.g(n,c))Q=
q;if(!h.contains(n))break;if(!P||n.css("display")!="inline"){P=m;if(Q)v=n;else n&&this.setEndAfter(n)}E=n[0].nextSibling}for(;E;){N=m;if(E.nodeType==d.f){O=E.nodeValue;if(/[^\s\ufeff]/.test(O))E=e;N=/^[\s\ufeff]/.test(O)}else if(E.offsetWidth>0&&!E.getAttribute("_ke_bookmark"))if(P&&o.ca[E.nodeName.toLowerCase()]){O=a.text(E);if(/[^\s\ufeff]/.test(O))E=e;else{V=E.all||E.getElementsByTagName("*");for(X=0;W=V[X++];)if(!o.ca[W.nodeName.toLowerCase()]){E=e;break}}if(E)N=!!O.length}else E=e;if(N)if(P)if(Q)v=
n;else this.setEndAfter(n);if(E){N=E.nextSibling;if(!n&&!N){n=new B(E);E=e;break}E=N}else n=e}if(n)n=n.parent()}if(l&&v){c=l.contains(v)?v:l;this.setStartBefore(c);this.setEndAfter(c)}break;case i.Hb:case i.Ya:n=new y(this.document);h=new B(this.document.body);n.V(h,i.Y);n.setEnd(this.startContainer,this.startOffset);n=new j(n);var aa,ca,F=j.ac(c==i.Ya?{bc:1}:e),K=function(D){var H=F(D);H||(aa=D);return H};l=function(D){var H=K(D);if(!H&&D[0]&&D.d()=="br")ca=D;return H};n.nc=K;n=n.Fd();aa=aa||h;this.V(aa,
aa.d()!="br"&&(!n&&this.wa()||n&&aa.contains(n))?i.Y:i.r);n=this.clone();n.collapse();n.U(h,i.J);n=new j(n);n.nc=c==i.Ya?l:K;aa=e;n=n.Gd();aa=aa||h;this.U(aa,!n&&this.ka()||n&&aa.contains(n)?i.J:i.B);ca&&this.setEndAfter(ca)}},wa:function(){var c=this.startContainer,h=this.startOffset;if(h&&c[0].nodeType==d.f)if(f.trim(c[0].nodeValue.substring(0,h)).length)return m;this.trim();c=new z(this.startContainer);h=this.clone();h.collapse(q);h.V(c.w||c.D,i.Y);c=new j(h);c.R=C(q);return c.jd()},ka:function(){var c=
this.endContainer,h=this.endOffset;if(c[0].nodeType==d.f)if(f.trim(c[0].nodeValue.substring(h)).length)return m;this.trim();c=new z(this.endContainer);h=this.clone();h.collapse(m);h.U(c.w||c.D,i.J);c=new j(h);c.R=C(m);return c.kd()},deleteContents:function(){this.collapsed||this.hc(0)},extractContents:function(){var c=this.document.createDocumentFragment();this.collapsed||this.hc(1,c);return c},dc:function(c,h){var l=this.clone();l[h==i.bb?"setStartAt":"setEndAt"](c,h==i.bb?i.Y:i.J);l=new j(l);l.R=
p;return l[h==i.bb?"checkBackward":"checkForward"]()},ud:function(){var c=this.startContainer,h=this.endContainer,l=this.startOffset,v=this.endOffset,n;if(c[0].nodeType==d.e){n=c[0].childNodes.length;if(n>l)c=new B(c[0].childNodes[l]);else if(n<1)c=c.ha();else{for(c=c[0];c.lastChild;)c=c.lastChild;c=new B(c);c=c.v()||c}}if(h[0].nodeType==d.e){n=h[0].childNodes.length;if(n>v)h=(new B(h[0].childNodes[v])).ha(q);else if(n<1)h=h.ha();else{for(h=h[0];h.lastChild;)h=h.lastChild;h=new B(h)}}if(c.La(h)&u.da)c=
h;return{aa:c,Q:h}},nb:function(c,h){var l=this.O(),v=new B(this.document.createElement(h));this.collapse(c);this.Oa(i.Hb);v[0].appendChild(this.extractContents());v.gb();g.ie||v.Nb();this.insertNode(v);this.moveToBookmark(l);return v},Bc:function(c){var h=new z(this.startContainer),l=new z(this.endContainer),v=h.w,n=l.w,E=e;if(!h.D.g(l.D))return e;if(c!="br"){if(!v){v=this.nb(q,c);n=(new z(this.endContainer)).w}n||(n=this.nb(m,c))}c=v&&this.wa();h=n&&this.ka();this.deleteContents();if(v&&a.g(v,n))if(h){E=
new z(this.startContainer);this.G(n,i.r);n=e}else if(c){E=new z(this.startContainer);this.G(v,i.B);v=e}else{n=this.Cc(v);!g.ie&&!f.inArray(v.d(),["ul","ol"])&&v.Nb()}return{bh:v,$g:n,Pf:c,Of:h,Sg:E}},Cc:function(c){if(!this.collapsed)return e;this.U(c,i.J);var h=this.extractContents(),l=c.K(m);l[0].appendChild(h);l.insertAfter(c);this.G(c,i.r);return l},sb:function(c,h){var l,v=k.m;if(v.Cb[c.d()])return m;for(;c&&c[0].nodeType==d.e;){if(l=c.Rc())this.G(c,h?i.J:i.Y);else if(v.Db[c.d()]){this.G(c,h?
i.r:i.B);return q}if((c=v.Cb[c.d()]?c[h?"_4e_previous":"_4e_next"](I):c[h?"_4e_last":"_4e_first"](I))&&c[0].nodeType==d.f){this.G(c,h?i.r:i.B);return q}}return l},selectNodeContents:function(c){this.setStart(c,0);this.setEnd(c,c[0].nodeType==d.f?c[0].nodeValue.length:c[0].childNodes.length)}});var x={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},w=new j.Va,J=new j.Na;k.Range=
y;k.Range=y;var t=y.prototype;k.k.o(t,{updateCollapsed:t.Ua,optimize:t.vc,setStartAfter:t.setStartAfter,setEndAfter:t.setEndAfter,setStartBefore:t.setStartBefore,setEndBefore:t.setEndBefore,optimizeBookmark:t.wc,setStart:t.setStart,setEnd:t.setEnd,setStartAt:t.V,setEndAt:t.U,execContentsAction:t.hc,collapse:t.collapse,clone:t.clone,getEnclosedNode:t.xd,shrink:t.Ta,getTouchedStartNode:t.lf,createBookmark2:t.md,createBookmark:t.O,moveToPosition:t.G,trim:t.trim,insertNode:t.insertNode,moveToBookmark:t.moveToBookmark,
getCommonAncestor:t.Aa,enlarge:t.Oa,checkStartOfBlock:t.wa,checkEndOfBlock:t.ka,deleteContents:t.deleteContents,extractContents:t.extractContents,checkBoundaryOfElement:t.dc,getBoundaryNodes:t.ud,fixBlock:t.nb,splitBlock:t.Bc,splitElement:t.Cc,moveToElementEditablePosition:t.sb,selectNodeContents:t.selectNodeContents})});
KISSY.Editor.add("domiterator",function(k){function y(j){if(!(arguments.length<1)){this.Ea=j;this.jc=I;this.rd=p;this.gc=I;this.c||(this.c={})}}var p=T,I=Y,C=KISSY,A=C.UA,s=k.Ia,q=k.Range,m=k.oa,e=k.n,f=k.Za,d=C.Node,i=C.DOM,u=/^[\r\n\t ]*$/;C.augment(y,{kf:function(j){var a,b,g,o,z;if(!this.c.I){b=this.Ea.clone();b.Ta(m.fa,p);b.Oa(this.jc||!this.rd?m.Ya:m.Hb);var B=new s(b),r=s.Na(p,p);B.R=r;this.c.la=B.next();B=new s(b);B.R=r;B=B.xb();this.c.I=B.v(p);if(this.c.I&&this.c.I[0].nodeType==e.f&&!C.trim(this.c.I[0].nodeValue)&&
this.c.I.parent().qa()){r=new q(b.document);r.G(this.c.I,m.r);if(r.ka()){r=new f(r.endContainer);this.c.I=(r.w||r.D).v(p)}}if(!this.c.I){this.c.I=this.c.pd=new d(b.document.createTextNode(""));i.insertAfter(this.c.I[0],B[0])}b=U}r=this.c.la;B=this.c.I;for(this.c.la=U;r;){var x=I,w=r[0].nodeType!=e.e,J=I;if(w){if(r[0].nodeType==e.f)if(u.test(r[0].nodeValue))w=I}else{var t=r.d();if(r.qa(this.jc&&{bc:1})){if(t=="br")w=p;else if(!b&&!r[0].childNodes.length&&t!="hr"){a=r;g=r.g(B);break}if(b){b.U(r,m.B);
if(t!="br")this.c.la=r}x=p}else{if(r[0].firstChild){if(!b){b=new q(this.Ea.document);b.V(r,m.B)}r=new d(r[0].firstChild);continue}w=p}}if(w&&!b){b=new q(this.Ea.document);b.V(r,m.B)}g=(!x||w)&&r.g(B);if(b&&!x)for(;!r[0].nextSibling&&!g;){t=r.parent();if(t.qa(this.jc&&{bc:1})){x=p;g||t.g(B);break}r=t;w=p;g=r.g(B);J=p}w&&b.U(r,m.r);r=r.v(J,U,B);if((g=!r)||x&&b)break}if(!a){if(!b){this.c.pd&&this.c.pd.h();return this.c.la=U}a=new f(b.startContainer);r=a.D;x={Ng:1,ih:1,hh:1};a=a.w;if((!a||!a[0])&&!this.gc&&
x[r.d()]&&b.wa()&&b.ka())a=r;else if(!a||this.gc&&a.d()=="li"){a=new d(this.Ea.document.createElement(j||"p"));a[0].appendChild(b.extractContents());a.gb();b.insertNode(a);o=z=p}else if(a.d()!="li"){if(!b.wa()||!b.ka()){a=a.K(I);a[0].appendChild(b.extractContents());a.gb();z=b.Bc();o=!z.Pf;z=!z.Of;b.insertNode(a)}}else if(!g)this.c.la=a.g(B)?U:b.ud().Q.v(p,U,B)}if(o){b=new d(a[0].previousSibling);if(b[0]&&b[0].nodeType==e.e)if(b.d()=="br")b.h();else b[0].lastChild&&i.d(b[0].lastChild)=="br"&&i.h(b[0].lastChild)}if(z){b=
s.Na(I,p);o=new d(a[0].lastChild);if(o[0]&&o[0].nodeType==e.e&&o.d()=="br")if(A.ie||o.sa(b)||o.Ka(b))o.h()}if(!this.c.la)this.c.la=g||a.g(B)?U:a.v(p,U,B);return a}});q.prototype.Ye=function(){return new y(this)}});
KISSY.Editor.add("selection",function(k){function y(x){this.document=this.document=x;this.c={M:{}};if(a){var w=this.z().createRange();if(!w||w.item&&w.item(0).ownerDocument!=x||w.parentElement&&w.parentElement().ownerDocument!=x)this.Ed=C}}function p(x){x=new y(x);return!x||x.Ed?s:x}function I(x){var w=x.document,J=new d(w.body),t=new d(w.documentElement);if(m.ie){m.Ba<8&&t.on("click",function(N){(new d(N.target)).d()==="html"&&x.getSelection().z().createRange().select()});var c,h,l=1;t.on("mousedown",
function(){l=0});t.on("mouseup",function(){l=1});J.on("focusin",function(N){if((new d(N.target)).d()=="body")if(c){try{l&&c.select()}catch(O){}c=s}});J.on("focus",function(){h=C;n()});J.on("beforedeactivate",function(N){if(!N.relatedTarget){v();l=1}});f.on(e.ga(w),"blur",function(){try{w&&w.selection.empty()}catch(N){}});J.on("mousedown",function(){v()});J.on("mouseup",function(){h=C;setTimeout(function(){n(C)},0)});var v=function(){h=A},n=function(N){if(h){var O=x.document,V=x.getSelection(),X=V&&
V.pb(),W=V&&O.selection;if(N&&W&&X==i.Kb)if(!O.queryCommandEnabled("InsertImage")){setTimeout(function(){n(C)},50);return}var aa;if(!(W&&X==i.pa&&(aa=e.d(V.ob()))&&aa in{input:1,textarea:1})){c=W&&W.createRange();x.jb()}}};J.on("keydown",v);J.on("keyup",function(){h=C;n()});f.on(w,"selectionchange",n)}else{f.on(w,"mouseup",x.jb,x);f.on(w,"keyup",x.jb,x)}var E={table:1,pre:1},Q=/\s*<(p|div|address|h\d|center)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\1>)?(?=\s*$|<\/body>)/gi,P=k.Ia.Va(C);
x.on("selectionChange",function(N){var O=N.path;N=(N=N.selection)&&N.H()[0];if(!(!N||!N.collapsed||O.w))if(O.D.d()=="body"){O=N.nb(C,"p");if(O.fb().match(Q)){var V=O.Ka(P);if(V&&V[0].nodeType==j.e&&!E[V.d()]){N.sb(V);O.h()}else if((V=O.sa(P))&&V[0].nodeType==j.e&&!E[V.d()]){N.sb(V,V.fb().match(Q)?A:C);O.h()}}N.select();a||x.ub()}})}k.he={Kb:1,pa:2,ab:3};var C=T,A=Y,s=U,q=KISSY,m=q.UA,e=q.DOM,f=q.Event,d=q.Node,i=k.he,u=k.oa,j=k.n,a=!window.getSelection,b=k.Ia,g=k.Range,o={img:1,hr:1,li:1,table:1,
tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};q.augment(y,{z:!a?function(){var x=this.c.M;return x.tc||(x.tc=e.ga(this.document).getSelection())}:function(){var x=this.c.M;return x.tc||(x.tc=this.document.selection)},pb:!a?function(){var x=this.c.M;if(x.type)return x.type;var w=i.pa,J=this.z();if(J){if(J.rangeCount==1){J=J.getRangeAt(0);var t=J.startContainer;if(t==J.endContainer&&t.nodeType==j.e&&J.endOffset-J.startOffset===
1&&o[t.childNodes[J.startOffset].nodeName.toLowerCase()])w=i.ab}}else w=i.Kb;return x.type=w}:function(){var x=this.c.M;if(x.type)return x.type;var w=i.Kb;try{var J=this.z(),t=J.type;if(t=="Text")w=i.pa;if(t=="Control")w=i.ab;if(J.createRange().parentElement)w=i.pa}catch(c){}return x.type=w},H:a?function(){function x(w,J){w=w.duplicate();w.collapse(J);for(var t=w.parentElement(),c=t.childNodes,h,l=0;l<c.length;l++){var v=c[l];if(v.nodeType==j.e){h=w.duplicate();h.moveToElementText(v);v=h.compareEndPoints("StartToStart",
w);var n=h.compareEndPoints("EndToStart",w);h.collapse();if(v>0)break;else if(!v||n==1&&v==-1)return{xa:t,offset:l};else if(!n)return{xa:t,offset:l+1};h=s}}if(!h){h=w.duplicate();h.moveToElementText(t);h.collapse(A)}h.setEndPoint("StartToStart",w);h=String(h.text).replace(/\r\n|\r/g,"\n").length;try{for(;h>0;)h-=c[--l].nodeValue.length}catch(E){h=0}return h===0?{xa:t,offset:l}:{xa:c[l],offset:-h}}return function(){var w=this.c.M;if(w.na)return w.na;var J=this.z(),t=J&&J.createRange(),c=this.pb();
if(!J)return[];if(c==i.pa){J=new g(this.document);c=x(t,C);J.setStart(new d(c.xa),c.offset);c=x(t);J.setEnd(new d(c.xa),c.offset);return w.na=[J]}else if(c==i.ab){w=w.na=[];for(c=0;c<t.length;c++){var h=t.item(c),l=h.parentNode,v=0;for(J=new g(this.document);v<l.childNodes.length&&l.childNodes[v]!=h;v++);J.setStart(new d(l),v);J.setEnd(new d(l),v+1);w.push(J)}return w}return w.na=[]}}():function(){var x=this.c.M;if(x.na)return x.na;var w=[],J=this.z();if(!J)return[];for(var t=0;t<J.rangeCount;t++){var c=
J.getRangeAt(t),h=new g(this.document);h.setStart(new d(c.startContainer),c.startOffset);h.setEnd(new d(c.endContainer),c.endOffset);w.push(h)}return x.na=w},ob:function(){var x=this.c.M;if(x.Vd!==undefined)return x.Vd;var w,J=this.z();switch(this.pb()){case i.ab:return this.mc();case i.pa:var t=this.H()[0];if(t)if(!t.collapsed){for(t.vc();C;){w=t.startContainer;if(t.startOffset==(w[0].nodeType===j.e?w[0].childNodes.length:w[0].nodeValue.length)&&!w.qa())t.setStartAfter(w);else break}w=t.startContainer;
if(w[0].nodeType!=j.e)return w.parent();w=new d(w[0].childNodes[t.startOffset]);if(!w[0]||w[0].nodeType!=j.e)return t.startContainer;for(t=w[0].firstChild;t&&t.nodeType==j.e;){w=new d(t);t=t.firstChild}return w}if(a){t=J.createRange();t.collapse(C);w=t.parentElement()}else if((w=J.anchorNode)&&w.nodeType!=j.e)w=w.parentNode}return x.Vd=w?e.C(w):s},mc:function(){var x=this,w,J=x.c.M;if(J.Td!==undefined)return J.Td;if(a){w=x.z().createRange();w=w.item&&w.item(0)}w||(w=function(){for(var t=x.H()[0],
c,h,l=2;l&&!((c=t.xd())&&c[0].nodeType==j.e&&o[c.d()]&&(h=c));l--)t.Ta(u.fa);return h&&h[0]}());return J.Td=e.C(w)},reset:function(){this.c.M={}},Ac:function(x){var w,J=this.document;if(a)try{w=J.body.createControlRange();w.addElement(x[0]);w.select()}catch(t){w=J.body.createTextRange();w.moveToElementText(x[0]);w.select()}finally{}else{w=J.createRange();w.selectNode(x[0]);x=this.z();x.removeAllRanges();x.addRange(w)}this.reset()},Ab:function(x){if(a){if(x.length>1){var w=x[x.length-1];x[0].setEnd(w.endContainer,
w.endOffset);x.length=1}x[0]&&x[0].select()}else{w=this.z();if(!w)return;w.removeAllRanges();for(var J=0;J<x.length;J++){var t=x[J],c=this.document.createRange(),h=t.startContainer;t.collapsed&&m.gecko&&m.gecko<1.09&&h[0].nodeType==j.e&&!h[0].childNodes.length&&h[0].appendChild(this.document.createTextNode(""));c.setStart(h[0],t.startOffset);c.setEnd(t.endContainer[0],t.endOffset);w.addRange(c)}}this.reset()},Xe:function(x){for(var w=[],J=this.H(),t=0;t<J.length;t++)w.push(J[t].md(x));return w},We:function(x,
w){var J=[],t=this.document,c;w=w||this.H();for(var h=w.length,l=0;l<h;l++){J.push(c=w[l].O(x,C));var v=(x=c.Ud)?q.one("#"+c.aa,t):c.aa;c=x?q.one("#"+c.Q,t):c.Q;for(var n=l+1;n<h;n++){var E=w[n],Q=E.startContainer,P=E.endContainer;e.g(Q,v.parent())&&E.startOffset++;e.g(Q,c.parent())&&E.startOffset++;e.g(P,v.parent())&&E.endOffset++;e.g(P,c.parent())&&E.endOffset++}}return J},Sd:function(x){for(var w=[],J=0;J<x.length;J++){var t=new g(this.document);t.moveToBookmark(x[J]);w.push(t)}this.Ab(w);return this},
Aa:function(){var x=this.H();return x[0].startContainer.Pb(x[x.length-1].endContainer)},scrollIntoView:function(){var x=this.ob();x&&x.Vb()},removeAllRanges:function(){var x=this.z();if(a)x&&x.clear();else x&&x.removeAllRanges()}});var z={table:1,tbody:1,tr:1},B=b.Va(C),r=/\ufeff|\u00a0/;g.prototype.select=g.prototype.select=!a?function(){var x=this.startContainer;this.collapsed&&x[0].nodeType==j.e&&!x[0].childNodes.length&&x[0].appendChild(this.document.createTextNode(""));var w=this.document.createRange();
w.setStart(x[0],this.startOffset);try{w.setEnd(this.endContainer[0],this.endOffset)}catch(J){if(J.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0){this.collapse(C);w.setEnd(this.endContainer[0],this.endOffset)}else throw J;}x=p(this.document).z();x.removeAllRanges();x.addRange(w)}:function(x){var w=this.collapsed,J,t;if(this.startContainer[0]===this.endContainer[0]&&this.endOffset-this.startOffset==1){var c=this.startContainer[0].childNodes[this.startOffset];if(c.nodeType==j.e){(new y(this.document)).Ac(new d(c));
return}}if(this.startContainer[0].nodeType==j.e&&this.startContainer.d()in z||this.endContainer[0].nodeType==j.e&&this.endContainer.d()in z)this.Ta(u.fa,C);var h=this.O();c=h.aa;var l;if(!w)l=h.Q;h=this.document.body.createTextRange();h.moveToElementText(c[0]);h.moveStart("character",1);if(l){x=this.document.body.createTextRange();x.moveToElementText(l[0]);h.setEndPoint("EndToEnd",x);h.moveEnd("character",-1)}else{for(J=c[0].nextSibling;J&&!B(J);)J=J.nextSibling;J=!(J&&J.nodeValue&&J.nodeValue.match(r))&&
(x||!c[0].previousSibling||c[0].previousSibling&&e.d(c[0].previousSibling)=="br");t=new d(this.document.createElement("span"));t.html("&#65279;");t.insertBefore(c);J&&e.insertBefore(this.document.createTextNode("\ufeff"),c)}this.setStartBefore(c);c.h();if(w){if(J){h.moveStart("character",-1);h.select();this.document.selection.clear()}else h.select();if(t){this.G(t,u.B);t.h()}}else{this.setEndBefore(l);l.h();h.select()}};y.getSelection=p;k.Nc=y;k.Selection=y;b=y.prototype;k.k.o(b,{getNative:b.z,getType:b.pb,
getRanges:b.H,getStartElement:b.ob,getSelectedElement:b.mc,reset:b.reset,selectElement:b.Ac,selectRanges:b.Ab,createBookmarks2:b.Xe,createBookmarks:b.We,getCommonAncestor:b.Aa,scrollIntoView:b.scrollIntoView,selectBookmarks:b.Sd,removeAllRanges:b.removeAllRanges});k.on("instanceCreated",function(x){I(x.bf)})});
KISSY.Editor.add("styles",function(k){function y(F){return!F.attr("_ke_bookmark")}function p(F,K){for(var D in F)if(F.hasOwnProperty(D))if(J.isString(F[D]))F[D]=F[D].replace(aa,function(H,G){return K[G]});else p(F[D],K)}function I(F,K){if(K){F=J.clone(F);p(F,K)}var D=this.element=this.element=(F.element||"*").toLowerCase();this.type=this.type=D=="#"||V[D]?h.Lb:X[D]?h.cb:h.Ha;this.c={definition:F}}function C(F,K){var D=K?this.zc:this.Xb;F.body.focus();for(var H=new v(F),G=H.H(),M=0;M<G.length;M++)D.call(this,
G[M]);H.Ab(G)}function A(F,K,D){var H=F.element;if(H=="*")H="span";K=new P(K.createElement(H));D&&D.Qc(K);return s(K,F)}function s(F,K){var D=K.c.definition,H=D.attributes;D=I.yd(D);if(H)for(var G in H)F.attr(G,H[G]);if(D)F[0].style.cssText=D;return F}function q(F){var K=F.O(r),D=F.Ye();D.gc=r;D.rd=r;for(var H,G=F.document;H=D.kf();){var M=A(this,G,H);H=H;var L=M;M=L.d=="pre";var R=H.d=="pre",S=!M&&R;if(M&&!R){R=H;L=L;S=R.html();S=m(S,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");S=S.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,
"$1");S=S.replace(/([ \t\n\r]+|&nbsp;)/g," ");S=S.replace(/<br\b[^>]*>/gi,"\n");if(N.ie){R=R[0].ownerDocument.createElement("div");R.appendChild(L[0]);L[0].outerHTML="<pre>"+S+"</pre>";L=new P(R.firstChild);L.h()}else L.html(S);L=L}else if(S)L=f(e(H),L);else H.Tb(L);H[0].parentNode.replaceChild(L[0],H[0]);if(M){H=L;M=void 0;if((M=H.ha(r,n.e))&&M.d()=="pre"){L=m(M.html(),/\n$/,"")+"\n\n"+m(H.html(),/^\n/,"");if(N.ie)H[0].outerHTML="<pre>"+L+"</pre>";else H.html(L);M.h()}}}F.moveToBookmark(K)}function m(F,
K,D){var H="",G="";F=F.replace(/(^<span[^>]+_ke_bookmark.*?\/span>)|(<span[^>]+_ke_bookmark.*?\/span>$)/gi,function(M,L,R){L&&(H=L);R&&(G=R);return""});return H+F.replace(K,D)+G}function e(F){var K=[];m(F.fb(),/(\S\s*)\n(?:\s|(<span[^>]+_ck_bookmark.*?\/span>))*\n(?!$)/gi,function(D,H,G){return H+"</pre>"+G+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(D,H){K.push(H)});return K}function f(F,K){for(var D=K[0].ownerDocument.createDocumentFragment(),H=0;H<F.length;H++){var G=F[H];G=G.replace(/(\r\n|\r)/g,
"\n");G=m(G,/^[ \t]*\n/,"");G=m(G,/\n$/,"");G=m(G,/^[ \t]+|[ \t]+$/g,function(L,R){return L.length==1?"&nbsp;":R?" "+Array(L.length).join("&nbsp;"):Array(L.length).join("&nbsp;")+" "});G=G.replace(/\n/g,"<br>");G=G.replace(/[ \t]{2,}/g,function(L){return Array(L.length).join("&nbsp;")+" "});var M=K.K();M.html(G);D.appendChild(M[0])}return D}function d(F){var K=F.document;if(F.collapsed){K=A(this,K,undefined);F.insertNode(K);F.G(K,l.J)}else{var D=this.element,H=this.c.definition,G,M=k.m[D]||(G=r,k.m.span),
L=F.O();F.Oa(l.Ib);F.trim();var R=F.O(),S=R.aa;R=R.Q;for(var $=S,da;$&&$[0];){var Z=x;if(c.g($,R)){$=w;Z=r}else{var ba=$[0].nodeType,fa=ba==n.e?$.d():w;if(fa&&$.attr("_ke_bookmark")){$=$.v(r);continue}if(!fa||M[fa]&&($.La(R)|E.$|E.ea|E.Z)==E.$+E.ea+E.Z&&(!H.childRule||H.childRule($))){var ha=$.parent();if(ha&&ha[0]&&((k.m[ha.d()]||k.m.span)[D]||G)&&(!H.parentRule||H.parentRule(ha))){if(!da&&(!fa||!k.m.ca[fa]||($.La(R)|E.$|E.ea|E.Z)==E.$+E.ea+E.Z)){da=new Q(K);da.setStartBefore($)}if(ba==n.f||ba==
n.e&&!$[0].childNodes.length){ba=$;for(var ga;(Z=!ba.Ka(y))&&(ga=ba.parent(),M[ga.d()])&&(ga.La(S)|E.da|E.ea|E.Z)==E.da+E.ea+E.Z&&(!H.childRule||H.childRule(ga));)ba=ga;da.setEndAfter(ba)}}else Z=r}else Z=r;$=$.v()}if(Z&&da&&!da.collapsed){Z=A(this,K,undefined);ba=da.Aa();fa={Kf:{},Ne:{},gd:{},fd:{}};for(var ea,ia,ja;Z&&ba&&Z[0]&&ba[0];){if(ba.d()==D){for(ea in H.attributes)if(!(fa.fd[ea]||!(ja=ba.attr(ia))))if(Z.attr(ea)==ja)Z.removeAttr(ea);else fa.fd[ea]=1;for(ia in H.styles)if(!(fa.gd[ia]||!(ja=
ba.L(ia))))if(Z.L(ia)==ja)Z.L(ia,"");else fa.gd[ia]=1;if(!Z.eb()){Z=w;break}}ba=ba.parent()}if(Z){Z[0].appendChild(da.extractContents());o(this,Z);da.insertNode(Z);Z.ra();N.ie||Z[0].normalize()}else{Z=new P(K.createElement("span"));Z[0].appendChild(da.extractContents());da.insertNode(Z);o(this,Z);Z.h(T)}da=w}}S.h();R.h();F.moveToBookmark(L);F.Ta(l.Lc)}}function i(F){F.Oa(l.Ib);var K=F.O(),D=K.aa;if(F.collapsed){for(var H=new O(D.parent()),G,M=0,L;M<H.elements.length&&(L=H.elements[M]);M++){if(L==
H.w||L==H.D)break;if(this.ja(L)){var R=F.dc(L,l.ce),S=!R&&F.dc(L,l.bb);if(S||R){G=L;G.match=S?"start":"end"}else{L.ra();if(L.d()!=this.element){R=a(this);z(L,R[L.d()]||R["*"])}else b(this,L)}}}if(G&&G[0]){L=D;for(M=0;;M++){R=H.elements[M];if(c.g(R,G))break;else if(R.match)continue;else R=R.K();R[0].appendChild(L[0]);L=R}c[G.match=="start"?"insertBefore":"insertAfter"](L,G)}}else{var $=K.Q,da=this;H=function(){for(var Z=new O(D.parent()),ba=new O($.parent()),fa=w,ha=w,ga=0;ga<Z.elements.length;ga++){var ea=
Z.elements[ga];if(ea==Z.w||ea==Z.D)break;if(da.ja(ea))fa=ea}for(ga=0;ga<ba.elements.length;ga++){ea=ba.elements[ga];if(ea==ba.w||ea==ba.D)break;if(da.ja(ea))ha=ea}ha&&$.Ob(ha);fa&&D.Ob(fa)};H();for(G=new P(D[0].nextSibling);G[0]!==$[0];){M=G.v();if(G[0]&&G[0].nodeType==n.e&&this.ja(G)){if(G.d()==this.element)b(this,G);else{L=a(this);z(G,L[G.d()]||L["*"])}if(M[0].nodeType==n.e&&M.contains(D)){H();M=new P(D[0].nextSibling)}}G=M}}F.moveToBookmark(K)}function u(F){F=String(F);var K={};F.replace(/&quot;/g,
'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(D,H,G){K[H]=G});return K}function j(F,K){var D="";if(K!==x){D=document.createElement("span");D.style.cssText=F;D=D.style.cssText||""}else D=F;return D.replace(/\s*([;:])\s*/,"$1").replace(/([^\s;])$/,"$1;").replace(/,\s+/g,",").toLowerCase()}function a(F){if(F.c.Rd)return F.c.Rd;var K=F.c.Rd={},D=F.c.definition.overrides;if(D){J.isArray(D)||(D=[D]);for(var H=0;H<D.length;H++){var G=D[H],M,L,R;if(typeof G=="string")M=G.toLowerCase();else{M=
G.element?G.element.toLowerCase():F.element;L=G.attributes;R=G.styles}G=K[M]||(K[M]={});if(L){M=G.attributes=G.attributes||[];for(var S in L)L.hasOwnProperty(S)&&M.push([S.toLowerCase(),L[S]])}if(R){G=G.styles=G.styles||[];for(var $ in R)R.hasOwnProperty($)&&G.push([$.toLowerCase(),R[$]])}}}return K}function b(F,K){var D=F.c.definition,H=a(F),G=t.mix(D.attributes,(H[K.d()]||H["*"]||{}).attributes);D=t.mix(D.styles,(H[K.d()]||H["*"]||{}).styles);H=J.isEmptyObject(G)&&J.isEmptyObject(D);for(var M in G)if(G.hasOwnProperty(M))if(!((M==
"class"||F.c.definition.fullMatch)&&K.attr(M)!=g(M,G[M]))){H=H||!!K.Rb(M);K.removeAttr(M)}for(var L in D)if(D.hasOwnProperty(L))if(!(F.c.definition.fullMatch&&K.L(L)!=g(L,D[L],r))){H=H||!!K.L(L);K.L(L,"")}B(K)}function g(F,K,D){var H=new P("<span>");H[D?"_4e_style":"attr"](F,K);return H[D?"_4e_style":"attr"](F)}function o(F,K){for(var D=a(F),H=K.all(F.element),G=H.length;--G>=0;)b(F,new P(H[G]));for(var M in D)if(M!=F.element){H=K.all(M);for(G=H.length-1;G>=0;G--){var L=new P(H[G]);z(L,D[M])}}}function z(F,
K){var D,H=K&&K.attributes;if(H)for(D=0;D<H.length;D++){var G=H[D][0],M;if(M=F.attr(G)){var L=H[D][1];if(L===w||L.test&&L.test(M)||typeof L=="string"&&M==L)F[0].removeAttribute(G)}}if(H=K&&K.styles)for(D=0;D<H.length;D++){G=H[D][0];if(L=F.css(G)){var R=H[D][1];if(R===w||R.test&&R.test(M)||typeof R=="string"&&L==R)F.css(G,"")}}B(F)}function B(F){if(!F.eb()){var K=F[0].firstChild,D=F[0].lastChild;F.h(r);if(K){K.nodeType==n.e&&c.ra(K);D&&K!=D&&D.nodeType==n.e&&c.ra(D)}}}var r=T,x=Y,w=U,J=KISSY,t=k.k,
c=J.DOM,h={Lb:1,Ha:2,cb:3},l=k.oa,v=k.Nc,n=k.n,E=k.$a,Q=k.Range,P=J.Node,N=J.UA,O=k.Za,V={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1},X={embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1},W=/\s*(?:;\s*|$)/g,aa=/#\((.+?)\)/g;k.kg=h;I.prototype={apply:function(F){C.call(this,F,x)},remove:function(F){C.call(this,F,r)},Xb:function(F){return(this.Xb=this.type==h.Ha?d:this.type==h.Lb?q:this.type==h.cb?w:w).call(this,F)},zc:function(F){return(this.zc=this.type==
h.Ha?i:w).call(this,F)},Ke:function(F){s(F,this)},ja:function(F,K){if(!F)return x;var D=this.c.definition,H;if(F.d()==this.element){if(!K&&!F.eb())return r;var G=D.re;if(G)D=G;else{G={};var M=0,L=D.attributes;if(L)for(var R in L){M++;G[R]=L[R]}if(L=I.yd(D)){G.style||M++;G.style=L}G._length=M;D=D.re=G}if(D._length){for(var S in D)if(S!="_length"){M=F.attr(S)||"";if(S=="style")a:{G=D[S];M=j(M,x);typeof G=="string"&&(G=u(G));typeof M=="string"&&(M=u(M));L=void 0;for(L in G)if(!(L in M&&(M[L]==G[L]||
G[L]=="inherit"||M[L]=="inherit"))){G=x;break a}G=r}else G=D[S]==M;if(G){if(!K)return r}else if(K)return x}if(K)return r}else return r}S=a(this);if(S=S[F.d()]||S["*"]){if(!(D=S.attributes)&&!(H=S.Kf))return r;if(D)for(G=0;G<D.length;G++){S=D[G][0];if(S=F.attr(S)){M=D[G][1];if(M===w||typeof M=="string"&&S==M||M.test&&M.test(S))return r}}if(H)for(G=0;G<H.length;G++)if(S=F.css(H[G][0])){D=H[G][1];if(D===w||typeof D=="string"&&S==D||D.test&&D.test(S))return r}}return x},Se:function(F){switch(this.type){case h.Lb:return this.ja(F.w||
F.D,r);case h.cb:case h.Ha:for(var K=F.elements,D=0,H;D<K.length;D++){H=K[D];if(!(this.type==h.Ha&&(c.g(H,F.w)||c.g(H,F.D))))if(!(this.type==h.cb&&!(H.d()in X)))if(this.ja(H,r))return r}}return x}};I.yd=function(F){var K=F.se;if(K)return K;K=F.styles;var D=F.attributes&&F.attributes.style||"",H="";if(D.length)D=D.replace(W,";");for(var G in K){var M=K[G],L=(G+":"+M).replace(W,";");if(M=="inherit")H+=L;else D+=L}if(D.length)D=j(D);D+=H;return F.se=D};k.lg=I;k.Style=I;var ca=I.prototype;k.k.o(ca,{apply:ca.apply,
remove:ca.remove,applyToRange:ca.Xb,removeFromRange:ca.zc,applyToObject:ca.Ke,checkElementRemovable:ca.ja,checkActive:ca.Se})});
KISSY.Editor.add("htmlparser",function(){function k(){}function y(){this.c={Bd:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)--\>)|(?:([^\\s>]+)\\s*((?:(?:[^\"'>]+)|(?:\"[^\"]*\")|(?:'[^']*'))*)\\/?>))","g")}}var p=KISSY,I=p.Editor,C=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,A={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},s=I.m;p.augment(y,{Da:k,Qd:k,ma:k,Md:k,Ra:k,parse:function(q){for(var m,
e,f=0,d;m=this.c.Bd.exec(q);){e=m.index;if(e>f){f=q.substring(f,e);d?d.push(f):this.ma(f)}f=this.c.Bd.lastIndex;if(e=m[1]){e=e.toLowerCase();if(d&&s.Fc[e]){this.Md(d.join(""));d=U}if(!d){this.Qd(e);continue}}if(d)d.push(m[0]);else if(e=m[3]){e=e.toLowerCase();if(!/="/.test(e)){var i={},u;m=m[4];var j=!!(m&&m.charAt(m.length-1)=="/");if(m)for(;u=C.exec(m);){var a=u[1].toLowerCase();u=u[2]||u[3]||u[4]||"";i[a]=!u&&A[a]?a:u}this.Da(e,i,j);if(!d&&s.Fc[e])d=[]}}else if(e=m[2])this.Ra(e)}q.length>f&&this.ma(q.substring(f,
q.length))}});I.j=y;I.HtmlParser=y});
KISSY.Editor.add("htmlparser-basicwriter",function(){function k(){this.c={l:[]}}var y=KISSY,p=y.Editor,I=p.k;y.augment(k,{vb:function(C){this.c.l.push("<",C)},wb:function(C,A){A?this.c.l.push(" />"):this.c.l.push(">")},kb:function(C,A){if(typeof A=="string")A=I.pc(A);this.c.l.push(" ",C,'="',A,'"')},lb:function(C){this.c.l.push("</",C,">")},text:function(C){this.c.l.push(C)},N:function(C){this.c.l.push("<!--",C,"--\>")},write:function(C){this.c.l.push(C)},reset:function(){this.c.l=[];this.c.A=Y},
kc:function(C){var A=this.c.l.join("");C&&this.reset();return A}});p.j.Gb=k;p.j.BasicWriter=k;y=k.prototype;p.k.o(y,{openTag:y.vb,openTagClose:y.wb,attribute:y.kb,closeTag:y.lb,text:y.text,comment:y.N,write:y.write,reset:y.reset,getHtml:y.kc})});
KISSY.Editor.add("htmlparser-htmlwriter",function(){function k(){k.superclass.constructor.call(this);this.Cd="\t";this.Ff=" />";this.wf="\n";this.ff=A;this.Gf=C;this.c.A=A;this.c.F="";this.c.rules={};var s=p.m,q;for(q in I.mix({},s.Fb,s.Xa,s.Eb,s.Ic))this.Fa(q,{A:C,Pe:C,cc:C,hd:!s[q]["#"],Oe:C});this.Fa("br",{cc:C});this.Fa("title",{A:A,cc:A});this.Fa("style",{A:A,hd:C});this.Fa("pre",{A:A})}var y=KISSY,p=y.Editor,I=p.k,C=T,A=Y;y.extend(k,p.j.Gb,{vb:function(s){var q=this.c.rules[s];if(this.c.A)this.F();
else if(q&&q.Pe){this.Pa();this.F()}this.c.l.push("<",s)},wb:function(s,q){var m=this.c.rules[s];if(q)this.c.l.push(this.Ff);else{this.c.l.push(">");if(m&&m.A)this.c.F+=this.Cd}m&&m.cc&&this.Pa()},kb:function(s,q){if(typeof q=="string"){this.ff&&(q=q.replace(/&amp;/g,"&"));q=I.pc(q)}this.c.l.push(" ",s,'="',q,'"')},lb:function(s){var q=this.c.rules[s];if(q&&q.A)this.c.F=this.c.F.substr(this.Cd.length);if(this.c.A)this.F();else if(q&&q.hd){this.Pa();this.F()}this.c.l.push("</",s,">");q&&q.Oe&&this.Pa()},
text:function(s){if(this.c.A){this.F();s=I.Qa(s)}this.c.l.push(s)},N:function(s){this.c.A&&this.F();this.c.l.push("<!--",s,"--\>")},Pa:function(){this.c.l.length>0&&this.c.l.push(this.wf);this.c.A=C},F:function(){this.c.l.push(this.c.F);this.c.A=A},Fa:function(s,q){var m=this.c.rules[s];if(m)I.mix(m,q);else this.c.rules[s]=q}});p.j.Zf=k;p.j.HtmlWriter=k;y=k.prototype;p.k.o(y,{openTag:y.vb,openTagClose:y.wb,attribute:y.kb,closeTag:y.lb,text:y.text,comment:y.N,lineBreak:y.Pa,indentation:y.F,setRules:y.Fa})});
KISSY.Editor.add("htmlparser-fragment",function(){function k(){this.children=[];this.parent=I;this.c={S:y,oc:p}}var y=T,p=Y,I=U,C=KISSY.Editor,A={colgroup:1,dd:1,dt:1,li:1,option:1,p:1,td:1,tfoot:1,th:1,thead:1,tr:1},s=KISSY,q=C.k,m=C.n,e=C.m;q.mix({table:1,ul:1,ol:1,dl:1},e.table,e.ul,e.ol,e.dl);var f=e.Zd,d=e.Eb;k.Jb=function(i,u){function j(c){var h;if(z.length>0)for(var l=0;l<z.length;l++){var v=z[l],n=v.name,E=e[n],Q=r.name&&e[r.name];if((!Q||Q[n])&&(!c||!E||E[c]||!e[c])){if(!h){a();h=1}v=v.clone();
v.parent=r;r=v;z.splice(l,1);l--}}}function a(){for(;B.length;)r.add(B.shift())}function b(c,h,l){h=h||r||o;if(u&&!h.type){var v,n;if((v=c.attributes&&(n=c.attributes._ke_real_element_type)?n:c.name)&&!(v in e.Ec)&&!(v in e.Fb)){n=r;r=h;g.Da({Yg:"ul",Pg:"dl",Jg:"dl"}[v]||u,{});h=r;if(l)r=n}}if(c.c.S&&c.name!="pre"){l=c.children.length;if((v=c.children[l-1])&&v.type==m.f)if(n=q.Sa(v.value))v.value=n;else c.children.length=l-1}h.add(c);if(c.yb){r=c.yb;delete c.yb}}var g=new C.j,o=new k,z=[],B=[],r=
o,x=p,w;g.Da=function(c,h,l){var v=new C.j.Jc(c,h);if(v.rc&&l)v.rb=y;if(e.ca[c])z.push(v);else{if(c==="pre")x=y;else if(c==="br"&&x){r.add(new C.j.Mb("\n"));return}if(c==="br")B.push(v);else{var n=r.name,E=n&&(e[n]||(r.c.S?e.div:e.span));if(E&&!v.rc&&!r.rc&&!E[c]){E=p;var Q;if(c in f&&n in f){n=r.children;(n=n[n.length-1])&&n.name in d||b(n=new C.j.Jc("li"),r);w=r;Q=n}else if(c==n)b(r,r.parent);else{b(r,r.parent,y);!A[n]&&n in e.Db&&z.unshift(r);E=y}r=Q?Q:r.yb||r.parent;if(E){g.Da.apply(this,arguments);
return}}j(c);a();v.parent=r;v.yb=w;w=0;if(v.rb)b(v);else r=v}}};g.Qd=function(c){for(var h=z.length-1;h>=0;h--)if(c==z[h].name){z.splice(h,1);return}for(var l=[],v=[],n=r;n.type&&n.name!=c;){n.c.S||v.unshift(n);l.push(n);n=n.parent}if(n.type){for(h=0;h<l.length;h++){var E=l[h];b(E,E.parent)}r=n;if(r.name=="pre")x=p;n.c.S&&a();b(n,n.parent);if(n==r)r=r.parent;z=z.concat(v)}if(c=="body")u=p};g.ma=function(c){if(!r.c.oc&&!x){c=q.Qa(c);if(c.length===0)return}a();j();if(u&&(!r.type||r.name=="body")&&q.trim(c))this.Da(u,
{});x||(c=c.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));r.add(new C.j.Mb(c))};g.Md=function(){};g.Ra=function(c){r.add(new C.j.ae(c))};g.parse(i);for(a();r.type;){var J=r.parent,t=r;if(u&&(!J.type||J.name=="body")&&!e.Ec[t.name]){r=J;g.Da(u,{});J=r}J.add(t);r=J}return o};s.augment(k,{add:function(i){var u=this.children.length;if(u=u>0&&this.children[u-1]||I){if(i.c.S&&u.type==m.f){u.value=q.Sa(u.value);if(u.value.length===0){this.children.pop();this.add(i);return}}u.next=i}i.xb=u;i.parent=this;this.children.push(i);
this.c.oc=i.type==m.f||i.type==m.e&&!i.c.S},ba:function(i,u){var j;this.filterChildren=this.ic=function(){var a=new C.j.Gb;this.X.call(this,a,u,y);a=a.kc();this.children=(new k.Jb(a)).children;j=1};!this.name&&u&&u.Od(this);this.X(i,j?I:u)},X:function(i,u){for(var j=0;j<this.children.length;j++)this.children[j].ba(i,u)}});C.j.Ga=k;C.j.Fragment=k;k.FromHtml=k.Jb;s=k.prototype;C.k.o(s,{add:s.add,writeHtml:s.ba,writeChildrenHtml:s.X})});
KISSY.Editor.add("htmlparser-element",function(){function k(A,s){A=A[0];s=s[0];return A<s?-1:A>s?1:0}function y(A,s){this.name=A;this.attributes=s||(s={});this.children=[];var q=s.rg||A,m=p.m;q=!!(m.Fb[q]||m.Xa[q]||m.Eb[q]||m.Ic[q]||m.Hc[q]||q=="br");var e=!!m.Cb[A];this.rb=e;this.rc=!m[A];this.c={S:q,oc:e||!q}}var p=KISSY.Editor,I=p.n;KISSY.augment(y,{type:I.e,add:p.j.Ga.prototype.add,clone:function(){return new y(this.name,this.attributes)},ba:function(A,s){var q=this.attributes,m=this,e=m.name,
f,d,i,u;m.ic=function(){if(!u){var b=new p.j.Gb;p.j.Ga.prototype.X.call(m,b,s);m.children=(new p.j.Ga.Jb(b.kc())).children;u=1}};m.filterChildren=m.ic;if(s){for(;;){if(!(e=s.Nd(e)))return;m.name=e;if(!(m=s.uc(m)))return;m.parent=this.parent;if(m.name==e)break;if(m.type!=I.e){m.ba(A,s);return}e=m.name;if(!e){this.X.call(m,A,u?U:s);return}}q=m.attributes}A.vb(e,q);for(var j=[],a=0;a<2;a++)for(f in q){d=f;i=q[f];if(a==1)j.push([f,i]);else if(s){for(;;)if(d=s.Ld(f))if(d!=f){delete q[f];f=d}else break;
else{delete q[f];break}if(d)if((i=s.Kd(m,d,i))===Y)delete q[d];else q[d]=i}}A.Gf&&j.sort(k);q=j.length;for(a=0;a<q;a++){f=j[a];A.kb(f[0],f[1])}A.wb(e,m.rb);if(!m.rb){this.X.call(m,A,u?U:s);A.lb(e)}},X:function(){p.j.Ga.prototype.X.apply(this,arguments)}});p.j.Jc=y;p.j.Element=y;var C=y.prototype;p.k.o(C,{type:C.type,add:C.add,clone:C.clone,writeHtml:C.ba,writeChildrenHtml:C.X})});
KISSY.Editor.add("htmlparser-filter",function(){function k(f){this.c={fc:[],Zb:[],elements:{Gc:0},attributes:{Gc:0}};f&&this.ed(f,10)}function y(f,d){for(var i=0;f&&i<d.length;i++){var u=d[i];f=f.replace(u[0],u[1])}return f}function p(f,d,i){if(typeof d=="function")d=[d];var u,j;j=f.length;var a=d&&d.length;if(a){for(u=0;u<j&&f[u].yc<i;u++);for(j=a-1;j>=0;j--)if(a=d[j]){a.yc=i;f.splice(u,0,a)}}}function I(f,d,i){if(d)for(var u in d){var j=f[u];f[u]=C(j,d[u],i);j||f.Gc++}}function C(f,d,i){if(d){d.yc=
i;if(f){if(f.splice)p(f,d,i);else{f=f.yc>i?[d,f]:[f,d];f.filter=A}return f}else return d.filter=d}}function A(f){for(var d=f.type||f instanceof q.j.Ga,i=0;i<this.length;i++){if(d)var u=f.type,j=f.name;var a=this[i].apply(window,arguments);if(a===e)return a;if(d){if(a&&(a.name!=j||a.type!=u))return a}else if(typeof a!="string")return a;a!=undefined&&(f=a)}return f}var s=KISSY,q=s.Editor,m=q.n,e=Y;s.augment(k,{ed:function(f,d){if(typeof d!="number")d=10;p(this.c.fc,f.fc,d);p(this.c.Zb,f.Zb,d);I(this.c.elements,
f.elements,d);I(this.c.attributes,f.attributes,d);this.c.text=C(this.c.text,f.text,d)||this.c.text;this.c.N=C(this.c.N,f.N,d)||this.c.N;this.c.zb=C(this.c.zb,f.zb,d)||this.c.zb},Nd:function(f){return y(f,this.c.fc)},Ld:function(f){return y(f,this.c.Zb)},ma:function(f){var d=this.c.text;return d?d.filter(f):f},Ra:function(f,d){var i=this.c.N;return i?i.filter(f,d):f},Od:function(f){var d=this.c.zb;return d?d.filter(f):f},uc:function(f){for(var d=[this.c.elements["^"],this.c.elements[f.name],this.c.elements.Qf],
i,u=0;u<3;u++)if(i=d[u]){i=i.filter(f,this);if(i===e)return U;if(i&&i!=f)return this.Pd(i);if(f.parent&&!f.name)break}return f},Pd:function(f){var d=f.type;return d==m.e?this.uc(f):d==m.f?new q.j.Mb(this.ma(f.value)):U},Kd:function(f,d,i){if(d=this.c.attributes[d]){f=d.filter(i,f,this);if(f===e)return e;if(typeof f!="undefined")return f}return i}});q.j.Yf=k;s=k.prototype;q.k.o(s,{addRules:s.ed,onElementName:s.Nd,onAttributeName:s.Ld,onText:s.ma,onComment:s.Ra,onFragment:s.Od,onElement:s.uc,onNode:s.Pd,
onAttribute:s.Kd});q.j.Filter=k});KISSY.Editor.add("htmlparser-text",function(){function k(C){this.value=C;this.c={S:I}}var y=KISSY,p=y.Editor,I=Y;y.augment(k,{type:p.n.f,ba:function(C,A){var s=this.value;A&&!(s=A.ma(s,this))||C.text(s)}});p.j.Mb=k;p.j.Text=k});
KISSY.Editor.add("htmlparser-comment",function(){function k(I){this.value=I;this.c={S:Y}}var y=KISSY.Editor,p=y.n;y.j.ae=k;y.j.Comment=k;k.prototype={constructor:k,type:p.de,ba:function(I,C){var A=this.value;if(C){if(!(A=C.Ra(A,this)))return;if(typeof A!="string"){A.parent=this.parent;A.ba(I,C);return}}I.N(A)}}});
KISSY.Editor.add("button",function(){var k=KISSY,y=k.Editor;if(y.ke)k.log("TripleButton attach twice","warn");else{k=k.UIBase.create([k.UIBase.Box],{Eg:function(){var p=this,I=p.get("el");I.on("click",p.ue,p);I.on("mousedown",function(){p.get("state")=="off"&&I.addClass("ke-triplebutton-active")});I.on("mouseup mouseleave",function(){p.get("state")=="off"&&I.hasClass("ke-triplebutton-active")&&setTimeout(function(){I.removeClass("ke-triplebutton-active")},300)})},yg:function(){this.get("el").attr("title",
this.get("title"))},vg:function(p){var I=this.get("el");if(p!==undefined){I.html("<span class='ke-toolbar-item "+p+"'>");I.ta()}},xg:function(p){var I=this.get("el");p!==undefined&&I.html(p)},wg:function(p){this["_"+p]()},od:function(){this.Ce=this.get("state");this.set("state","disabled")},qd:function(){this.get("state")=="disabled"&&this.set("state",this.Ce)},ue:function(p){this.fire(this.get("state")+"Click",{ng:p});this.fire("click",{mg:this.get("state")+"Click"});p&&p.halt()},Gg:function(){this.set("state",
"on")},Fg:function(){this.set("state","off")},tg:function(){var p=this.get("el");p.removeClass("ke-triplebutton-off ke-triplebutton-disabled");p.addClass("ke-triplebutton-on")},sg:function(){var p=this.get("el");p.removeClass("ke-triplebutton-on ke-triplebutton-disabled");p.addClass("ke-triplebutton-off")},pg:function(){var p=this.get("el");p.removeClass("ke-triplebutton-off ke-triplebutton-on");p.addClass("ke-triplebutton-disabled")}},{$d:{If:{value:"off"},df:{value:"ke-triplebutton ke-triplebutton-off"},
Qg:{value:{hideFocus:T,tabIndex:-1}},Rg:{value:"a"},title:{},Hg:{},text:{}}});k.fg="on";k.dg="off";k.be="disabled";k.gg="ke-triplebutton-on";k.eg="ke-triplebutton-off";k.Wf="ke-triplebutton-disabled";y.ke=k}});
KISSY.Editor.add("select",function(){function k(e){k.superclass.constructor.call(this,e);this.xe()}var y=KISSY,p=y.Node,I=y.Event,C=y.DOM,A=y.Editor;if(A.je)y.log("ke select attach more");else{k.be=0;k.Xf=1;var s=A.m;k.$d={gh:{},P:{},Ve:{},xa:{},Og:{},value:{},width:{},title:{},uf:{},Tg:{},align:{value:["l","b"]},Zg:{lh:function(){for(var e=this.P.parent();e;){var f=e.d();if(s[f]&&s[f].div)return e;e=e.parent()}return new p(document.body)}},If:{value:1}};k.Lg=function(e){for(var f=e.width(),d=[],
i=e.all("option"),u=0;u<i.length;u++){var j=i[u];d.push({name:C.html(j),value:C.attr(j,"value")})}return new k({width:f+"px",P:e,uf:d,Ve:"ke-combox",value:e.val()})};var q=A.k.Je,m=A.k.Ze;y.extend(k,y.Base,{xe:function(){var e=this.get("container"),f=this.get("el"),d=new p("<span class='ke-select-wrap'><a onclick='return false;' class='ke-select'><span class='ke-select-text'><span class='ke-select-text-inner'></span></span><span class='ke-select-drop-wrap'><span class='ke-select-drop'></span></span></a></span>"),
i=this.get("title")||"",u=this.get("cls"),j=d.one(".ke-select-text"),a=d.one(".ke-select-text-inner");d.one(".ke-select-drop");this.get("value")!==undefined?a.html(this.Xc(this.get("value"))):a.html(i);j.css("width",this.get("width"));d.ta();i&&d.attr("title",i);u&&d.addClass(u);if(f)f[0].parentNode.replaceChild(d[0],f[0]);else e&&d.appendTo(e);d.on("click",this.we,this);this.P=d;this.title=a;this.Yc=d.one("a.ke-select");A.k.Hd(this,"_prepare","_real");this.on("afterValueChange",this.Fe,this);this.on("afterStateChange",
this.Ee,this)},Xc:function(e){var f=this.get("title")||"",d=this.get("items");if(this.get("showValue"))return e||f;for(var i=0;i<d.length;i++){var u=d[i];if(u.value==e){f=u.name;break}}return f},Fe:function(e){this.title.html(this.Xc(e.tb))},Zc:function(e){var f;f=e.tb;e=this.bd;e.html("");if(f&&f.length)for(var d=0;d<f.length;d++){var i=f[d];(new p("<a class='ke-select-menu-item' href='#' data-value='"+i.value+"'>"+i.name+"</a>",i.Ne)).appendTo(e).ta()}else if(f=this.get("emptyText"))(new p("<a class='ke-select-menu-item' href='#'>"+
f+"</a>")).appendTo(e).ta();this.Yb=e.all("a")},val:function(e){if(e!==undefined){this.set("value",e);return this}else return this.get("value")},ad:function(){this.T.get("visible")&&this.Be()},ye:function(){function e(b){b=new p(b.target);d.contains(b)||d.g(b)||j.hide()}var f=this,d=f.P,i=f.get("popUpWidth"),u=f.Yc,j=new A.ee({Cg:T,fh:f.get("menuContainer"),content:"<div>",Ug:Y,df:"ke-menu",width:i?i:d.width(),zIndex:A.$b(A.Dc.ge),Vg:Y}),a=f.get("items");q.call(f,j);i=j.get("contentEl").one("div");
f.T=j;I.on(window,"resize",f.ad,f);q.call(f,function(){I.remove(window,"resize",f.ad,f)});f.get("title")&&(new p("<div class='ke-menu-title ke-select-menu-item' style='margin-top:-6px;' >"+f.get("title")+"</div>")).appendTo(i);f.bd=(new p("<div>")).appendTo(i);f.Zc({tb:a});j.on("show",function(){u.addClass("ke-select-active")});j.on("hide",function(){u.removeClass("ke-select-active")});I.on(document,"click",e);q.call(f,function(){I.remove(document,"click",e)});f.get("doc")&&I.on(f.get("doc"),"click",
e);i.on("click",f.De,f);f.Yb=f.bd.all("a");I.on(i[0],"mouseenter",function(){f.Yb.removeClass("ke-menu-selected")});q.call(f,i);f.on("afterItemsChange",f.Zc,f);f.yf=i},Ee:function(e){var f=this.P;e.tb==1?f.removeClass("ke-select-disabled"):f.addClass("ke-select-disabled")},qd:function(){this.set("state",1)},od:function(){this.set("state",0)},De:function(e){e&&e.halt();var f=this.T,d=this.yf;if((e=(new p(e.target)).Oc(function(j){return d.contains(j)&&j.d()=="a"},T))&&e.Rb("data-value")){var i=this.get("value"),
u=e.attr("data-value");this.set("value",u);this.fire("click",{tb:u,ah:i,name:e.html()});f.hide()}},Be:function(){var e=this.P,f=e.offset(),d=y.clone(f),i=this.T.get("el").height(),u=this.T.get("el").width(),j=C.scrollTop(),a=C.scrollLeft(),b=C.viewportHeight(),g=C.viewportWidth();g=a+g-60;b=j+b;var o=f.top+(e.height()-2);e=f.left+e.width()-2;var z=this.get("align"),B=z[0];if(z[1]=="b"){f.top=o;if(f.top+i>b&&d.top-j>b-o)f.top=d.top-i}else{f.top=d.top-i;if(f.top<j&&d.top-j<b-o)f.top=o}if(B=="l"){if(f.left+
u>g&&e-a>g-d.left)f.left=e-u}else{f.left=e-u;if(f.left<a&&e-a<g-d.left)f.left=d.left}this.T.set("xy",[f.left,f.top]);this.T.show()},we:function(e){if(!this.sc){e&&e.halt();var f=this;e=f.P;var d=f.get("value");if(!e.hasClass("ke-select-disabled"))if(f.Yc.hasClass("ke-select-active"))f.T&&f.T.hide();else{f.sc=T;A.use("overlay",function(){f.sc=Y;f.ye();d&&f.T&&f.Yb.each(function(i){i.attr("data-value")==d?i.addClass("ke-menu-selected"):i.removeClass("ke-menu-selected")})})}}},za:function(){m.call(this);
this.P.detach();this.P.remove()}});A.je=k}});
