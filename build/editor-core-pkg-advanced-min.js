/*
 Constructor for kissy editor,dependency moved to independent module
 thanks to CKSource's intelligent work on CKEditor
 @author: yiminghe@gmail.com, lifesinger@gmail.com
 @version: 2.1.5
 @buildtime: 2011-01-12 23:00:39
*/
var S=true,T=null,X=false;
KISSY.add("editor",function(k){function y(s,q){var m=this;if(!(m instanceof y))return new y(s,q);if(k.isString(s))s=k.one(s);s=H.C(s);q=q||{};q.Af=q.pluginConfig||{};m.va=q;q.pluginConfig=q.Af;m.cfg=q;k.app(m,k.EventTarget);var e=["htmldataprocessor","enterkey","clipboard"],f=A;m.use=function(d,i){d=d.split(",");if(!f)for(var t=0;t<e.length;t++){var j=e[t];k.inArray(j,d)||d.unshift(j)}m.ready(function(){k.use.call(m,d.join(","),function(){for(var a=0;a<d.length;a++)m.Xd(d[a]);i&&i.call(m);if(!f){m.setData(s.val());
if(q.focus)m.focus();else(a=m.getSelection())&&a.removeAllRanges();f=C}},{global:y})});return m};m.use=m.use;m.Config.base=y.Config.base;m.Config.debug=y.Config.debug;m.Config.componentJsName=p;m.qf(s);return m}function p(){return"plugin-min.js?t=2011-01-12 23:00:39"}var H=k.DOM,C=S,A=X;k.app(y,k.EventTarget);y.Config.base=k.Config.base+"editor/plugins/";y.Config.debug=k.Config.debug;y.Config.componentJsName=p;k.Editor=y;k.Editor=y});
KISSY.Editor.add("utils",function(k){var y=T,p=KISSY,H=p.Node,C=p.DOM,A=p.UA,s=p.Event,q;if(A.ie)q=document.documentMode||A.ie;var m={md:function(e){e=e.replace(/-min\.(js|css)/i,".$1");k.Config.Jg||(e=e.replace(/\.(js|css)/i,"-min.$1"));if(e.indexOf("?t")==-1){e+=e.indexOf("?")!=-1?"&":"?";e+="t=2011-01-12 19:32:53"}return k.Config.Cg+e},Gd:function(e,f,d){var i=e[f],t=e[d];e[f]=function(){i.apply(this,arguments);e[f]=e[d];return t.apply(this,arguments)}},mf:function(e,f,d,i){d=d.defaultView||d.parentWindow;
e-=C.scrollLeft(d);f-=C.scrollTop(d);if(i)if(d!=(i.defaultView||i.parentWindow)&&d.frameElement){i=C.Qb(d.frameElement,i);e+=i.left;f+=i.top}return{left:e,top:f}},Wd:function(){for(var e,f=0,d=arguments.length;f<d;f++){var i=arguments[f];try{e=i();break}catch(t){}}return e},Me:function(e,f){if(!e&&!f)return S;if(!e||!f||e.length!=f.length)return X;for(var d=0;d<e.length;d++)if(e[d]!==f[d])return X;return S},ud:function(e,f,d){e=e.documentElement;for(var i=0;e&&i<f.length;i++){var t=f[i];if(d)for(var j=
-1,a=0;a<e.childNodes.length;a++){var b=e.childNodes[a];if(!(d===S&&b.nodeType==3&&b.previousSibling&&b.previousSibling.nodeType==3)){j++;if(j==t){e=b;break}}}else e=e.childNodes[t]}return e?new H(e):y},Ue:function(e){for(var f in e)e[f].Pc(e,S)},pc:function(e){return e.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/,"&gt;")},Qa:function(e){return e.replace(/^\s+/,"")},Sa:function(e){return e.replace(/\s+$/,"")},trim:function(e){return this.Qa(this.Sa(e))},mix:function(){for(var e={},f=0;f<
arguments.length;f++)e=p.mix(e,arguments[f]);return e},qb:function(){if(!A.ie)return X;var e=document.domain,f=window.location.hostname;return e!=f&&e!="["+f+"]"},af:function(e,f){return Array(f+1).join(e)},Kf:function(e,f,d){d=d||150;if(d===-1)return function(){e.apply(f,arguments)};var i=(new Date).getTime();return function(){var t=(new Date).getTime();if(t-i>d){i=t;e.apply(f,arguments)}}},Qe:function(e,f,d){d=d||0;var i=y;return function(){i&&clearTimeout(i);var t=arguments;i=setTimeout(function(){return e.apply(f,
t)},d)}},isNumber:function(e){return/^\d+(.\d+)?$/.test(p.trim(e))},Mf:function(e){for(var f=0;f<e.length;f++){var d=C.C(e[f]),i=p.trim(d.val()),t=d.attr("data-verify");d=d.attr("data-warning");if(t&&!RegExp(t).test(i)){alert(d);return X}}return S},Hf:function(e,f){e.on("sourcemode",f.nd,f);e.on("wysiwygmode",f.pd,f)},Df:function(e){var f=e.attr("placeholder");if(f&&!A.webkit){e.addClass("ke-input-tip");e.val(f)}else A.webkit&&e.val("")},kh:function(e,f){e.removeClass("ke-input-tip");e.val(f)},zf:function(e,
f){e.attr("placeholder",f);if(!A.webkit){e.on("blur",function(){if(!p.trim(e.val())){e.addClass("ke-input-tip");e.val(f)}});e.on("focus",function(){e.removeClass("ke-input-tip");p.trim(e.val())==f&&e.val("")})}},Te:function(e){e=e[0]||e;for(var f=p.makeArray(e.childNodes),d=0;d<f.length;d++){var i=f[d];i.nodeType==k.n.f&&!p.trim(i.nodeValue)&&e.removeChild(i)}},pf:function(e){return!e?e:String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},of:function(e){return!e?
e:String(e).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},ef:function(e,f){return e.toLowerCase()==f.toLowerCase()},Hd:function(e){e=p.clone(e);for(var f in e)if(e.hasOwnProperty(f)){var d=e[f];if(p.isFunction(d))e[f]=d()}return e},$e:function(e,f,d){function i(){var z={responseText:"",responseXML:y};z.Le=e?e.Le:y;try{var B;if((B=A.ie?j.contentWindow.document:j.contentDocument||window.frames[t].document)&&B.body)z.responseText=B.body.innerHTML;z.responseXML=
B&&B.XMLDocument?B.XMLDocument:B}catch(r){p.log(r)}s.remove(j,"load",i);e.Re&&e.Re(z);setTimeout(function(){C.h(j)},100)}var t=p.guid("form-upload-"),j=document.createElement("iframe");j.id=t;j.name=t;j.className="ke-hidden";var a="document.open();"+(m.qb()?'document.domain="'+document.domain+'";':"")+"document.close();";if(A.ie)j.src=A.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";p.log("doFormUpload : "+j.src);document.body.appendChild(j);if(A.ie)document.frames[t].name=t;a=C.Vc(e.form);
var b={target:a.target,method:a.method,encoding:a.encoding,enctype:a.enctype,action:a.action};a.target=t;a.method="POST";a.enctype=a.encoding="multipart/form-data";if(d)a.action=d;var g;if(f){g=[];f=k.k.Hd(f);for(var o in f)if(f.hasOwnProperty(o)){d=document.createElement("input");d.type="hidden";d.name=o;d.value=f[o];a.appendChild(d);g.push(d)}}s.on(j,"load",i);a.submit();a.target=b.target;a.method=b.method;a.enctype=b.enctype;a.encoding=b.encoding;a.action=b.action;if(g){f=0;for(o=g.length;f<o;f++)C.h(g[f])}return j},
o:function(e,f){for(var d in f)e[d]=f[d]},map:function(e,f){for(var d=0;d<e.length;d++)e[d]=f(e[d]);return e},Ba:q,Bf:function(e){A.ie?e.ta():e.attr("onmousedown","return false;")},Vg:function(e){e=e.attributes;return e.type=="application/x-shockwave-flash"||/\.swf(?:$|\?)/i.test(e.src||"")},Je:function(){var e=this.ib=this.ib||[];e.push.apply(e,p.makeArray(arguments))},Ze:function(){for(var e=this.ib||[],f=0;f<e.length;f++){var d=e[f];if(p.isFunction(d))d();else{d.detach&&d.detach();d.za&&d.za();
d.nodeType&&d.remove&&d.remove()}}this.ib=[]}};k.k=m;k.Utils=m;A.Ba=m.Ba;m.o(m,{debugUrl:m.md,lazyRun:m.Gd,getXY:m.mf,tryThese:m.Wd,arrayCompare:m.Me,getByAddress:m.ud,clearAllMarkers:m.Ue,htmlEncodeAttr:m.pc,ltrim:m.Qa,rtrim:m.Sa,trim:m.trim,mix:m.mix,isCustomDomain:m.qb,duplicateStr:m.af,buffer:m.Qe,isNumber:m.isNumber,verifyInputs:m.Mf,sourceDisable:m.Hf,resetInput:m.Df,placeholder:m.zf,clean:m.Te,htmlEncode:m.pf,htmlDecode:m.of,equalsIgnoreCase:m.ef,normParams:m.Hd,throttle:m.Kf,doFormUpload:m.$e,
map:m.map})});
KISSY.Editor.add("dom",function(k){function y(a){if(a&&!a[0])return new q(a);return a}function p(a){return a[0]||a}function H(a){return a.replace(/-(\w)/g,function(b,g){return g.toUpperCase()})}var C=KISSY,A=C.DOM,s=C.UA,q=C.Node,m=k.k,e={abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1};k.n={e:1,f:3,ce:8,bg:11};k.NODE=k.n;k.$a={ea:0,ee:1,da:2,$:4,Z:8,Kc:16};k.POSITION=
k.$a;var f=k.n,d=k.$a,i={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},t={hr:1},j={C:y,Vc:p,g:function(a,b){if(!a&&!b)return S;if(!a||!b)return X;a=p(a);b=p(b);return a===b},qa:function(a,b){a=y(a);var g=C.mix(C.mix({},t),b||{});return i[a.css("display")]||g[a.d()]},ga:function(a){return a&&"scrollTo"in a&&a.document?a:a&&a.nodeType===9?a.defaultView||a.parentWindow:
X},t:function(a){a=p(a);for(var b=a.parentNode.childNodes,g=0;g<b.length;g++)if(b[g]===a)return g;return-1},le:function(a,b){a=p(a);var g=a.firstChild;if((g=g&&new q(g))&&b&&!b(g))g=g.Ka(b);return g},Tc:function(a,b,g){a=p(a);A.h(a);b=p(b);g?b.insertBefore(a,b.firstChild):b.appendChild(a)},d:function(a){a=p(a);var b=a.nodeName.toLowerCase();if(s.ie)if((a=a.scopeName)&&a!="HTML")b=a.toLowerCase()+":"+b;return b},Rc:function(a,b){if(a.d()!=b.d())return X;var g=a[0].attributes,o=b[0].attributes,z=g.length,
B=o.length;if(z!=B)return X;for(var r=0;r<z;r++){var w=g[r],x=w.name;if(w.specified&&a.attr(x)!=b.attr(x))return X}if(m.Ba<8)for(r=0;r<B;r++){w=o[r];x=w.name;if(w.specified&&a.attr(x)!=b.attr(x))return X}return S},Sb:function(a){a=p(a).childNodes;for(var b=0,g=a.length;b<g;b++){var o=a[b],z=o.nodeType;if(!(z==f.e&&o.getAttribute("_ke_bookmark")))if(z==f.e&&!j.Sb(o)||z==f.f&&C.trim(o.nodeValue))return X}return S},Tb:function(a,b,g){a=p(a);b=b[0]||b;if(a!=b)if(g)for(;g=a.lastChild;)b.insertBefore(a.removeChild(g),
b.firstChild);else for(;g=a.firstChild;)b.appendChild(a.removeChild(g))},ra:function(){function a(b,g,o){if(g[0]&&g[0].nodeType==f.e){for(var z=[];g.attr("_ke_bookmark")||g.Sb();){z.push(g);g=o?new q(g[0].nextSibling):new q(g[0].previousSibling);if(!g[0]||g[0].nodeType!=f.e)return}if(b.Rc(g)){for(var B=o?b[0].lastChild:b[0].firstChild;z.length;)z.shift().Tc(b,!o);g.Tb(b,!o);g.h();B[0]&&B[0].nodeType==f.e&&B.ra()}}}return function(b){if(b[0])if(e[b.d()]||b.d()=="a"){a(b,new q(b[0].nextSibling),S);
a(b,new q(b[0].previousSibling))}}}(),ta:s.gecko?function(a){a=p(a);a.style.MozUserSelect="none"}:s.webkit?function(a){a=p(a);a.style.Zf="none"}:function(a){a=p(a);if(s.ie||s.opera){var b=0;a.setAttribute("unselectable","on");for(var g=a.getElementsByTagName("*");a=g[b++];)switch(a.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:a.setAttribute("unselectable","on")}}},Qb:function(a,b){a=p(a);var g,o=0;g=0;var z=a.ownerDocument.defaultView||a.ownerDocument.parentWindow,
B=a.ownerDocument,r=B.documentElement;b=b||B;if(a.getBoundingClientRect){if(a!==B.body&&r!==a){g=a.getBoundingClientRect();o=g.left+(b===B?A.scrollLeft(z):0);g=g.top+(b===B?A.scrollTop(z):0)}if(b)if(z!=(b.defaultView||b.parentWindow)&&z.frameElement){z=j.Qb(z.frameElement,b);o+=z.left;g+=z.top}}return{left:o,top:g}},ne:function(a){return(a=p(a))&&a.contentWindow.document},ia:function(a,b){a=p(a);var g=a.ownerDocument;if(!(!a||a.nodeType!=f.f)){if(s.ie&&b==a.nodeValue.length){var o=g.createTextNode("");
A.insertAfter(o,a);return new q(o)}o=new q(a.splitText(b));if(g.documentMode){g=g.createTextNode("");A.insertAfter(g,o[0]);A.h(g)}return o}},Ub:function(a,b){a=y(a);var g=[];do g[b?"push":"unshift"](a);while(a=a.parent());return g},K:function(a,b,g){a=p(a);a=a.cloneNode(b);if(!g){var o=function(z){if(z.nodeType==f.e){z.removeAttribute("id");z=z.childNodes;for(var B=0;B<z.length;B++)o(z[B])}};o(a)}return new q(a)},v:function(a,b,g,o){a=p(a);if(o&&!o.call){var z=o[0]||o;o=function(r){r=r[0]||r;return r!==
z}}b=!b&&a.firstChild;var B=new q(a);if(!b){if(a.nodeType==f.e&&o&&o(a,S)===X)return T;b=a.nextSibling}for(;!b&&(B=B.parent());){if(o&&o(B,S)===X)return T;b=B[0].nextSibling}if(!b)return T;b=A.C(b);if(o&&o(b)===X)return T;if(g&&g!=b[0].nodeType)return b.v(X,g,o);return b},ha:function(a,b,g,o){a=p(a);if(o&&!o.call){var z=o[0]||o;o=function(r){r=r[0]||r;return r!==z}}b=!b&&a.lastChild;var B=new q(a);if(!b){if(a.nodeType==f.e&&o&&o(a,S)===X)return T;b=a.previousSibling}for(;!b&&(B=B.parent());){if(o&&
o(B,S)===X)return T;b=B[0].previousSibling}if(!b)return T;b=A.C(b);if(o&&o(b)===X)return T;if(g&&b[0].nodeType!=g)return b.ha(X,g,o);return b},Pb:function(a,b){if(a.g(b))return a;if(b[0].nodeType!=f.f&&b.contains(a))return b;var g=a[0].nodeType==f.f?a.parent():a;do if(g[0].nodeType!=f.f&&g.contains(b))return g;while(g=g.parent());return T},Oc:function(a,b,g){a=p(a);if(!g)a=a.parentNode;if(b&&!C.isFunction(b)){var o=b;b=function(z){return z.d()==o}}for(;a&&a.nodeType!=9;){if(!b||b(new q(a))===S)return new q(a);
a=a.parentNode}return T},Rb:m.Ba<9?function(a,b){a=p(a);var g=a.attributes[b];return!!(g&&g.specified)}:function(a,b){a=p(a);return a.hasAttribute(b)},eb:m.Ba<9?function(a){a=p(a);for(var b=a.attributes,g=0;g<b.length;g++){var o=b[g];switch(o.name){case "class":if(a.getAttribute("class"))return S;break;default:if(o.specified)return S}}return X}:function(a){a=p(a);s.gecko&&a.removeAttribute("_moz_dirty");return a.hasAttributes()},La:function(a,b){var g=p(a),o=p(b);if(g.compareDocumentPosition)return g.compareDocumentPosition(o);
if(g==o)return d.ea;if(g.nodeType==f.e&&o.nodeType==f.e){if(g.contains){if(g.contains(o))return d.Kc+d.$;if(o.contains(g))return d.Z+d.da}if("sourceIndex"in g)return g.sourceIndex<0||o.sourceIndex<0?d.ee:g.sourceIndex<o.sourceIndex?d.$:d.da}g=a.Ja();o=b.Ja();for(var z=Math.min(g.length,o.length),B=0;B<=z-1;B++)if(g[B]!=o[B]){if(B<z)return g[B]<o[B]?d.$:d.da;break}return g.length<o.length?d.Kc+d.$:d.Z+d.da},Ja:function(a,b){a=p(a);for(var g=[],o=a.ownerDocument.documentElement,z=a;z&&z!=o;){var B=
z.parentNode,r=-1;if(B){for(var w=0;w<B.childNodes.length;w++){var x=B.childNodes[w];if(!(b&&x.nodeType==3&&x.previousSibling&&x.previousSibling.nodeType==3)){r++;if(x==z)break}}g.unshift(r)}z=B}return g},Ob:function(a,b){var g=new k.Range(a[0].ownerDocument);g.setStartAfter(a);g.setEndAfter(b);var o=g.extractContents();g.insertNode(a.h());a[0].parentNode.insertBefore(o,a[0].nextSibling)},L:function(a,b,g){a=y(a);if(g!==undefined)return a.css(b,g);a=p(a);return a.style[H(b)]},h:function(a,b){var g=
p(a),o=g.parentNode;if(o){if(b)for(var z;z=g.firstChild;)o.insertBefore(g.removeChild(z),g);o.removeChild(g)}return a},gb:function(a){A.Sc(a);A.Uc(a)},Sc:function(a){a=p(a);for(var b;b=a.firstChild;){if(b.nodeType==f.f){var g=m.Qa(b.nodeValue),o=b.nodeValue.length;if(g){if(g.length<o){(new q(b)).ia(o-g.length);a.removeChild(a.firstChild)}}else{a.removeChild(b);continue}}break}},Uc:function(a){a=p(a);for(var b;b=a.lastChild;){if(b.type==f.f){var g=m.Sa(b.nodeValue),o=b.nodeValue.length;if(g){if(g.length<
o){(new q(b)).ia(g.length);a.removeChild(a.lastChild)}}else{a.removeChild(b);continue}}break}if(!s.ie&&!s.opera)(b=a.lastChild)&&b.nodeType==1&&b.nodeName.toLowerCase()=="br"&&b.parentNode.removeChild(b)},Nb:function(a){a=p(a);for(var b=a.lastChild;b&&b.nodeType==f.f&&!C.trim(b.nodeValue);)b=b.previousSibling;if(!b||b.nodeType==f.f||A.d(b)!=="br"){b=s.opera?a.ownerDocument.createTextNode(""):a.ownerDocument.createElement("br");s.gecko&&b.setAttribute("type","_moz");a.appendChild(b)}},sa:function(a,
b){var g=p(a),o;do o=(g=g.previousSibling)&&new q(g);while(o&&b&&!b(o));return o},pe:function(a,b){a=A.C(a);var g=a[0].lastChild;if((g=g&&new q(g))&&b&&!b(g))g=g.sa(b);return g},Ka:function(a,b){var g=p(a),o;do o=(g=g.nextSibling)&&new q(g);while(o&&b&&!b(o));return o},fb:function(a){a=p(a);if(a.outerHTML)return a.outerHTML.replace(/<\?[^>]*>/,"");var b=a.ownerDocument.createElement("div");b.appendChild(a.cloneNode(S));return b.innerHTML},qe:function(a,b,g,o){a=A.C(a);var z=a.data("list_marker_id")||
a.data("list_marker_id",C.guid()).data("list_marker_id"),B=a.data("list_marker_names")||a.data("list_marker_names",{}).data("list_marker_names");b[z]=a;B[g]=1;return a.data(g,o)},Pc:function(a,b,g){a=y(a);var o=a.data("list_marker_names"),z=a.data("list_marker_id"),B;for(B in o)a.removeData(B);a.removeData("list_marker_names");if(g){a.removeData("list_marker_id");delete b[z]}},ke:function(a,b,g){a=p(a);b=y(b);var o=a.attributes;g=g||{};for(var z=0;z<o.length;z++){var B=o[z],r=B.name.toLowerCase(),
w;if(!(r in g))if(r=="checked"&&(w=A.attr(a,r)))b.attr(r,w);else if(B.specified||s.ie&&B.value&&r=="value"){w=A.attr(a,r);if(w===T)w=B.nodeValue;b.attr(r,w)}}if(a.style.cssText!=="")b[0].style.cssText=a.style.cssText},Qc:function(a){a=A.d(a);var b=k.m;return(a=!b.Hc[a]&&(b[a]||b.span))&&a["#"]},Vb:function(a){a=y(a);var b=a[0].ownerDocument,g=A.scrollLeft(b),o=A.scrollTop(b),z=a.offset(),B=z.left;z=z.top;if(A.viewportHeight(b)+o<z||z<o||A.viewportWidth(b)+g<B||B<g)a.scrollIntoView(b)},me:function(a,
b,g){a=p(a);if(!s.ie&&g)b=g+":"+b;g=[];a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)g.push(new q(a[b]));return g}};C.DOM.oe=function(a){C.mix(A,a);for(var b in a)a.hasOwnProperty(b)&&function(g){q.prototype[g]=function(){var o=[].slice.call(arguments,0);o.unshift(this);return a[g].apply(T,o)}}(b)};m.o(j,{_4e_wrap:j.C,_4e_unwrap:j.Vc,_4e_equals:j.g,_4e_isBlockBoundary:j.qa,_4e_getWin:j.ga,_4e_index:j.t,_4e_first:j.le,_4e_move:j.Tc,_4e_name:j.d,_4e_isIdentical:j.Rc,_4e_isEmptyInlineRemoveable:j.Sb,
_4e_moveChildren:j.Tb,_4e_mergeSiblings:j.ra,_4e_unselectable:j.ta,_4e_getOffset:j.Qb,_4e_getFrameDocument:j.ne,_4e_splitText:j.ia,_4e_parents:j.Ub,_4e_clone:j.K,_4e_nextSourceNode:j.v,_4e_previousSourceNode:j.ha,_4e_commonAncestor:j.Pb,_4e_ascendant:j.Oc,_4e_hasAttribute:j.Rb,_4e_hasAttributes:j.eb,_4e_position:j.La,_4e_address:j.Ja,_4e_breakParent:j.Ob,_4e_style:j.L,_4e_remove:j.h,_4e_trim:j.gb,_4e_ltrim:j.Sc,_4e_rtrim:j.Uc,_4e_appendBogus:j.Nb,_4e_last:j.pe,_4e_previous:j.sa,_4e_next:j.Ka,_4e_outerHtml:j.fb,
_4e_setMarker:j.qe,_4e_clearMarkers:j.Pc,_4e_getUniqueId:j.ng,_4e_copyAttributes:j.ke,_4e_isEditable:j.Qc,_4e_scrollIntoView:j.Vb,_4e_getElementsByTagName:j.me});A.oe(j)});
KISSY.Editor.add("focusmanager",function(k){function y(){this.qc=m;q=this}function p(){this.qc=e;q=f}var H=KISSY,C=H.DOM,A=H.Event,s={},q;H={bh:function(){for(var d in s){var i=s[d];i.document.designMode="off";i.document.designMode="on"}},Hg:function(){return q},hf:function(d){return s[d]},add:function(d){var i=C.ga(d.document);A.on(i,"focus",y,d);A.on(i,"blur",p,d)},Cf:function(d){s[d.Wb]=d},remove:function(d){delete s[d.Wb];var i=C.ga(d.document);A.remove(i,"focus",y,d);A.remove(i,"blur",p,d)}};
var m=S,e=X,f=T;k.rd=H;k.focusManager=H;k.jf=function(){return s};k.getInstances=k.jf});
KISSY.Editor.add("definition",function(k){var y=S,p=X,H=k.k,C=document,A=KISSY,s=A.UA,q=A.DOM,m=A.Node,e=A.Event,f=k.rd,d=H.Wd,i=1,t="document.open();"+(H.qb()?'document.domain="'+C.domain+'";':"")+"document.close();",j="<div  class='ke-editor-wrap'  > <div class='"+".ke-editor-tools".substring(1)+"' ></div><div class='"+".ke-textarea-wrap".substring(1)+'\'><iframe  style="width:100%;height:100%;border:none;"  width="100%"  height="100%"  frameborder="0"  title="kissy-editor"  src="'+(s.ie?"javascript:void(function(){"+
encodeURIComponent(t)+"}())":"")+'"  tabIndex="'+(s.webkit?-1:"$(tabIndex)")+'"  allowTransparency="true" ></iframe></div><div class=\''+".ke-editor-status".substring(1)+"'></div></div>";k.Mc=0;k.db=1;k.SOURCE_MODE=k.Mc;k.WYSIWYG_MODE=k.db;A.augment(k,{qf:function(a){var b=this;b.hb={};b.Ma={};b.ua={};s.ie&&q.addClass(C.body,"ke-ie"+s.ie);if(s.trident)q.addClass(C.body,"ke-trident"+s.trident);else if(s.gecko)q.addClass(C.body,"ke-gecko");else s.webkit&&q.addClass(C.body,"ke-webkit");var g=new m(j.replace(/\$\(tabIndex\)/,
a.attr("tabIndex")));b.cf=g;b.Wb=i++;f.Cf(b);b.Wa=g.one(".ke-textarea-wrap");b.wrap=b.Wa;b.Ca=b.Wa.one("iframe");b.iframe=b.Ca;b.Vd=g.one(".ke-editor-tools");b.toolBarDiv=b.Vd;b.W=a;b.textarea=b.W;b.Jf=g.one(".ke-editor-status");b.statusDiv=b.Jf;H.Bf(b.Vd);var o=a.L("width"),z=a.L("height");if(o){g.css("width",o);a.css("width","100%")}b.W.css("display","none");g.insertAfter(a);b.Wa[0].appendChild(a[0]);if(z){b.Wa.css("height",z);a.css("height","100%")}g=b.Ca;b.on("dataReady",function(){b.Ae=y;k.fire("instanceCreated",
{bf:b})});s.gecko?g.on("load",b.bd,b):b.bd();b.va.attachForm&&a[0].form&&b.ve()},za:function(){if(!this.te){var a=this.cf,b=this.W,g=this.document,o=this.Ca[0].contentWindow;this.Bb();k.rd.remove(this);e.remove(g);e.remove(g.documentElement);e.remove(g.body);e.remove(o);this.Ca.detach();g=this.ua;for(var z in g)if(g.hasOwnProperty(z)){o=g[z];o.za&&o.za()}this.fire("destroy");b.insertBefore(a);a.remove();b.css({width:a.css("width"),height:this.Wa.css("height")});b.show();this.hb=this.Ma=this.ua=T;
this.detach();this.te=S}},ve:function(){var a=this,b=new m(a.W[0].form);b.on("submit",a.Bb,a);a.on("destroy",function(){b.detach("submit",a.Bb,a)})},Lf:function(a,b){var g=this,o=k.de;o&&o.sc();g.use(a,function(){var z=g.vd(a);if(z){b(z);o&&o.jh()}else A.later(arguments.callee,50,X,g)})},Ie:function(a,b){this.Ma[a]=b},vd:function(a){return this.Ma[a]},Lg:function(a){var b=this.Ma[a];b&&b.za();this.Ma[a]=T},Ge:function(a,b){this.hb[a]=b},nf:function(a){return this.hb[a]},execCommand:function(a){var b=
this.hb[a],g=A.makeArray(arguments);g.shift();g.unshift(this);return b.exec.apply(b,g)},lc:function(){return this.W.css("display")=="none"?k.db:k.Mc},getData:function(a){var b;b=this.lc()==k.db?this.document&&this.document.body?this.document.body.innerHTML:"":this.W.val();if(this.htmlDataProcessor)b=a?this.htmlDataProcessor.toHtml(b,"p"):this.htmlDataProcessor.toServer(b,"p");b=A.trim(b);if(/^<p>((&nbsp;)|\s)*<\/p>$/.test(b))b="";return b},setData:function(a){var b=a;if(this.htmlDataProcessor)b=this.htmlDataProcessor.toDataFormat(a,
"p");this.document.body.innerHTML=b;this.lc()!=k.db&&this.W.val(a)},Bb:function(){this.W.val(this.getData())},pg:function(){return this.document.body.innerHTML},tg:function(a){this.document.body.innerHTML=a},ze:function(a){var b=this.va,g=b.ec;b=b.ya;var o="",z=k.k.md("../theme/editor-iframe.css");if(b)for(var B=0;B<b.length;B++)o+='<link href="'+b[B]+'" rel="stylesheet"/>';return"<!doctype html><html><head><title>${title}</title><link href='"+z+"' rel='stylesheet'/><style>"+(g||"")+"</style>"+o+
"</head><body class='ke-editor'>&nbsp;"+(a?'<script id="ke_actscript" type="text/javascript">'+(H.qb()?'document.domain="'+C.domain+'";':"")+'window.parent.KISSY.Editor._initIFrame("'+a+'");<\/script>':"")+"</body></html>"},getSelection:function(){return k.Nc.getSelection(this.document)},focus:function(){var a=this.document,b=q.ga(a);s.webkit&&b&&b.parent&&b.parent.focus();s.webkit&&b&&b.focus();a&&a.body.focus();this.ub()},blur:function(){q.ga(this.document).blur();this.document&&this.document.body.blur()},
He:function(a){var b=this.va,g=this.document;b.ec=b.ec||"";b.ec+="\n"+a;b=g.createElement("style");g.getElementsByTagName("head")[0].appendChild(b);if(b.styleSheet)b.styleSheet.cssText=a;else b.appendChild(g.createTextNode(a))},zg:function(a){var b=this.va,g=this.document;b.ya=b.ya||[];b.ya.push(a);b=g.createElement("link");b.rel="stylesheet";g.getElementsByTagName("head")[0].appendChild(b);b.href=a},dh:function(a){for(var b=this.va,g=A.makeArray(this.document.getElementsByTagName("link")),o=0;o<
g.length;o++)g[o].href==a&&q.h(g[o]);b.ya=b.ya||[];b=b.ya;a=A.indexOf(a,b);a!=-1&&b.splice(a,1)},bd:function(){function a(){B=z.document;b.document=B;g.detach();B.open("text/html","replace");B.write(o);B.close()}var b=this,g=b.Ca,o=b.ze(b.Wb),z=g[0].contentWindow,B;try{B=z.document}catch(r){g[0].src=g[0].src;if(s.ie<7){setTimeout(a,10);return}}a()},ready:function(a){this.Ae?a():this.on("dataReady",a)},Ag:function(a,b,g){this.ua=this.ua;g=g||{};g.gf=b;this.ua[a]=g},Xd:function(a){var b=this.ua[a];
if(b)if(!(b.status&&!b.duplicate)){a=this.Env.mods[a].requires||[];for(var g=0;g<a.length;g++)this.Xd(a[g]);b.gf.call(b);b.status=1}},jb:function(){var a=this;a.Zc&&clearTimeout(a.Zc);a.Zc=setTimeout(function(){var b=a.getSelection();if(b&&!b.Dd){var g=b.ob(),o=new k.Za(g);if(!a.xc||!a.xc.kd(o)){a.xc=o;a.fire("selectionChange",{selection:b,path:o,element:g})}}},100)},ub:function(){this.xc=T;this.jb()},Cd:function(a,b,g){var o=this;o.focus();setTimeout(function(){var z,B=a.d(),r=k.m,w=k.oa,x=k.n,I=
r.Xa[B],u=o.getSelection(),c=u&&u.H(),h,l,v,n;if(!c||c.length==0){var D=arguments,Q=D.callee;setTimeout(function(){Q.apply(o,D)},30)}else{o.fire("save");for(var P=c.length-1;P>=0;P--){h=c[P];h.deleteContents();z=!P&&a||a.K(y);b&&b(z);if(I)for(;(v=h.Aa(p,y))&&(n=r[v.d()])&&!(n&&n[B]);)if(v.d()in r.span)h.Cc(v);else if(h.wa()&&h.ka()){h.setStartBefore(v);h.collapse(y);v.h()}else h.Bc();h.insertNode(z);l||(l=z)}if(l){B=l.v(y);r=o.document;n=k.m;if(n.Db[z.d()]){B=new m(r.createTextNode(" "));B.insertAfter(l)}else if(B){if(B.d()==
"br"&&n[B.parent().d()].p){n=new m("<p>&nbsp;</p>",T,r);B[0].parentNode.replaceChild(n[0],B[0]);B=n}}else{n=new m("<p>&nbsp;</p>",T,r);n.insertAfter(l);B=n}h.G(l,w.r);B&&B[0].nodeType==x.e&&h.sb(B);u.Ab([h]);o.focus();z&&z.Vb();setTimeout(function(){o.fire("save")},10);g&&g(z)}}},0)},rf:function(a){var b=this;if(b.htmlDataProcessor)a=b.htmlDataProcessor.toDataFormat(a);if(s.webkit){var g=q.create(a,T,b.document);g=g.nodeType==11?A.makeArray(g.childNodes):[g];for(var o=0;o<g.length;o++)b.Cd(new m(g[o]))}else{b.focus();
setTimeout(function(){var z=b.getSelection();z=z&&z.H();if(!z||z.length==0){var B=arguments,r=B.callee;setTimeout(function(){r.apply(b,B)},30)}else{b.fire("save");if(document.selection){z=document.selection;z.type=="Control"&&z.clear();z.createRange().pasteHTML(a)}else b.document.execCommand("inserthtml",p,a);setTimeout(function(){b.fire("save")},10)}},0)}}});k._initIFrame=function(a){function b(u){d(function(){z.designMode="on";setTimeout(function(){z.designMode="off";r.focus();if(!arguments.callee.Ef)arguments.callee.Ef=
y},50)},function(){z.designMode="off";q.attr(r,"contentEditable",p);q.attr(r,"contentEditable",y);!u&&b(1)})}var g=f.hf(a);a=g.W[0];var o=g.Ca[0].contentWindow,z=g.document,B=g.va;q.h(z.getElementById("ke_actscript"));var r=z.body;if(s.ie){r.hideFocus=y;r.disabled=y;r.contentEditable=y;r.removeAttribute("disabled")}else setTimeout(function(){if(s.gecko||s.opera)r.contentEditable=y;else if(s.webkit)r.parentNode.contentEditable=y;else z.designMode="on"},0);if(s.webkit){e.on(z,"click",function(u){var c=
new m(u.target);A.inArray(c.d(),["input","select"])&&u.preventDefault()});e.on(z,"mouseup",function(u){var c=new m(u.target);A.inArray(c.d(),["input","textarea"])&&u.preventDefault()})}if(s.gecko||s.ie||s.opera){var w;w=new m(q.insertAfter((new m('<span tabindex="-1" style="position:absolute; left:-10000" role="presentation"></span>'))[0],a));w.on("focus",function(){g.focus()});g.yg=function(){s.gecko&&g.qc&&w[0].focus()};g.on("destroy",function(){w.detach();w.remove()})}if(z.documentMode||s.gecko||
s.opera){var x=z.documentElement;e.on(x,"mousedown",function(u){if((new m(u.target))[0]==x){s.gecko&&b(p);w[0].focus()}})}e.on(o,"focus",function(){if(s.gecko)b(p);else s.opera&&r.focus();g.ub()});s.gecko&&e.on(g.document,"mousedown",function(){g.qc||b(p)});if(s.ie){e.on(z,"keydown",function(u){if(u.keyCode in{8:1,46:1}){var c=g.getSelection(),h=c.mc();if(h){g.fire("save");var l=c.H()[0].O();h.h();c.Rd([l]);g.fire("save");u.preventDefault()}}});if(z.compatMode=="CSS1Compat"){var I={33:1,34:1};e.on(z,
"keydown",function(u){u.keyCode in I&&setTimeout(function(){g.getSelection().scrollIntoView()},0)})}}setTimeout(function(){s.ie&&setTimeout(function(){if(z){r.runtimeStyle.marginBottom="0px";r.runtimeStyle.marginBottom=""}},1E3)},0);setTimeout(function(){g.fire("dataReady");var u=B.disableObjectResizing,c=B.disableInlineTableEditing;if(u||c)try{z.execCommand("enableObjectResizing",p,!u);z.execCommand("enableInlineTableEditing",p,!c)}catch(h){e.on(r,s.ie?"resizestart":"resize",function(l){var v=new m(l.target);
if(u||v.d()==="table"&&c)l.preventDefault()})}},10);s.webkit&&e.on(z,"mousedown",function(u){u=new m(u.target);A.inArray(u.d(),["img","hr","input","textarea","select"])&&g.getSelection().Ac(u)});s.gecko&&e.on(z,"dragstart",function(u){var c=new m(u.target);c.d()==="img"&&/ke_/.test(c[0].className)&&u.preventDefault()});f.add(g)};document.documentMode>7&&function(){for(var a=A.all("link"),b=0;b<a.length;b++){var g=new m(a[b]),o=g.attr("href");o.indexOf("editor-pkg-min-mhtml.css")!=-1&&g.attr("href",
o.replace(/editor-pkg-min-mhtml\.css/g,"editor-pkg-min-datauri.css"))}}();t=k.prototype;H.o(t,{setData:t.setData,getData:t.getData,insertElement:t.Cd,insertHtml:t.rf,ready:t.ready,addCustomStyle:t.He,addCommand:t.Ge,hasCommand:t.nf,execCommand:t.execCommand,useDialog:t.Lf,addDialog:t.Ie,getDialog:t.vd,getMode:t.lc,sync:t.Bb,getSelection:t.getSelection,focus:t.focus,blur:t.blur,notifySelectionChange:t.ub})});
KISSY.Editor.add("zindex",function(){var k=KISSY.Editor;if(!k.Dc){k.Dc={Sf:1100,hg:1200,Uf:99999,ag:900,gg:9999,LOADING:11E3,$f:12E3,fe:1200};k.$b=function(y){return(k.Tf.$b||1E4)+y};k.baseZIndex=k.$b;k.zIndexManager=k.Dc}});
KISSY.Editor.add("dtd",function(k){k.m=function(){function y(r){for(var w=arguments.length-1;w>0;)KISSY.mix(r,arguments[w--]);return r}var p={isindex:1,fieldset:1},H={input:1,button:1,select:1,textarea:1,label:1},C=y({a:1},H),A=y({iframe:1},C),s={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},q={ins:1,del:1,script:1,style:1},m=y({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,
s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},q),e=y({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},m),f=y({p:1},e);H=y({iframe:1},e,H);e={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,
del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};var d=y({a:1},H),i={tr:1},t={"#":1},j=y({param:1},e),a=y({form:1},p,A,s,f),b={li:1},g={base:1,link:1,meta:1,title:1},o=y(g,{style:1,script:1}),z={head:1,body:1},B={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1};return{Fb:y({html:1},z,g),Xa:B,Qf:{body:1,div:1,td:1,th:1,caption:1,
form:1},Db:d,Ec:y({script:1,style:1},B),Fc:{script:1,style:1},Cb:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},Eb:{dd:1,dt:1,li:1},Yd:{ul:1,ol:1,dl:1},Hc:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},ca:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},Rf:{a:1,area:1,button:1,input:1,object:1,select:1,
textarea:1},Ic:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:z,head:o,style:t,body:a,base:{},link:{},meta:{},title:t,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:a,td:a,br:{},th:a,center:a,kbd:d,button:y(f,s),basefont:{},h5:d,h4:d,samp:d,h6:d,ol:b,h1:d,h3:d,option:t,h2:d,form:y(p,A,s,f),select:{optgroup:1,option:1},font:d,ins:d,menu:b,abbr:d,label:d,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:d,script:t,tfoot:i,cite:d,li:a,input:{},iframe:a,
strong:d,textarea:t,noframes:a,big:d,small:d,span:d,hr:{},dt:d,sub:d,optgroup:{option:1},param:{},bdo:d,"var":d,div:a,object:j,sup:d,dd:a,strike:d,area:{},dir:b,map:y({area:1,form:1,p:1},p,q,s),applet:j,dl:{dt:1,dd:1},del:d,isindex:{},fieldset:y({Wg:1},e),thead:i,ul:b,acronym:d,b:d,a:H,blockquote:a,caption:d,i:d,u:d,tbody:i,s:d,address:y(A,f),tt:d,legend:d,q:d,pre:y(m,C),p:d,em:d,dfn:d}}();k.XHTML_DTD=k.m});
KISSY.Editor.add("elementpath",function(k){function y(e){var f=A,d=A,i=[];for(e=e;e&&e[0];){if(e[0].nodeType==C.e){if(!this.vf)this.vf=e;var t=e.d();if(!d){if(!f&&s[t])f=e;if(q[t]){var j;if(j=!f){if(j=t=="div"){a:{j=e;j=j[0]||j;j=j.childNodes;for(var a=0,b=j.length;a<b;a++){var g=j[a];if(g.nodeType==C.e&&H.Xa[g.nodeName.toLowerCase()]){j=S;break a}}j=X}j=!j}j=j}if(j)f=e;else d=e}}i.push(e);if(t=="body")break}e=e.parent()}this.block=this.w=f;this.blockLimit=this.D=d;this.elements=this.elements=i}var p=
KISSY.DOM,H=k.m,C=k.n,A=T,s={address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,dd:1},q={body:1,div:1,table:1,tbody:1,tr:1,td:1,th:1,caption:1,form:1};y.prototype={kd:function(e){var f=this.elements;e=e&&e.elements;if(!e||f.length!=e.length)return X;for(var d=0;d<f.length;d++)if(!p.g(f[d],e[d]))return X;return S},contains:function(e){for(var f=this.elements,d=0;d<f.length;d++)if(f[d].d()in e)return f[d];return A}};k.ElementPath=k.Za=y;var m=y.prototype;k.k.o(m,{compare:m.kd,
contains:m.contains})});
KISSY.Editor.add("walker",function(k){function y(i,t){if(this.c.end)return s;var j,a=this.Ea,b,g=this.nc,o=this.type,z=i?"_4e_previousSourceNode":"_4e_nextSourceNode";if(!this.c.start){this.c.start=1;a.trim();if(a.collapsed){this.end();return s}}if(!i&&!this.c.yd){var B=a.endContainer,r=new f(B[0].childNodes[a.endOffset]);this.c.yd=function(u,c){return(u=e.C(u))&&u[0]&&(!c||!e.g(B,u))&&(!r[0]||!u.g(r))&&(u[0].nodeType!=m.e||!c||u.d()!="body")}}if(i&&!this.c.zd){var w=a.startContainer,x=a.startOffset>
0&&new f(w[0].childNodes[a.startOffset-1]);this.c.zd=function(u,c){return(u=e.C(u))&&u[0]&&(!c||!u.g(w))&&(!x[0]||!u.g(x))&&(u[0].nodeType!=m.e||!c||u.d()!="body")}}var I=i?this.c.zd:this.c.yd;b=g?function(u,c){if(I(u,c)===A)return A;return g(u,c)}:I;if(this.mb)j=this.mb[z](A,o,b);else if(i){j=a.endContainer;if(a.endOffset>0){j=new f(j[0].childNodes[a.endOffset-1]);if(b(j)===A)j=s}else j=b(j,C)===A?s:j.ha(C,o,b)}else{j=a.startContainer;if((j=new f(j[0].childNodes[a.startOffset]))&&j[0]){if(b(j)===
A)j=s}else j=b(a.startContainer,C)===A?s:a.startContainer.v(C,o,b)}for(;j&&j[0]&&!this.c.end;){this.mb=j;if(!this.R||this.R(j)!==A){if(!t)return j}else if(t&&this.R)return A;j=j[z](A,o,b)}this.end();return this.mb=s}function p(i){for(var t,j=s;t=y.call(this,i);)j=t;return j}function H(i){this.Ea=i;this.c={}}var C=S,A=X,s=T,q=KISSY,m=k.n,e=q.DOM,f=q.Node;q.augment(H,{end:function(){this.c.end=1},next:function(){return y.call(this)},xb:function(){return y.call(this,C)},jd:function(){return y.call(this,
A,C)!==A},hd:function(){return y.call(this,C,C)!==A},Fd:function(){return p.call(this)},Ed:function(){return p.call(this,C)},reset:function(){delete this.mb;this.c={}}});H.ac=function(i){return function(t){t=e.C(t);return!(t&&t[0].nodeType==m.e&&t.qa(i))}};H.xf=function(){return this.ac({bc:1})};H.Na=function(i,t){function j(a){return a&&a[0]&&a.d()=="span"&&a.attr("_ke_bookmark")}return function(a){var b,g;b=a&&a[0]&&a[0].nodeType==m.f&&(g=a.parent())&&j(g);b=i?b:b||j(a);return t^b}};H.Va=function(i){return function(t){t=
(t=t[0]||t)&&t.nodeType==m.f&&!q.trim(t.nodeValue);return i^t}};H.sf=function(i){var t=H.Va();return function(j){j=t(j)||j[0].nodeType==m.e&&!j[0].offsetHeight;return i^j}};k.Ia=H;k.Walker=H;var d=H.prototype;k.k.o(d,{end:d.end,next:d.next,previous:d.xb,checkForward:d.jd,checkBackward:d.hd,lastForward:d.Fd,lastBackward:d.Ed,reset:d.reset});k.k.o(H,{blockBoundary:H.ac,listItemBoundary:H.xf,bookmark:H.Na,whitespaces:H.Va,invisible:H.sf})});
KISSY.Editor.add("range",function(k){function y(c){this.endOffset=this.endContainer=this.startOffset=this.startContainer=e;this.collapsed=q;this.document=c}function p(c){var h=c[0].nodeType!=d.f&&c.d()in o.ca,l=!f.trim(c[0].nodeValue);c=!!c.parent().attr("_ke_bookmark");return h||l||c}function H(c){return!x(c)&&!I(c)}function C(c){var h=m,l=j.Na(q);return function(v){if(l(v))return q;if(v[0].nodeType==d.f){if(f.trim(v[0].nodeValue).length)return m}else if(v[0].nodeType==d.e)if(!w[v.d()])if(!c&&!g.ie&&
v.d()=="br"&&!h)h=q;else return m;return q}}function A(c,h){function l(v){return v&&v.nodeName=="span"&&v.getAttribute("_ke_bookmark")}return function(v){var n,D;n=v&&!v.nodeName&&(D=v.parentNode)&&l(D);n=c?n:n||l(v);return h^n}}function s(c){return function(h){h=(h=h[0]||h)&&h.nodeType==d.f&&!f.trim(h.nodeValue);return c^h}}k.oa={Y:1,J:2,B:3,r:4,Ib:1,Hb:2,Ya:3,bb:1,be:2,ig:3,fa:1,Lc:2};k.RANGE=k.oa;var q=S,m=X,e=T,f=KISSY,d=k.n,i=k.oa,t=k.$a,j=k.Ia,a=f.DOM,b=k.k.ud,g=f.UA,o=k.m,z=k.Za,B=f.Node,r=
{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1};y.prototype.toString=function(){var c=[];c.push((this.startContainer[0].id||this.startContainer[0].nodeName)+":"+this.startOffset);c.push((this.endContainer[0].id||this.endContainer[0].nodeName)+":"+this.endOffset);return c.join("<br/>")};f.augment(y,{Ua:function(){this.collapsed=this.startContainer&&this.endContainer&&a.g(this.startContainer,this.endContainer)&&this.startOffset==this.endOffset},vc:function(){var c=this.startContainer,
h=this.startOffset;if(c[0].nodeType!=d.e)if(h)h>=c[0].nodeValue.length&&this.setStartAfter(c);else this.setStartBefore(c);c=this.endContainer;h=this.endOffset;if(c[0].nodeType!=d.e)if(h)h>=c[0].nodeValue.length&&this.setEndAfter(c);else this.setEndBefore(c)},setStartAfter:function(c){this.setStart(c.parent(),c.t()+1)},setStartBefore:function(c){this.setStart(c.parent(),c.t())},setEndAfter:function(c){this.setEnd(c.parent(),c.t()+1)},setEndBefore:function(c){this.setEnd(c.parent(),c.t())},wc:function(){var c=
this.startContainer,h=this.endContainer;c&&c.d()=="span"&&c.attr("_ke_bookmark")&&this.V(c,i.B);h&&h.d()=="span"&&h.attr("_ke_bookmark")&&this.U(h,i.r)},setStart:function(c,h){if(c[0].nodeType==d.e&&r[c.d()]){c=c.parent();h=c.t()}this.startContainer=c;this.startOffset=h;if(!this.endContainer){this.endContainer=c;this.endOffset=h}this.Ua()},setEnd:function(c,h){if(c[0].nodeType==d.e&&r[c.d()]){c=c.parent();h=c.t()+1}this.endContainer=c;this.endOffset=h;if(!this.startContainer){this.startContainer=
c;this.startOffset=h}this.Ua()},V:function(c,h){switch(h){case i.Y:this.setStart(c,0);break;case i.J:c[0].nodeType==d.f?this.setStart(c,c[0].nodeValue.length):this.setStart(c,c[0].childNodes.length);break;case i.B:this.setStartBefore(c);break;case i.r:this.setStartAfter(c)}this.Ua()},U:function(c,h){switch(h){case i.Y:this.setEnd(c,0);break;case i.J:c[0].nodeType==d.f?this.setEnd(c,c[0].nodeValue.length):this.setEnd(c,c[0].childNodes.length);break;case i.B:this.setEndBefore(c);break;case i.r:this.setEndAfter(c)}this.Ua()},
hc:function(c,h){var l=this.startContainer,v=this.endContainer,n=this.startOffset,D=this.endOffset,Q,P=this.document,M;this.wc();if(v[0].nodeType==d.f)v=v.ia(D);else if(v[0].childNodes.length>0)if(D>=v[0].childNodes.length){v=new B(v[0].appendChild(P.createTextNode("")));M=q}else v=new B(v[0].childNodes[D]);if(l[0].nodeType==d.f){l.ia(n);if(l.g(v))v=new B(l[0].nextSibling)}else if(n)if(n>=l[0].childNodes.length){Q=new B(P.createTextNode(""));l.append(Q);l=Q;Q=q}else l=new B(l[0].childNodes[n].previousSibling);
else{Q=new B(P.createTextNode(""));l.prepend(Q);l=Q;Q=q}n=l.Ub();D=v.Ub();var O,U,W;for(O=0;O<n.length;O++){U=n[O];W=D[O];if(!U.g(W))break}P=h;for(var V,Z,ca,E=O;E<n.length;E++){V=n[E];Z=P&&!V.g(l)?P.appendChild(V.K()[0]):T;for(V=V[0].nextSibling;V;){if(a.g(D[E],V)||a.g(v,V))break;ca=V.nextSibling;if(c==2)P.appendChild(V.cloneNode(q));else{a.h(V);c==1&&P.appendChild(V)}V=ca}if(Z)P=Z}P=h;for(O=O;O<D.length;O++){V=D[O];Z=P&&c>0&&!V.g(v)?P.appendChild(V.K()[0]):T;if(!n[O]||!V.parent().g(n[O].parent()))for(V=
V[0].previousSibling;V;){if(a.g(n[O],V)||a.g(l,V))break;ca=V.previousSibling;if(c==2)P.insertBefore(V.cloneNode(q),P.firstChild);else{a.h(V);c==1&&P.insertBefore(V,P.firstChild)}V=ca}if(Z)P=Z}if(c==2){W=this.startContainer[0];if(W.nodeType==d.f&&W.nextSibling&&W.nextSibling.nodeType==d.f){W.data+=W.nextSibling.data;W.parentNode.removeChild(W.nextSibling)}W=this.endContainer[0];if(W.nodeType==d.f&&W.nextSibling&&W.nextSibling.nodeType==d.f){W.data+=W.nextSibling.data;W.parentNode.removeChild(W.nextSibling)}}else{if(U&&
W&&(!l.parent().g(U.parent())||!v.parent().g(W.parent()))){U=W.t();Q&&W.parent().g(l.parent())&&U--;this.setStart(W.parent(),U)}this.collapse(q)}Q&&l.h();M&&v[0].parentNode&&v.h()},collapse:function(c){if(c){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this.collapsed=q},clone:function(){var c=new y(this.document);c.startContainer=this.startContainer;c.startOffset=this.startOffset;c.endContainer=this.endContainer;
c.endOffset=this.endOffset;c.collapsed=this.collapsed;return c},wd:function(){var c=this.clone();c.vc();if(c.startContainer[0].nodeType!=d.e||c.endContainer[0].nodeType!=d.e)return e;var h=new k.Ia(c),l=A(q,undefined),v=s(q);c.R=function(n){return v(n)&&l(n)};c=h.next();h.reset();h=h.xb();return c&&c.g(h)?c:e},Ta:function(c,h){if(!this.collapsed){c=c||i.Lc;var l=this.clone(),v=this.startContainer,n=this.endContainer,D=this.startOffset,Q=this.endOffset,P=1,M=1;if(v&&v[0].nodeType==d.f)if(D)if(D>=v[0].nodeValue.length)l.setStartAfter(v);
else{l.setStartBefore(v);P=0}else l.setStartBefore(v);if(n&&n[0].nodeType==d.f)if(Q)if(Q>=n[0].nodeValue.length)l.setEndAfter(n);else{l.setEndAfter(n);M=0}else l.setEndBefore(n);l=new j(l);l.R=function(U){U=U[0]||U;return U.nodeType==(c==i.fa?d.e:d.f)};var O;l.nc=function(U,W){U=U[0]||U;if(c==i.fa&&U.nodeType==d.f)return m;if(W&&U==O)return m;if(!W&&U.nodeType==d.e)O=U;return q};if(P)(v=l[c==i.fa?"lastForward":"next"]())&&this.V(v,h?i.Y:i.B);if(M){l.reset();(l=l[c==i.fa?"lastBackward":"previous"]())&&
this.U(l,h?i.J:i.r)}return!!(P||M)}},lf:function(){var c=this.startContainer;if(this.collapsed||c[0].nodeType!=d.e)return c;return c.childNodes[this.startOffset]||c},ld:function(c){var h=this.startContainer,l=this.endContainer,v=this.startOffset,n=this.endOffset,D,Q;if(!h||!l)return{start:0,end:0};if(c){if(h[0].nodeType==d.e)if((D=new B(h[0].childNodes[v]))&&D[0]&&D[0].nodeType==d.f&&v>0&&D[0].previousSibling.nodeType==d.f){h=D;v=0}for(;h[0].nodeType==d.f&&(Q=h.sa())&&Q[0].nodeType==d.f;){h=Q;v+=
Q[0].nodeValue.length}if(!this.collapsed){if(l[0].nodeType==d.e)if((D=new B(l[0].childNodes[n]))&&D[0]&&D[0].nodeType==d.f&&n>0&&D[0].previousSibling.nodeType==d.f){l=D;n=0}for(;l[0].nodeType==d.f&&(Q=l.sa())&&Q[0].nodeType==d.f;){l=Q;n+=Q[0].nodeValue.length}}}return{start:h.Ja(c),end:this.collapsed?e:l.Ja(c),startOffset:v,endOffset:n,Id:c,tf:q}},O:function(c){var h,l,v,n,D=this.collapsed;h=new B("<span>",e,this.document);h.attr("_ke_bookmark",1);h.css("display","none");h.html("&nbsp;");if(c){v=
f.guid("ke_bm_");h.attr("id",v+"S")}if(!D){l=h.K();l.html("&nbsp;");c&&l.attr("id",v+"E");n=this.clone();n.collapse();n.insertNode(l)}n=this.clone();n.collapse(q);n.insertNode(h);if(l){this.setStartAfter(h);this.setEndBefore(l)}else this.G(h,i.r);return{aa:c?v+"S":h,Q:c?v+"E":l,Td:c,collapsed:D}},G:function(c,h){this.V(c,h);this.collapse(q)},trim:function(c,h){var l=this.startContainer,v=this.startOffset,n=this.collapsed;if((!c||n)&&l[0]&&l[0].nodeType==d.f){if(v)if(v>=l[0].nodeValue.length){v=l.t()+
1;l=l.parent()}else{var D=l.ia(v);v=l.t()+1;l=l.parent();if(a.g(this.startContainer,this.endContainer))this.setEnd(D,this.endOffset-this.startOffset);else if(a.g(l,this.endContainer))this.endOffset+=1}else{v=l.t();l=l.parent()}this.setStart(l,v);if(n){this.collapse(q);return}}l=this.endContainer;v=this.endOffset;if(!(h||n)&&l[0]&&l[0].nodeType==d.f){if(v){v>=l.nodeValue.length||l.ia(v);v=l.t()+1}else v=l.t();l=l.parent();this.setEnd(l,v)}},insertNode:function(c){this.wc();this.trim(m,q);var h=this.startContainer;
h[0].insertBefore(c[0]||c,h[0].childNodes[this.startOffset]||T);a.g(c.parent(),this.endContainer)&&this.endOffset++;this.setStartBefore(c)},moveToBookmark:function(c){if(c.tf){var h=b(this.document,c.start,c.Id),l=c.startOffset,v=c.end&&b(this.document,c.end,c.Id);c=c.endOffset;this.setStart(h,l);v?this.setEnd(v,c):this.collapse(q)}else{h=(l=c.Td)?f.one("#"+c.aa,this.document):c.aa;c=l?f.one("#"+c.Q,this.document):c.Q;this.setStartBefore(h);h.h();if(c&&c[0]){this.setEndBefore(c);c.h()}else this.collapse(q)}},
Aa:function(c,h){var l=this.startContainer,v=this.endContainer;l=a.g(l,v)?c&&l[0].nodeType==d.e&&this.startOffset==this.endOffset-1?new B(l[0].childNodes[this.startOffset]):l:l.Pb(v);return h&&l[0].nodeType==d.f?l.parent():l},Oa:function(c){switch(c){case i.Ib:if(this.collapsed)break;c=this.Aa();var h=new B(this.document.body),l,v,n,D,Q,P=m,M,O;M=this.startContainer;O=this.startOffset;if(M[0].nodeType==d.f){if(O){M=!f.trim(M[0].nodeValue.substring(0,O)).length&&M;P=!!M}if(M)if(!(D=M[0].previousSibling))n=
M.parent()}else{if(O)D=M[0].childNodes[O-1]||M[0].lastChild;D||(n=M)}for(;n||D;){if(n&&!D){if(!Q&&a.g(n,c))Q=q;if(!h.contains(n))break;if(!P||n.css("display")!="inline"){P=m;if(Q)l=n;else this.setStartBefore(n)}D=n[0].previousSibling}for(;D;){M=m;if(D.nodeType==d.f){O=D.nodeValue;if(/[^\s\ufeff]/.test(O))D=e;M=/[\s\ufeff]$/.test(O)}else if(D.offsetWidth>0&&!D.getAttribute("_ke_bookmark"))if(P&&o.ca[D.nodeName.toLowerCase()]){O=a.text(D);if(/[^\s\ufeff]/.test(O))D=e;else for(var U=D.all||D.getElementsByTagName("*"),
W=0,V;V=U[W++];)if(!o.ca[V.nodeName.toLowerCase()]){D=e;break}if(D)M=!!O.length}else D=e;if(M)if(P)if(Q)l=n;else n&&this.setStartBefore(n);else P=q;if(D){M=D.previousSibling;if(!n&&!M){n=new B(D);D=e;break}D=M}else n=e}if(n)n=n.parent()}M=this.endContainer;O=this.endOffset;n=D=e;Q=P=m;if(M[0].nodeType==d.f){M=!f.trim(M[0].nodeValue.substring(O)).length&&M;P=!(M&&M[0].nodeValue.length);if(M)if(!(D=M[0].nextSibling))n=M.parent()}else(D=M[0].childNodes[O])||(n=M);for(;n||D;){if(n&&!D){if(!Q&&a.g(n,c))Q=
q;if(!h.contains(n))break;if(!P||n.css("display")!="inline"){P=m;if(Q)v=n;else n&&this.setEndAfter(n)}D=n[0].nextSibling}for(;D;){M=m;if(D.nodeType==d.f){O=D.nodeValue;if(/[^\s\ufeff]/.test(O))D=e;M=/^[\s\ufeff]/.test(O)}else if(D.offsetWidth>0&&!D.getAttribute("_ke_bookmark"))if(P&&o.ca[D.nodeName.toLowerCase()]){O=a.text(D);if(/[^\s\ufeff]/.test(O))D=e;else{U=D.all||D.getElementsByTagName("*");for(W=0;V=U[W++];)if(!o.ca[V.nodeName.toLowerCase()]){D=e;break}}if(D)M=!!O.length}else D=e;if(M)if(P)if(Q)v=
n;else this.setEndAfter(n);if(D){M=D.nextSibling;if(!n&&!M){n=new B(D);D=e;break}D=M}else n=e}if(n)n=n.parent()}if(l&&v){c=l.contains(v)?v:l;this.setStartBefore(c);this.setEndAfter(c)}break;case i.Hb:case i.Ya:n=new y(this.document);h=new B(this.document.body);n.V(h,i.Y);n.setEnd(this.startContainer,this.startOffset);n=new j(n);var Z,ca,E=j.ac(c==i.Ya?{bc:1}:e),K=function(F){var G=E(F);G||(Z=F);return G};l=function(F){var G=K(F);if(!G&&F[0]&&F.d()=="br")ca=F;return G};n.nc=K;n=n.Ed();Z=Z||h;this.V(Z,
Z.d()!="br"&&(!n&&this.wa()||n&&Z.contains(n))?i.Y:i.r);n=this.clone();n.collapse();n.U(h,i.J);n=new j(n);n.nc=c==i.Ya?l:K;Z=e;n=n.Fd();Z=Z||h;this.U(Z,!n&&this.ka()||n&&Z.contains(n)?i.J:i.B);ca&&this.setEndAfter(ca)}},wa:function(){var c=this.startContainer,h=this.startOffset;if(h&&c[0].nodeType==d.f)if(f.trim(c[0].nodeValue.substring(0,h)).length)return m;this.trim();c=new z(this.startContainer);h=this.clone();h.collapse(q);h.V(c.w||c.D,i.Y);c=new j(h);c.R=C(q);return c.hd()},ka:function(){var c=
this.endContainer,h=this.endOffset;if(c[0].nodeType==d.f)if(f.trim(c[0].nodeValue.substring(h)).length)return m;this.trim();c=new z(this.endContainer);h=this.clone();h.collapse(m);h.U(c.w||c.D,i.J);c=new j(h);c.R=C(m);return c.jd()},deleteContents:function(){this.collapsed||this.hc(0)},extractContents:function(){var c=this.document.createDocumentFragment();this.collapsed||this.hc(1,c);return c},dc:function(c,h){var l=this.clone();l[h==i.bb?"setStartAt":"setEndAt"](c,h==i.bb?i.Y:i.J);l=new j(l);l.R=
p;return l[h==i.bb?"checkBackward":"checkForward"]()},sd:function(){var c=this.startContainer,h=this.endContainer,l=this.startOffset,v=this.endOffset,n;if(c[0].nodeType==d.e){n=c[0].childNodes.length;if(n>l)c=new B(c[0].childNodes[l]);else if(n<1)c=c.ha();else{for(c=c[0];c.lastChild;)c=c.lastChild;c=new B(c);c=c.v()||c}}if(h[0].nodeType==d.e){n=h[0].childNodes.length;if(n>v)h=(new B(h[0].childNodes[v])).ha(q);else if(n<1)h=h.ha();else{for(h=h[0];h.lastChild;)h=h.lastChild;h=new B(h)}}if(c.La(h)&t.da)c=
h;return{aa:c,Q:h}},nb:function(c,h){var l=this.O(),v=new B(this.document.createElement(h));this.collapse(c);this.Oa(i.Hb);v[0].appendChild(this.extractContents());v.gb();g.ie||v.Nb();this.insertNode(v);this.moveToBookmark(l);return v},Bc:function(c){var h=new z(this.startContainer),l=new z(this.endContainer),v=h.w,n=l.w,D=e;if(!h.D.g(l.D))return e;if(c!="br"){if(!v){v=this.nb(q,c);n=(new z(this.endContainer)).w}n||(n=this.nb(m,c))}c=v&&this.wa();h=n&&this.ka();this.deleteContents();if(v&&a.g(v,n))if(h){D=
new z(this.startContainer);this.G(n,i.r);n=e}else if(c){D=new z(this.startContainer);this.G(v,i.B);v=e}else{n=this.Cc(v);!g.ie&&!f.inArray(v.d(),["ul","ol"])&&v.Nb()}return{ah:v,Zg:n,Of:c,Nf:h,Rg:D}},Cc:function(c){if(!this.collapsed)return e;this.U(c,i.J);var h=this.extractContents(),l=c.K(m);l[0].appendChild(h);l.insertAfter(c);this.G(c,i.r);return l},sb:function(c,h){var l,v=k.m;if(v.Cb[c.d()])return m;for(;c&&c[0].nodeType==d.e;){if(l=c.Qc())this.G(c,h?i.J:i.Y);else if(v.Db[c.d()]){this.G(c,h?
i.r:i.B);return q}if((c=v.Cb[c.d()]?c[h?"_4e_previous":"_4e_next"](H):c[h?"_4e_last":"_4e_first"](H))&&c[0].nodeType==d.f){this.G(c,h?i.r:i.B);return q}}return l},selectNodeContents:function(c){this.setStart(c,0);this.setEnd(c,c[0].nodeType==d.f?c[0].nodeValue.length:c[0].childNodes.length)}});var w={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},x=new j.Va,I=new j.Na;k.Range=
y;k.Range=y;var u=y.prototype;k.k.o(u,{updateCollapsed:u.Ua,optimize:u.vc,setStartAfter:u.setStartAfter,setEndAfter:u.setEndAfter,setStartBefore:u.setStartBefore,setEndBefore:u.setEndBefore,optimizeBookmark:u.wc,setStart:u.setStart,setEnd:u.setEnd,setStartAt:u.V,setEndAt:u.U,execContentsAction:u.hc,collapse:u.collapse,clone:u.clone,getEnclosedNode:u.wd,shrink:u.Ta,getTouchedStartNode:u.lf,createBookmark2:u.ld,createBookmark:u.O,moveToPosition:u.G,trim:u.trim,insertNode:u.insertNode,moveToBookmark:u.moveToBookmark,
getCommonAncestor:u.Aa,enlarge:u.Oa,checkStartOfBlock:u.wa,checkEndOfBlock:u.ka,deleteContents:u.deleteContents,extractContents:u.extractContents,checkBoundaryOfElement:u.dc,getBoundaryNodes:u.sd,fixBlock:u.nb,splitBlock:u.Bc,splitElement:u.Cc,moveToElementEditablePosition:u.sb,selectNodeContents:u.selectNodeContents})});
KISSY.Editor.add("domiterator",function(k){function y(j){if(!(arguments.length<1)){this.Ea=j;this.jc=H;this.qd=p;this.gc=H;this.c||(this.c={})}}var p=S,H=X,C=KISSY,A=C.UA,s=k.Ia,q=k.Range,m=k.oa,e=k.n,f=k.Za,d=C.Node,i=C.DOM,t=/^[\r\n\t ]*$/;C.augment(y,{kf:function(j){var a,b,g,o,z;if(!this.c.I){b=this.Ea.clone();b.Ta(m.fa,p);b.Oa(this.jc||!this.qd?m.Ya:m.Hb);var B=new s(b),r=s.Na(p,p);B.R=r;this.c.la=B.next();B=new s(b);B.R=r;B=B.xb();this.c.I=B.v(p);if(this.c.I&&this.c.I[0].nodeType==e.f&&!C.trim(this.c.I[0].nodeValue)&&
this.c.I.parent().qa()){r=new q(b.document);r.G(this.c.I,m.r);if(r.ka()){r=new f(r.endContainer);this.c.I=(r.w||r.D).v(p)}}if(!this.c.I){this.c.I=this.c.od=new d(b.document.createTextNode(""));i.insertAfter(this.c.I[0],B[0])}b=T}r=this.c.la;B=this.c.I;for(this.c.la=T;r;){var w=H,x=r[0].nodeType!=e.e,I=H;if(x){if(r[0].nodeType==e.f)if(t.test(r[0].nodeValue))x=H}else{var u=r.d();if(r.qa(this.jc&&{bc:1})){if(u=="br")x=p;else if(!b&&!r[0].childNodes.length&&u!="hr"){a=r;g=r.g(B);break}if(b){b.U(r,m.B);
if(u!="br")this.c.la=r}w=p}else{if(r[0].firstChild){if(!b){b=new q(this.Ea.document);b.V(r,m.B)}r=new d(r[0].firstChild);continue}x=p}}if(x&&!b){b=new q(this.Ea.document);b.V(r,m.B)}g=(!w||x)&&r.g(B);if(b&&!w)for(;!r[0].nextSibling&&!g;){u=r.parent();if(u.qa(this.jc&&{bc:1})){w=p;g||u.g(B);break}r=u;x=p;g=r.g(B);I=p}x&&b.U(r,m.r);r=r.v(I,T,B);if((g=!r)||w&&b)break}if(!a){if(!b){this.c.od&&this.c.od.h();return this.c.la=T}a=new f(b.startContainer);r=a.D;w={Mg:1,ih:1,hh:1};a=a.w;if((!a||!a[0])&&!this.gc&&
w[r.d()]&&b.wa()&&b.ka())a=r;else if(!a||this.gc&&a.d()=="li"){a=new d(this.Ea.document.createElement(j||"p"));a[0].appendChild(b.extractContents());a.gb();b.insertNode(a);o=z=p}else if(a.d()!="li"){if(!b.wa()||!b.ka()){a=a.K(H);a[0].appendChild(b.extractContents());a.gb();z=b.Bc();o=!z.Of;z=!z.Nf;b.insertNode(a)}}else if(!g)this.c.la=a.g(B)?T:b.sd().Q.v(p,T,B)}if(o){b=new d(a[0].previousSibling);if(b[0]&&b[0].nodeType==e.e)if(b.d()=="br")b.h();else b[0].lastChild&&i.d(b[0].lastChild)=="br"&&i.h(b[0].lastChild)}if(z){b=
s.Na(H,p);o=new d(a[0].lastChild);if(o[0]&&o[0].nodeType==e.e&&o.d()=="br")if(A.ie||o.sa(b)||o.Ka(b))o.h()}if(!this.c.la)this.c.la=g||a.g(B)?T:a.v(p,T,B);return a}});q.prototype.Ye=function(){return new y(this)}});
KISSY.Editor.add("selection",function(k){function y(w){this.document=this.document=w;this.c={M:{}};if(a){var x=this.z().createRange();if(!x||x.item&&x.item(0).ownerDocument!=w||x.parentElement&&x.parentElement().ownerDocument!=w)this.Dd=C}}function p(w){w=new y(w);return!w||w.Dd?s:w}function H(w){var x=w.document,I=new d(x.body),u=new d(x.documentElement);if(m.ie){m.Ba<8&&u.on("click",function(M){(new d(M.target)).d()==="html"&&w.getSelection().z().createRange().select()});var c,h,l=1;u.on("mousedown",
function(){l=0});u.on("mouseup",function(){l=1});I.on("focusin",function(M){if((new d(M.target)).d()=="body")if(c){try{l&&c.select()}catch(O){}c=s}});I.on("focus",function(){h=C;n()});I.on("beforedeactivate",function(M){if(!M.relatedTarget){v();l=1}});f.on(e.ga(x),"blur",function(){try{x&&x.selection.empty()}catch(M){}});I.on("mousedown",function(){v()});I.on("mouseup",function(){h=C;setTimeout(function(){n(C)},0)});var v=function(){h=A},n=function(M){if(h){var O=w.document,U=w.getSelection(),W=U&&
U.pb(),V=U&&O.selection;if(M&&V&&W==i.Kb)if(!O.queryCommandEnabled("InsertImage")){setTimeout(function(){n(C)},50);return}var Z;if(!(V&&W==i.pa&&(Z=e.d(U.ob()))&&Z in{input:1,textarea:1})){c=V&&V.createRange();w.jb()}}};I.on("keydown",v);I.on("keyup",function(){h=C;n()});f.on(x,"selectionchange",n)}else{f.on(x,"mouseup",w.jb,w);f.on(x,"keyup",w.jb,w)}var D={table:1,pre:1},Q=/\s*<(p|div|address|h\d|center)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\1>)?(?=\s*$|<\/body>)/gi,P=k.Ia.Va(C);w.on("selectionChange",
function(M){var O=M.path;M=(M=M.selection)&&M.H()[0];if(!(!M||!M.collapsed||O.w))if(O.D.d()=="body"){O=M.nb(C,"p");if(O.fb().match(Q)){var U=O.Ka(P);if(U&&U[0].nodeType==j.e&&!D[U.d()]){M.sb(U);O.h()}else if((U=O.sa(P))&&U[0].nodeType==j.e&&!D[U.d()]){M.sb(U,U.fb().match(Q)?A:C);O.h()}}M.select();a||w.ub()}})}k.ge={Kb:1,pa:2,ab:3};var C=S,A=X,s=T,q=KISSY,m=q.UA,e=q.DOM,f=q.Event,d=q.Node,i=k.ge,t=k.oa,j=k.n,a=!window.getSelection,b=k.Ia,g=k.Range,o={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,
object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};q.augment(y,{z:!a?function(){var w=this.c.M;return w.tc||(w.tc=e.ga(this.document).getSelection())}:function(){var w=this.c.M;return w.tc||(w.tc=this.document.selection)},pb:!a?function(){var w=this.c.M;if(w.type)return w.type;var x=i.pa,I=this.z();if(I){if(I.rangeCount==1){I=I.getRangeAt(0);var u=I.startContainer;if(u==I.endContainer&&u.nodeType==j.e&&I.endOffset-I.startOffset===1&&o[u.childNodes[I.startOffset].nodeName.toLowerCase()])x=
i.ab}}else x=i.Kb;return w.type=x}:function(){var w=this.c.M;if(w.type)return w.type;var x=i.Kb;try{var I=this.z(),u=I.type;if(u=="Text")x=i.pa;if(u=="Control")x=i.ab;if(I.createRange().parentElement)x=i.pa}catch(c){}return w.type=x},H:a?function(){function w(x,I){x=x.duplicate();x.collapse(I);for(var u=x.parentElement(),c=u.childNodes,h,l=0;l<c.length;l++){var v=c[l];if(v.nodeType==j.e){h=x.duplicate();h.moveToElementText(v);v=h.compareEndPoints("StartToStart",x);var n=h.compareEndPoints("EndToStart",
x);h.collapse();if(v>0)break;else if(!v||n==1&&v==-1)return{xa:u,offset:l};else if(!n)return{xa:u,offset:l+1};h=s}}if(!h){h=x.duplicate();h.moveToElementText(u);h.collapse(A)}h.setEndPoint("StartToStart",x);h=String(h.text).replace(/\r\n|\r/g,"\n").length;try{for(;h>0;)h-=c[--l].nodeValue.length}catch(D){h=0}return h===0?{xa:u,offset:l}:{xa:c[l],offset:-h}}return function(){var x=this.c.M;if(x.na)return x.na;var I=this.z(),u=I&&I.createRange(),c=this.pb();if(!I)return[];if(c==i.pa){I=new g(this.document);
c=w(u,C);I.setStart(new d(c.xa),c.offset);c=w(u);I.setEnd(new d(c.xa),c.offset);return x.na=[I]}else if(c==i.ab){x=x.na=[];for(c=0;c<u.length;c++){var h=u.item(c),l=h.parentNode,v=0;for(I=new g(this.document);v<l.childNodes.length&&l.childNodes[v]!=h;v++);I.setStart(new d(l),v);I.setEnd(new d(l),v+1);x.push(I)}return x}return x.na=[]}}():function(){var w=this.c.M;if(w.na)return w.na;var x=[],I=this.z();if(!I)return[];for(var u=0;u<I.rangeCount;u++){var c=I.getRangeAt(u),h=new g(this.document);h.setStart(new d(c.startContainer),
c.startOffset);h.setEnd(new d(c.endContainer),c.endOffset);x.push(h)}return w.na=x},ob:function(){var w=this.c.M;if(w.Ud!==undefined)return w.Ud;var x,I=this.z();switch(this.pb()){case i.ab:return this.mc();case i.pa:var u=this.H()[0];if(u)if(!u.collapsed){for(u.vc();C;){x=u.startContainer;if(u.startOffset==(x[0].nodeType===j.e?x[0].childNodes.length:x[0].nodeValue.length)&&!x.qa())u.setStartAfter(x);else break}x=u.startContainer;if(x[0].nodeType!=j.e)return x.parent();x=new d(x[0].childNodes[u.startOffset]);
if(!x[0]||x[0].nodeType!=j.e)return u.startContainer;for(u=x[0].firstChild;u&&u.nodeType==j.e;){x=new d(u);u=u.firstChild}return x}if(a){u=I.createRange();u.collapse(C);x=u.parentElement()}else if((x=I.anchorNode)&&x.nodeType!=j.e)x=x.parentNode}return w.Ud=x?e.C(x):s},mc:function(){var w=this,x,I=w.c.M;if(I.Sd!==undefined)return I.Sd;if(a){x=w.z().createRange();x=x.item&&x.item(0)}x||(x=function(){for(var u=w.H()[0],c,h,l=2;l&&!((c=u.wd())&&c[0].nodeType==j.e&&o[c.d()]&&(h=c));l--)u.Ta(t.fa);return h&&
h[0]}());return I.Sd=e.C(x)},reset:function(){this.c.M={}},Ac:function(w){var x,I=this.document;if(a)try{x=I.body.createControlRange();x.addElement(w[0]);x.select()}catch(u){x=I.body.createTextRange();x.moveToElementText(w[0]);x.select()}finally{}else{x=I.createRange();x.selectNode(w[0]);w=this.z();w.removeAllRanges();w.addRange(x)}this.reset()},Ab:function(w){if(a){if(w.length>1){var x=w[w.length-1];w[0].setEnd(x.endContainer,x.endOffset);w.length=1}w[0]&&w[0].select()}else{x=this.z();if(!x)return;
x.removeAllRanges();for(var I=0;I<w.length;I++){var u=w[I],c=this.document.createRange(),h=u.startContainer;u.collapsed&&m.gecko&&m.gecko<1.09&&h[0].nodeType==j.e&&!h[0].childNodes.length&&h[0].appendChild(this.document.createTextNode(""));c.setStart(h[0],u.startOffset);c.setEnd(u.endContainer[0],u.endOffset);x.addRange(c)}}this.reset()},Xe:function(w){for(var x=[],I=this.H(),u=0;u<I.length;u++)x.push(I[u].ld(w));return x},We:function(w,x){var I=[],u=this.document,c;x=x||this.H();for(var h=x.length,
l=0;l<h;l++){I.push(c=x[l].O(w,C));var v=(w=c.Td)?q.one("#"+c.aa,u):c.aa;c=w?q.one("#"+c.Q,u):c.Q;for(var n=l+1;n<h;n++){var D=x[n],Q=D.startContainer,P=D.endContainer;e.g(Q,v.parent())&&D.startOffset++;e.g(Q,c.parent())&&D.startOffset++;e.g(P,v.parent())&&D.endOffset++;e.g(P,c.parent())&&D.endOffset++}}return I},Rd:function(w){for(var x=[],I=0;I<w.length;I++){var u=new g(this.document);u.moveToBookmark(w[I]);x.push(u)}this.Ab(x);return this},Aa:function(){var w=this.H();return w[0].startContainer.Pb(w[w.length-
1].endContainer)},scrollIntoView:function(){var w=this.ob();w&&w.Vb()},removeAllRanges:function(){var w=this.z();if(a)w&&w.clear();else w&&w.removeAllRanges()}});var z={table:1,tbody:1,tr:1},B=b.Va(C),r=/\ufeff|\u00a0/;g.prototype.select=g.prototype.select=!a?function(){var w=this.startContainer;this.collapsed&&w[0].nodeType==j.e&&!w[0].childNodes.length&&w[0].appendChild(this.document.createTextNode(""));var x=this.document.createRange();x.setStart(w[0],this.startOffset);try{x.setEnd(this.endContainer[0],
this.endOffset)}catch(I){if(I.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0){this.collapse(C);x.setEnd(this.endContainer[0],this.endOffset)}else throw I;}w=p(this.document).z();w.removeAllRanges();w.addRange(x)}:function(w){var x=this.collapsed,I,u;if(this.startContainer[0]===this.endContainer[0]&&this.endOffset-this.startOffset==1){var c=this.startContainer[0].childNodes[this.startOffset];if(c.nodeType==j.e){(new y(this.document)).Ac(new d(c));return}}if(this.startContainer[0].nodeType==j.e&&this.startContainer.d()in
z||this.endContainer[0].nodeType==j.e&&this.endContainer.d()in z)this.Ta(t.fa,C);var h=this.O();c=h.aa;var l;if(!x)l=h.Q;h=this.document.body.createTextRange();h.moveToElementText(c[0]);h.moveStart("character",1);if(l){w=this.document.body.createTextRange();w.moveToElementText(l[0]);h.setEndPoint("EndToEnd",w);h.moveEnd("character",-1)}else{for(I=c[0].nextSibling;I&&!B(I);)I=I.nextSibling;I=!(I&&I.nodeValue&&I.nodeValue.match(r))&&(w||!c[0].previousSibling||c[0].previousSibling&&e.d(c[0].previousSibling)==
"br");u=new d(this.document.createElement("span"));u.html("&#65279;");u.insertBefore(c);I&&e.insertBefore(this.document.createTextNode("\ufeff"),c)}this.setStartBefore(c);c.h();if(x){if(I){h.moveStart("character",-1);h.select();this.document.selection.clear()}else h.select();if(u){this.G(u,t.B);u.h()}}else{this.setEndBefore(l);l.h();h.select()}};y.getSelection=p;k.Nc=y;k.Selection=y;b=y.prototype;k.k.o(b,{getNative:b.z,getType:b.pb,getRanges:b.H,getStartElement:b.ob,getSelectedElement:b.mc,reset:b.reset,
selectElement:b.Ac,selectRanges:b.Ab,createBookmarks2:b.Xe,createBookmarks:b.We,getCommonAncestor:b.Aa,scrollIntoView:b.scrollIntoView,selectBookmarks:b.Rd,removeAllRanges:b.removeAllRanges});k.on("instanceCreated",function(w){H(w.bf)})});
KISSY.Editor.add("styles",function(k){function y(E){return!E.attr("_ke_bookmark")}function p(E,K){for(var F in E)E[F]=E[F].replace(Z,function(G,J){return K[J]})}function H(E,K){if(K){E=I.clone(E);p(E.attributes,K);p(E.styles,K)}var F=this.element=this.element=(E.element||"*").toLowerCase();this.type=this.type=F=="#"||U[F]?h.Lb:W[F]?h.cb:h.Ha;this.c={definition:E}}function C(E,K){var F=K?this.zc:this.Xb;E.body.focus();for(var G=new v(E),J=G.H(),N=0;N<J.length;N++)F.call(this,J[N]);G.Ab(J)}function A(E,
K){var F;F=E.element;if(F=="*")F="span";F=new P(K.createElement(F));return s(F,E)}function s(E,K){var F=K.c.definition,G=F.attributes;F=H.xd(F);if(G)for(var J in G)E.attr(J,G[J]);if(F)E[0].style.cssText=F;return E}function q(E){var K=E.O(r),F=E.Ye();F.gc=r;F.qd=r;for(var G,J=E.document;G=F.kf();){var N=A(this,J);G=G;var L=N;N=L.d=="pre";var R=G.d=="pre",ba=!N&&R;if(N&&!R){R=G;L=L;ba=R.html();ba=m(ba,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");ba=ba.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1");ba=
ba.replace(/([ \t\n\r]+|&nbsp;)/g," ");ba=ba.replace(/<br\b[^>]*>/gi,"\n");if(M.ie){R=R[0].ownerDocument.createElement("div");R.appendChild(L[0]);L[0].outerHTML="<pre>"+ba+"</pre>";L=new P(R.firstChild);L.h()}else L.html(ba);L=L}else if(ba)L=f(e(G),L);else G.Tb(L);G[0].parentNode.replaceChild(L[0],G[0]);if(N){G=L;N=void 0;if((N=G.ha(r,n.e))&&N.d()=="pre"){L=m(N.html(),/\n$/,"")+"\n\n"+m(G.html(),/^\n/,"");if(M.ie)G[0].outerHTML="<pre>"+L+"</pre>";else G.html(L);N.h()}}}E.moveToBookmark(K)}function m(E,
K,F){var G="",J="";E=E.replace(/(^<span[^>]+_ke_bookmark.*?\/span>)|(<span[^>]+_ke_bookmark.*?\/span>$)/gi,function(N,L,R){L&&(G=L);R&&(J=R);return""});return G+E.replace(K,F)+J}function e(E){var K=[];m(E.fb(),/(\S\s*)\n(?:\s|(<span[^>]+_ck_bookmark.*?\/span>))*\n(?!$)/gi,function(F,G,J){return G+"</pre>"+J+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(F,G){K.push(G)});return K}function f(E,K){for(var F=K[0].ownerDocument.createDocumentFragment(),G=0;G<E.length;G++){var J=E[G];J=J.replace(/(\r\n|\r)/g,
"\n");J=m(J,/^[ \t]*\n/,"");J=m(J,/\n$/,"");J=m(J,/^[ \t]+|[ \t]+$/g,function(L,R){return L.length==1?"&nbsp;":R?" "+Array(L.length).join("&nbsp;"):Array(L.length).join("&nbsp;")+" "});J=J.replace(/\n/g,"<br>");J=J.replace(/[ \t]{2,}/g,function(L){return Array(L.length).join("&nbsp;")+" "});var N=K.K();N.html(J);F.appendChild(N[0])}return F}function d(E){var K=E.document;if(E.collapsed){K=A(this,K);E.insertNode(K);E.G(K,l.J)}else{var F=this.element,G=this.c.definition,J,N=k.m[F]||(J=r,k.m.span),L=
E.O();E.Oa(l.Ib);E.trim();var R=E.O(),ba=R.aa;R=R.Q;for(var $=ba,da;$&&$[0];){var Y=w;if(c.g($,R)){$=x;Y=r}else{var aa=$[0].nodeType,fa=aa==n.e?$.d():x;if(fa&&$.attr("_ke_bookmark")){$=$.v(r);continue}if(!fa||N[fa]&&($.La(R)|D.$|D.ea|D.Z)==D.$+D.ea+D.Z&&(!G.childRule||G.childRule($))){var ha=$.parent();if(ha&&ha[0]&&((k.m[ha.d()]||k.m.span)[F]||J)&&(!G.parentRule||G.parentRule(ha))){if(!da&&(!fa||!k.m.ca[fa]||($.La(R)|D.$|D.ea|D.Z)==D.$+D.ea+D.Z)){da=new Q(K);da.setStartBefore($)}if(aa==n.f||aa==
n.e&&!$[0].childNodes.length){aa=$;for(var ga;(Y=!aa.Ka(y))&&(ga=aa.parent(),N[ga.d()])&&(ga.La(ba)|D.da|D.ea|D.Z)==D.da+D.ea+D.Z&&(!G.childRule||G.childRule(ga));)aa=ga;da.setEndAfter(aa)}}else Y=r}else Y=r;$=$.v()}if(Y&&da&&!da.collapsed){Y=A(this,K);aa=da.Aa();fa={gh:{},Ne:{},fd:{},ed:{}};for(var ea,ia,ja;Y&&aa&&Y[0]&&aa[0];){if(aa.d()==F){for(ea in G.attributes)if(!(fa.ed[ea]||!(ja=aa.attr(ia))))if(Y.attr(ea)==ja)Y.removeAttr(ea);else fa.ed[ea]=1;for(ia in G.styles)if(!(fa.fd[ia]||!(ja=aa.L(ia))))if(Y.L(ia)==
ja)Y.L(ia,"");else fa.fd[ia]=1;if(!Y.eb()){Y=x;break}}aa=aa.parent()}if(Y){Y[0].appendChild(da.extractContents());o(this,Y);da.insertNode(Y);Y.ra();M.ie||Y[0].normalize()}else{Y=new P(K.createElement("span"));Y[0].appendChild(da.extractContents());da.insertNode(Y);o(this,Y);Y.h(S)}da=x}}ba.h();R.h();E.moveToBookmark(L);E.Ta(l.Lc)}}function i(E){E.Oa(l.Ib);var K=E.O(),F=K.aa;if(E.collapsed){for(var G=new O(F.parent()),J,N=0,L;N<G.elements.length&&(L=G.elements[N]);N++){if(L==G.w||L==G.D)break;if(this.ja(L)){var R=
E.dc(L,l.be),ba=!R&&E.dc(L,l.bb);if(ba||R){J=L;J.match=ba?"start":"end"}else{L.ra();L.d()==this.element?b(this,L):z(L,a(this)[L.d()])}}}if(J&&J[0]){L=F;for(N=0;;N++){R=G.elements[N];if(c.g(R,J))break;else if(R.match)continue;else R=R.K();R[0].appendChild(L[0]);L=R}c[J.match=="start"?"insertBefore":"insertAfter"](L,J)}}else{var $=K.Q,da=this;G=function(){for(var Y=new O(F.parent()),aa=new O($.parent()),fa=x,ha=x,ga=0;ga<Y.elements.length;ga++){var ea=Y.elements[ga];if(ea==Y.w||ea==Y.D)break;if(da.ja(ea))fa=
ea}for(ga=0;ga<aa.elements.length;ga++){ea=aa.elements[ga];if(ea==aa.w||ea==aa.D)break;if(da.ja(ea))ha=ea}ha&&$.Ob(ha);fa&&F.Ob(fa)};G();for(J=new P(F[0].nextSibling);J[0]!==$[0];){N=J.v();if(J[0]&&J[0].nodeType==n.e&&this.ja(J)){J.d()==this.element?b(this,J):z(J,a(this)[J.d()]);if(N[0].nodeType==n.e&&N.contains(F)){G();N=new P(F[0].nextSibling)}}J=N}}E.moveToBookmark(K)}function t(E){E=String(E);var K={};E.replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(F,G,J){K[G]=
J});return K}function j(E,K){var F="";if(K!==w){F=document.createElement("span");F.style.cssText=E;F=F.style.cssText||""}else F=E;return F.replace(/\s*([;:])\s*/,"$1").replace(/([^\s;])$/,"$1;").replace(/,\s+/g,",").toLowerCase()}function a(E){if(E.c.Qd)return E.c.Qd;var K=E.c.Qd={},F=E.c.definition.overrides;if(F){I.isArray(F)||(F=[F]);for(var G=0;G<F.length;G++){var J=F[G],N,L;if(typeof J=="string")N=J.toLowerCase();else{N=J.element?J.element.toLowerCase():E.element;L=J.attributes}J=K[N]||(K[N]=
{});if(L){J=J.attributes=J.attributes||[];for(var R in L)J.push([R.toLowerCase(),L[R]])}}}return K}function b(E,K){var F=E.c.definition,G=u.mix(F.attributes,a(E)[K.d()]);F=F.styles;var J=I.isEmptyObject(G)&&I.isEmptyObject(F),N;for(N in G)if(!((N=="class"||E.c.definition.fullMatch)&&K.attr(N)!=g(N,G[N]))){J=J||!!K.Rb(N);K.removeAttr(N)}for(var L in F)if(!(E.c.definition.fullMatch&&K.L(L)!=g(L,F[L],r))){J=J||!!K.L(L);K.L(L,"")}B(K)}function g(E,K,F){var G=new P("<span>");G[F?"_4e_style":"attr"](E,
K);return G[F?"_4e_style":"attr"](E)}function o(E,K){for(var F=a(E),G=K.all(E.element),J=G.length;--J>=0;)b(E,new P(G[J]));for(var N in F)if(N!=E.element){G=K.all(N);for(J=G.length-1;J>=0;J--){var L=new P(G[J]);z(L,F[N])}}}function z(E,K){var F=K&&K.attributes;if(F)for(var G=0;G<F.length;G++){var J=F[G][0],N;if(N=E.attr(J)){var L=F[G][1];if(L===x||L.test&&L.test(N)||typeof L=="string"&&N==L)E[0].removeAttribute(J)}}B(E)}function B(E){if(!E.eb()){var K=E[0].firstChild,F=E[0].lastChild;E.h(r);if(K){K.nodeType==
n.e&&c.ra(K);F&&K!=F&&F.nodeType==n.e&&c.ra(F)}}}var r=S,w=X,x=T,I=KISSY,u=k.k,c=I.DOM,h={Lb:1,Ha:2,cb:3},l=k.oa,v=k.Nc,n=k.n,D=k.$a,Q=k.Range,P=I.Node,M=I.UA,O=k.Za,U={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1},W={embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1},V=/\s*(?:;\s*|$)/g,Z=/#\((.+?)\)/g;k.jg=h;H.prototype={apply:function(E){C.call(this,E,w)},remove:function(E){C.call(this,E,r)},Xb:function(E){return(this.Xb=this.type==h.Ha?d:this.type==
h.Lb?q:this.type==h.cb?x:x).call(this,E)},zc:function(E){return(this.zc=this.type==h.Ha?i:x).call(this,E)},Ke:function(E){s(E,this)},ja:function(E,K){if(!E)return w;var F=this.c.definition;if(E.d()==this.element){if(!K&&!E.eb())return r;var G=F.re;if(G)F=G;else{G={};var J=0,N=F.attributes;if(N)for(var L in N){J++;G[L]=N[L]}if(N=H.xd(F)){G.style||J++;G.style=N}G._length=J;F=F.re=G}if(F._length){for(var R in F)if(R!="_length"){J=E.attr(R)||"";if(R=="style")a:{G=F[R];J=j(J,w);typeof G=="string"&&(G=
t(G));typeof J=="string"&&(J=t(J));N=void 0;for(N in G)if(!(N in J&&(J[N]==G[N]||G[N]=="inherit"||J[N]=="inherit"))){G=w;break a}G=r}else G=F[R]==J;if(G){if(!K)return r}else if(K)return w}if(K)return r}else return r}if(R=a(this)[E.d()]){if(!(F=R.attributes))return r;for(G=0;G<F.length;G++){R=F[G][0];if(R=E.attr(R)){J=F[G][1];if(J===x||typeof J=="string"&&R==J||J.test&&J.test(R))return r}}}return w},Se:function(E){switch(this.type){case h.Lb:return this.ja(E.w||E.D,r);case h.cb:case h.Ha:for(var K=
E.elements,F=0,G;F<K.length;F++){G=K[F];if(!(this.type==h.Ha&&(c.g(G,E.w)||c.g(G,E.D))))if(!(this.type==h.cb&&!(G.d()in W)))if(this.ja(G,r))return r}}return w}};H.xd=function(E){var K=E.se;if(K)return K;K=E.styles;var F=E.attributes&&E.attributes.style||"",G="";if(F.length)F=F.replace(V,";");for(var J in K){var N=K[J],L=(J+":"+N).replace(V,";");if(N=="inherit")G+=L;else F+=L}if(F.length)F=j(F);F+=G;return E.se=F};k.kg=H;k.Style=H;var ca=H.prototype;k.k.o(ca,{apply:ca.apply,remove:ca.remove,applyToRange:ca.Xb,
removeFromRange:ca.zc,applyToObject:ca.Ke,checkElementRemovable:ca.ja,checkActive:ca.Se})});
KISSY.Editor.add("htmlparser",function(){function k(){}function y(){this.c={Ad:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)--\>)|(?:([^\\s>]+)\\s*((?:(?:[^\"'>]+)|(?:\"[^\"]*\")|(?:'[^']*'))*)\\/?>))","g")}}var p=KISSY,H=p.Editor,C=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,A={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},s=H.m;p.augment(y,{Da:k,Pd:k,ma:k,Ld:k,Ra:k,parse:function(q){for(var m,
e,f=0,d;m=this.c.Ad.exec(q);){e=m.index;if(e>f){f=q.substring(f,e);d?d.push(f):this.ma(f)}f=this.c.Ad.lastIndex;if(e=m[1]){e=e.toLowerCase();if(d&&s.Fc[e]){this.Ld(d.join(""));d=T}if(!d){this.Pd(e);continue}}if(d)d.push(m[0]);else if(e=m[3]){e=e.toLowerCase();if(!/="/.test(e)){var i={},t;m=m[4];var j=!!(m&&m.charAt(m.length-1)=="/");if(m)for(;t=C.exec(m);){var a=t[1].toLowerCase();t=t[2]||t[3]||t[4]||"";i[a]=!t&&A[a]?a:t}this.Da(e,i,j);if(!d&&s.Fc[e])d=[]}}else if(e=m[2])this.Ra(e)}q.length>f&&this.ma(q.substring(f,
q.length))}});H.j=y;H.HtmlParser=y});
KISSY.Editor.add("htmlparser-basicwriter",function(){function k(){this.c={l:[]}}var y=KISSY,p=y.Editor,H=p.k;y.augment(k,{vb:function(C){this.c.l.push("<",C)},wb:function(C,A){A?this.c.l.push(" />"):this.c.l.push(">")},kb:function(C,A){if(typeof A=="string")A=H.pc(A);this.c.l.push(" ",C,'="',A,'"')},lb:function(C){this.c.l.push("</",C,">")},text:function(C){this.c.l.push(C)},N:function(C){this.c.l.push("<!--",C,"--\>")},write:function(C){this.c.l.push(C)},reset:function(){this.c.l=[];this.c.A=X},
kc:function(C){var A=this.c.l.join("");C&&this.reset();return A}});p.j.Gb=k;p.j.BasicWriter=k;y=k.prototype;p.k.o(y,{openTag:y.vb,openTagClose:y.wb,attribute:y.kb,closeTag:y.lb,text:y.text,comment:y.N,write:y.write,reset:y.reset,getHtml:y.kc})});
KISSY.Editor.add("htmlparser-htmlwriter",function(){function k(){k.superclass.constructor.call(this);this.Bd="\t";this.Ff=" />";this.wf="\n";this.ff=A;this.Gf=C;this.c.A=A;this.c.F="";this.c.rules={};var s=p.m,q;for(q in H.mix({},s.Fb,s.Xa,s.Eb,s.Ic))this.Fa(q,{A:C,Pe:C,cc:C,gd:!s[q]["#"],Oe:C});this.Fa("br",{cc:C});this.Fa("title",{A:A,cc:A});this.Fa("style",{A:A,gd:C});this.Fa("pre",{A:A})}var y=KISSY,p=y.Editor,H=p.k,C=S,A=X;y.extend(k,p.j.Gb,{vb:function(s){var q=this.c.rules[s];if(this.c.A)this.F();
else if(q&&q.Pe){this.Pa();this.F()}this.c.l.push("<",s)},wb:function(s,q){var m=this.c.rules[s];if(q)this.c.l.push(this.Ff);else{this.c.l.push(">");if(m&&m.A)this.c.F+=this.Bd}m&&m.cc&&this.Pa()},kb:function(s,q){if(typeof q=="string"){this.ff&&(q=q.replace(/&amp;/g,"&"));q=H.pc(q)}this.c.l.push(" ",s,'="',q,'"')},lb:function(s){var q=this.c.rules[s];if(q&&q.A)this.c.F=this.c.F.substr(this.Bd.length);if(this.c.A)this.F();else if(q&&q.gd){this.Pa();this.F()}this.c.l.push("</",s,">");q&&q.Oe&&this.Pa()},
text:function(s){if(this.c.A){this.F();s=H.Qa(s)}this.c.l.push(s)},N:function(s){this.c.A&&this.F();this.c.l.push("<!--",s,"--\>")},Pa:function(){this.c.l.length>0&&this.c.l.push(this.wf);this.c.A=C},F:function(){this.c.l.push(this.c.F);this.c.A=A},Fa:function(s,q){var m=this.c.rules[s];if(m)H.mix(m,q);else this.c.rules[s]=q}});p.j.Yf=k;p.j.HtmlWriter=k;y=k.prototype;p.k.o(y,{openTag:y.vb,openTagClose:y.wb,attribute:y.kb,closeTag:y.lb,text:y.text,comment:y.N,lineBreak:y.Pa,indentation:y.F,setRules:y.Fa})});
KISSY.Editor.add("htmlparser-fragment",function(){function k(){this.children=[];this.parent=H;this.c={S:y,oc:p}}var y=S,p=X,H=T,C=KISSY.Editor,A={colgroup:1,dd:1,dt:1,li:1,option:1,p:1,td:1,tfoot:1,th:1,thead:1,tr:1},s=KISSY,q=C.k,m=C.n,e=C.m;q.mix({table:1,ul:1,ol:1,dl:1},e.table,e.ul,e.ol,e.dl);var f=e.Yd,d=e.Eb;k.Jb=function(i,t){function j(c){var h;if(z.length>0)for(var l=0;l<z.length;l++){var v=z[l],n=v.name,D=e[n],Q=r.name&&e[r.name];if((!Q||Q[n])&&(!c||!D||D[c]||!e[c])){if(!h){a();h=1}v=v.clone();
v.parent=r;r=v;z.splice(l,1);l--}}}function a(){for(;B.length;)r.add(B.shift())}function b(c,h,l){h=h||r||o;if(t&&!h.type){var v,n;if((v=c.attributes&&(n=c.attributes._ke_real_element_type)?n:c.name)&&!(v in e.Ec)&&!(v in e.Fb)){n=r;r=h;g.Da({Xg:"ul",Og:"dl",Ig:"dl"}[v]||t,{});h=r;if(l)r=n}}if(c.c.S&&c.name!="pre"){l=c.children.length;if((v=c.children[l-1])&&v.type==m.f)if(n=q.Sa(v.value))v.value=n;else c.children.length=l-1}h.add(c);if(c.yb){r=c.yb;delete c.yb}}var g=new C.j,o=new k,z=[],B=[],r=
o,w=p,x;g.Da=function(c,h,l){var v=new C.j.Jc(c,h);if(v.rc&&l)v.rb=y;if(e.ca[c])z.push(v);else{if(c==="pre")w=y;else if(c==="br"&&w){r.add(new C.j.Mb("\n"));return}if(c==="br")B.push(v);else{var n=r.name,D=n&&(e[n]||(r.c.S?e.div:e.span));if(D&&!v.rc&&!r.rc&&!D[c]){D=p;var Q;if(c in f&&n in f){n=r.children;(n=n[n.length-1])&&n.name in d||b(n=new C.j.Jc("li"),r);x=r;Q=n}else if(c==n)b(r,r.parent);else{b(r,r.parent,y);!A[n]&&n in e.Db&&z.unshift(r);D=y}r=Q?Q:r.yb||r.parent;if(D){g.Da.apply(this,arguments);
return}}j(c);a();v.parent=r;v.yb=x;x=0;if(v.rb)b(v);else r=v}}};g.Pd=function(c){for(var h=z.length-1;h>=0;h--)if(c==z[h].name){z.splice(h,1);return}for(var l=[],v=[],n=r;n.type&&n.name!=c;){n.c.S||v.unshift(n);l.push(n);n=n.parent}if(n.type){for(h=0;h<l.length;h++){var D=l[h];b(D,D.parent)}r=n;if(r.name=="pre")w=p;n.c.S&&a();b(n,n.parent);if(n==r)r=r.parent;z=z.concat(v)}if(c=="body")t=p};g.ma=function(c){if(!r.c.oc&&!w){c=q.Qa(c);if(c.length===0)return}a();j();if(t&&(!r.type||r.name=="body")&&q.trim(c))this.Da(t,
{});w||(c=c.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));r.add(new C.j.Mb(c))};g.Ld=function(){};g.Ra=function(c){r.add(new C.j.$d(c))};g.parse(i);for(a();r.type;){var I=r.parent,u=r;if(t&&(!I.type||I.name=="body")&&!e.Ec[u.name]){r=I;g.Da(t,{});I=r}I.add(u);r=I}return o};s.augment(k,{add:function(i){var t=this.children.length;if(t=t>0&&this.children[t-1]||H){if(i.c.S&&t.type==m.f){t.value=q.Sa(t.value);if(t.value.length===0){this.children.pop();this.add(i);return}}t.next=i}i.xb=t;i.parent=this;this.children.push(i);
this.c.oc=i.type==m.f||i.type==m.e&&!i.c.S},ba:function(i,t){var j;this.filterChildren=this.ic=function(){var a=new C.j.Gb;this.X.call(this,a,t,y);a=a.kc();this.children=(new k.Jb(a)).children;j=1};!this.name&&t&&t.Nd(this);this.X(i,j?H:t)},X:function(i,t){for(var j=0;j<this.children.length;j++)this.children[j].ba(i,t)}});C.j.Ga=k;C.j.Fragment=k;k.FromHtml=k.Jb;s=k.prototype;C.k.o(s,{add:s.add,writeHtml:s.ba,writeChildrenHtml:s.X})});
KISSY.Editor.add("htmlparser-element",function(){function k(A,s){A=A[0];s=s[0];return A<s?-1:A>s?1:0}function y(A,s){this.name=A;this.attributes=s||(s={});this.children=[];var q=s.qg||A,m=p.m;q=!!(m.Fb[q]||m.Xa[q]||m.Eb[q]||m.Ic[q]||m.Hc[q]||q=="br");var e=!!m.Cb[A];this.rb=e;this.rc=!m[A];this.c={S:q,oc:e||!q}}var p=KISSY.Editor,H=p.n;KISSY.augment(y,{type:H.e,add:p.j.Ga.prototype.add,clone:function(){return new y(this.name,this.attributes)},ba:function(A,s){var q=this.attributes,m=this,e=m.name,
f,d,i,t;m.ic=function(){if(!t){var b=new p.j.Gb;p.j.Ga.prototype.X.call(m,b,s);m.children=(new p.j.Ga.Jb(b.kc())).children;t=1}};m.filterChildren=m.ic;if(s){for(;;){if(!(e=s.Md(e)))return;m.name=e;if(!(m=s.uc(m)))return;m.parent=this.parent;if(m.name==e)break;if(m.type!=H.e){m.ba(A,s);return}e=m.name;if(!e){this.X.call(m,A,t?T:s);return}}q=m.attributes}A.vb(e,q);for(var j=[],a=0;a<2;a++)for(f in q){d=f;i=q[f];if(a==1)j.push([f,i]);else if(s){for(;;)if(d=s.Kd(f))if(d!=f){delete q[f];f=d}else break;
else{delete q[f];break}if(d)if((i=s.Jd(m,d,i))===X)delete q[d];else q[d]=i}}A.Gf&&j.sort(k);q=j.length;for(a=0;a<q;a++){f=j[a];A.kb(f[0],f[1])}A.wb(e,m.rb);if(!m.rb){this.X.call(m,A,t?T:s);A.lb(e)}},X:function(){p.j.Ga.prototype.X.apply(this,arguments)}});p.j.Jc=y;p.j.Element=y;var C=y.prototype;p.k.o(C,{type:C.type,add:C.add,clone:C.clone,writeHtml:C.ba,writeChildrenHtml:C.X})});
KISSY.Editor.add("htmlparser-filter",function(){function k(f){this.c={fc:[],Zb:[],elements:{Gc:0},attributes:{Gc:0}};f&&this.cd(f,10)}function y(f,d){for(var i=0;f&&i<d.length;i++){var t=d[i];f=f.replace(t[0],t[1])}return f}function p(f,d,i){if(typeof d=="function")d=[d];var t,j;j=f.length;var a=d&&d.length;if(a){for(t=0;t<j&&f[t].yc<i;t++);for(j=a-1;j>=0;j--)if(a=d[j]){a.yc=i;f.splice(t,0,a)}}}function H(f,d,i){if(d)for(var t in d){var j=f[t];f[t]=C(j,d[t],i);j||f.Gc++}}function C(f,d,i){if(d){d.yc=
i;if(f){if(f.splice)p(f,d,i);else{f=f.yc>i?[d,f]:[f,d];f.filter=A}return f}else return d.filter=d}}function A(f){for(var d=f.type||f instanceof q.j.Ga,i=0;i<this.length;i++){if(d)var t=f.type,j=f.name;var a=this[i].apply(window,arguments);if(a===e)return a;if(d){if(a&&(a.name!=j||a.type!=t))return a}else if(typeof a!="string")return a;a!=undefined&&(f=a)}return f}var s=KISSY,q=s.Editor,m=q.n,e=X;s.augment(k,{cd:function(f,d){if(typeof d!="number")d=10;p(this.c.fc,f.fc,d);p(this.c.Zb,f.Zb,d);H(this.c.elements,
f.elements,d);H(this.c.attributes,f.attributes,d);this.c.text=C(this.c.text,f.text,d)||this.c.text;this.c.N=C(this.c.N,f.N,d)||this.c.N;this.c.zb=C(this.c.zb,f.zb,d)||this.c.zb},Md:function(f){return y(f,this.c.fc)},Kd:function(f){return y(f,this.c.Zb)},ma:function(f){var d=this.c.text;return d?d.filter(f):f},Ra:function(f,d){var i=this.c.N;return i?i.filter(f,d):f},Nd:function(f){var d=this.c.zb;return d?d.filter(f):f},uc:function(f){for(var d=[this.c.elements["^"],this.c.elements[f.name],this.c.elements.Pf],
i,t=0;t<3;t++)if(i=d[t]){i=i.filter(f,this);if(i===e)return T;if(i&&i!=f)return this.Od(i);if(f.parent&&!f.name)break}return f},Od:function(f){var d=f.type;return d==m.e?this.uc(f):d==m.f?new q.j.Mb(this.ma(f.value)):T},Jd:function(f,d,i){if(d=this.c.attributes[d]){f=d.filter(i,f,this);if(f===e)return e;if(typeof f!="undefined")return f}return i}});q.j.Xf=k;s=k.prototype;q.k.o(s,{addRules:s.cd,onElementName:s.Md,onAttributeName:s.Kd,onText:s.ma,onComment:s.Ra,onFragment:s.Nd,onElement:s.uc,onNode:s.Od,
onAttribute:s.Jd});q.j.Filter=k});KISSY.Editor.add("htmlparser-text",function(){function k(C){this.value=C;this.c={S:H}}var y=KISSY,p=y.Editor,H=X;y.augment(k,{type:p.n.f,ba:function(C,A){var s=this.value;A&&!(s=A.ma(s,this))||C.text(s)}});p.j.Mb=k;p.j.Text=k});
KISSY.Editor.add("htmlparser-comment",function(){function k(H){this.value=H;this.c={S:X}}var y=KISSY.Editor,p=y.n;y.j.$d=k;y.j.Comment=k;k.prototype={constructor:k,type:p.ce,ba:function(H,C){var A=this.value;if(C){if(!(A=C.Ra(A,this)))return;if(typeof A!="string"){A.parent=this.parent;A.ba(H,C);return}}H.N(A)}}});
KISSY.Editor.add("button",function(){var k=KISSY,y=k.Editor;if(y.je)k.log("TripleButton attach twice","warn");else{k=k.UIBase.create([k.UIBase.Box],{Dg:function(){var p=this,H=p.get("el");H.on("click",p.ue,p);H.on("mousedown",function(){p.get("state")=="off"&&H.addClass("ke-triplebutton-active")});H.on("mouseup mouseleave",function(){p.get("state")=="off"&&H.hasClass("ke-triplebutton-active")&&setTimeout(function(){H.removeClass("ke-triplebutton-active")},300)})},xg:function(){this.get("el").attr("title",
this.get("title"))},ug:function(p){var H=this.get("el");if(p!==undefined){H.html("<span class='ke-toolbar-item "+p+"'>");H.ta()}},wg:function(p){var H=this.get("el");p!==undefined&&H.html(p)},vg:function(p){this["_"+p]()},nd:function(){this.Ce=this.get("state");this.set("state","disabled")},pd:function(){this.get("state")=="disabled"&&this.set("state",this.Ce)},ue:function(p){this.fire(this.get("state")+"Click",{mg:p});this.fire("click",{lg:this.get("state")+"Click"});p&&p.halt()},Fg:function(){this.set("state",
"on")},Eg:function(){this.set("state","off")},sg:function(){var p=this.get("el");p.removeClass("ke-triplebutton-off ke-triplebutton-disabled");p.addClass("ke-triplebutton-on")},rg:function(){var p=this.get("el");p.removeClass("ke-triplebutton-on ke-triplebutton-disabled");p.addClass("ke-triplebutton-off")},og:function(){var p=this.get("el");p.removeClass("ke-triplebutton-off ke-triplebutton-on");p.addClass("ke-triplebutton-disabled")}},{Zd:{If:{value:"off"},df:{value:"ke-triplebutton ke-triplebutton-off"},
Pg:{value:{hideFocus:S,tabIndex:-1}},Qg:{value:"a"},title:{},Gg:{},text:{}}});k.eg="on";k.cg="off";k.ae="disabled";k.fg="ke-triplebutton-on";k.dg="ke-triplebutton-off";k.Vf="ke-triplebutton-disabled";y.je=k}});
KISSY.Editor.add("select",function(){function k(e){k.superclass.constructor.call(this,e);this.xe()}var y=KISSY,p=y.Node,H=y.Event,C=y.DOM,A=y.Editor;if(A.he)y.log("ke select attach more");else{k.ae=0;k.Wf=1;var s=A.m;k.Zd={fh:{},P:{},Ve:{},xa:{},Ng:{},value:{},width:{},title:{},uf:{},Sg:{},align:{value:["l","b"]},Yg:{lh:function(){for(var e=this.P.parent();e;){var f=e.d();if(s[f]&&s[f].div)return e;e=e.parent()}return new p(document.body)}},If:{value:1}};k.Kg=function(e){for(var f=e.width(),d=[],
i=e.all("option"),t=0;t<i.length;t++){var j=i[t];d.push({name:C.html(j),value:C.attr(j,"value")})}return new k({width:f+"px",P:e,uf:d,Ve:"ke-combox",value:e.val()})};var q=A.k.Je,m=A.k.Ze;y.extend(k,y.Base,{xe:function(){var e=this.get("container"),f=this.get("el"),d=new p("<span class='ke-select-wrap'><a onclick='return false;' class='ke-select'><span class='ke-select-text'><span class='ke-select-text-inner'></span></span><span class='ke-select-drop-wrap'><span class='ke-select-drop'></span></span></a></span>"),
i=this.get("title")||"",t=this.get("cls"),j=d.one(".ke-select-text"),a=d.one(".ke-select-text-inner");d.one(".ke-select-drop");this.get("value")!==undefined?a.html(this.Wc(this.get("value"))):a.html(i);j.css("width",this.get("width"));d.ta();i&&d.attr("title",i);t&&d.addClass(t);if(f)f[0].parentNode.replaceChild(d[0],f[0]);else e&&d.appendTo(e);d.on("click",this.we,this);this.P=d;this.title=a;this.Xc=d.one("a.ke-select");A.k.Gd(this,"_prepare","_real");this.on("afterValueChange",this.Fe,this);this.on("afterStateChange",
this.Ee,this)},Wc:function(e){var f=this.get("title")||"",d=this.get("items");if(this.get("showValue"))return e||f;for(var i=0;i<d.length;i++){var t=d[i];if(t.value==e){f=t.name;break}}return f},Fe:function(e){this.title.html(this.Wc(e.tb))},Yc:function(e){var f;f=e.tb;e=this.ad;e.html("");if(f&&f.length)for(var d=0;d<f.length;d++){var i=f[d];(new p("<a class='ke-select-menu-item' href='#' data-value='"+i.value+"'>"+i.name+"</a>",i.Ne)).appendTo(e).ta()}else if(f=this.get("emptyText"))(new p("<a class='ke-select-menu-item' href='#'>"+
f+"</a>")).appendTo(e).ta();this.Yb=e.all("a")},val:function(e){if(e!==undefined){this.set("value",e);return this}else return this.get("value")},$c:function(){this.T.get("visible")&&this.Be()},ye:function(){function e(b){b=new p(b.target);d.contains(b)||d.g(b)||j.hide()}var f=this,d=f.P,i=f.get("popUpWidth"),t=f.Xc,j=new A.de({Bg:S,eh:f.get("menuContainer"),content:"<div>",Tg:X,df:"ke-menu",width:i?i:d.width(),zIndex:A.$b(A.Dc.fe),Ug:X}),a=f.get("items");q.call(f,j);i=j.get("contentEl").one("div");
f.T=j;H.on(window,"resize",f.$c,f);q.call(f,function(){H.remove(window,"resize",f.$c,f)});f.get("title")&&(new p("<div class='ke-menu-title ke-select-menu-item' style='margin-top:-6px;' >"+f.get("title")+"</div>")).appendTo(i);f.ad=(new p("<div>")).appendTo(i);f.Yc({tb:a});j.on("show",function(){t.addClass("ke-select-active")});j.on("hide",function(){t.removeClass("ke-select-active")});H.on(document,"click",e);q.call(f,function(){H.remove(document,"click",e)});f.get("doc")&&H.on(f.get("doc"),"click",
e);i.on("click",f.De,f);f.Yb=f.ad.all("a");H.on(i[0],"mouseenter",function(){f.Yb.removeClass("ke-menu-selected")});q.call(f,i);f.on("afterItemsChange",f.Yc,f);f.yf=i},Ee:function(e){var f=this.P;e.tb==1?f.removeClass("ke-select-disabled"):f.addClass("ke-select-disabled")},pd:function(){this.set("state",1)},nd:function(){this.set("state",0)},De:function(e){e&&e.halt();var f=this.T,d=this.yf;if((e=(new p(e.target)).Oc(function(j){return d.contains(j)&&j.d()=="a"},S))&&e.Rb("data-value")){var i=this.get("value"),
t=e.attr("data-value");this.set("value",t);this.fire("click",{tb:t,$g:i,name:e.html()});f.hide()}},Be:function(){var e=this.P,f=e.offset(),d=y.clone(f),i=this.T.get("el").height(),t=this.T.get("el").width(),j=C.scrollTop(),a=C.scrollLeft(),b=C.viewportHeight(),g=C.viewportWidth();g=a+g-60;b=j+b;var o=f.top+(e.height()-2);e=f.left+e.width()-2;var z=this.get("align"),B=z[0];if(z[1]=="b"){f.top=o;if(f.top+i>b&&d.top-j>b-o)f.top=d.top-i}else{f.top=d.top-i;if(f.top<j&&d.top-j<b-o)f.top=o}if(B=="l"){if(f.left+
t>g&&e-a>g-d.left)f.left=e-t}else{f.left=e-t;if(f.left<a&&e-a<g-d.left)f.left=d.left}this.T.set("xy",[f.left,f.top]);this.T.show()},we:function(e){if(!this.sc){e&&e.halt();var f=this;e=f.P;var d=f.get("value");if(!e.hasClass("ke-select-disabled"))if(f.Xc.hasClass("ke-select-active"))f.T&&f.T.hide();else{f.sc=S;A.use("overlay",function(){f.sc=X;f.ye();d&&f.T&&f.Yb.each(function(i){i.attr("data-value")==d?i.addClass("ke-menu-selected"):i.removeClass("ke-menu-selected")})})}}},za:function(){m.call(this);
this.P.detach();this.P.remove()}});A.he=k}});
