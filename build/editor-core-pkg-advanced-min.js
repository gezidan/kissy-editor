/*
 Constructor for kissy editor,dependency moved to independent module
 thanks to CKSource's intelligent work on CKEditor
 @author: yiminghe@gmail.com, lifesinger@gmail.com
 @version: 2.1.5
 @buildtime: 2011-01-05 18:09:51
*/
var T=true,U=null,X=false;
KISSY.add("editor",function(m){function w(t,s){var q=this;if(!(q instanceof w))return new w(t,s);if(m.isString(t))t=m.one(t);t=I.D(t);s=s||{};s.Af=s.pluginConfig||{};q.ua=s;s.pluginConfig=s.Af;q.cfg=s;m.app(q,m.EventTarget);var g=["htmldataprocessor","enterkey","clipboard"],f=y;q.use=function(d,l){d=d.split(",");if(!f)for(var B=0;B<g.length;B++){var i=g[B];m.inArray(i,d)||d.unshift(i)}q.ready(function(){m.use.call(q,d.join(","),function(){for(var a=0;a<d.length;a++)q.Xd(d[a]);l&&l.call(q);if(!f){q.setData(t.val());
if(s.focus)q.focus();else(a=q.getSelection())&&a.removeAllRanges();f=A}},{global:w})});return q};q.use=q.use;q.Config.base=w.Config.base;q.Config.debug=w.Config.debug;q.Config.componentJsName=r;q.qf(t);return q}function r(){return"plugin-min.js?t=2011-01-05 18:09:51"}var I=m.DOM,A=T,y=X;m.app(w,m.EventTarget);w.Config.base=m.Config.base+"editor/plugins/";w.Config.debug=m.Config.debug;w.Config.componentJsName=r;m.Editor=w;m.Editor=w});
KISSY.Editor.add("utils",function(m){var w=U,r=KISSY,I=r.Node,A=r.DOM,y=r.UA,t=r.Event,s;if(y.ie)s=document.documentMode||y.ie;var q={md:function(g){g=g.replace(/-min\.(js|css)/i,".$1");m.Config.Ig||(g=g.replace(/\.(js|css)/i,"-min.$1"));if(g.indexOf("?t")==-1){g+=g.indexOf("?")!=-1?"&":"?";g+="t=2011-01-05 18:09:51"}return m.Config.Cg+g},Gd:function(g,f,d){var l=g[f],B=g[d];g[f]=function(){l.apply(this,arguments);g[f]=g[d];return B.apply(this,arguments)}},mf:function(g,f,d,l){d=d.defaultView||d.parentWindow;
g-=A.scrollLeft(d);f-=A.scrollTop(d);if(l)if(d!=(l.defaultView||l.parentWindow)&&d.frameElement){l=A.Pb(d.frameElement,l);g+=l.left;f+=l.top}return{left:g,top:f}},Wd:function(){for(var g,f=0,d=arguments.length;f<d;f++){var l=arguments[f];try{g=l();break}catch(B){}}return g},Me:function(g,f){if(!g&&!f)return T;if(!g||!f||g.length!=f.length)return X;for(var d=0;d<g.length;d++)if(g[d]!==f[d])return X;return T},ud:function(g,f,d){g=g.documentElement;for(var l=0;g&&l<f.length;l++){var B=f[l];if(d)for(var i=
-1,a=0;a<g.childNodes.length;a++){var b=g.childNodes[a];if(!(d===T&&b.nodeType==3&&b.previousSibling&&b.previousSibling.nodeType==3)){i++;if(i==B){g=b;break}}}else g=g.childNodes[B]}return g?new I(g):w},Ue:function(g){for(var f in g)g[f].Oc(g,T)},nc:function(g){return g.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/,"&gt;")},Qa:function(g){return g.replace(/^\s+/,"")},Sa:function(g){return g.replace(/\s+$/,"")},trim:function(g){return this.Qa(this.Sa(g))},mix:function(){for(var g={},f=0;f<
arguments.length;f++)g=r.mix(g,arguments[f]);return g},qb:function(){if(!y.ie)return X;var g=document.domain,f=window.location.hostname;return g!=f&&g!="["+f+"]"},af:function(g,f){return Array(f+1).join(g)},Kf:function(g,f,d){d=d||150;if(d===-1)return function(){g.apply(f,arguments)};var l=(new Date).getTime();return function(){var B=(new Date).getTime();if(B-l>d){l=B;g.apply(f,arguments)}}},Qe:function(g,f,d){d=d||0;var l=w;return function(){l&&clearTimeout(l);var B=arguments;l=setTimeout(function(){return g.apply(f,
B)},d)}},isNumber:function(g){return/^\d+(.\d+)?$/.test(r.trim(g))},Mf:function(g){for(var f=0;f<g.length;f++){var d=A.D(g[f]),l=r.trim(d.val()),B=d.attr("data-verify");d=d.attr("data-warning");if(B&&!RegExp(B).test(l)){alert(d);return X}}return T},Hf:function(g,f){g.on("sourcemode",f.nd,f);g.on("wysiwygmode",f.pd,f)},Df:function(g){var f=g.attr("placeholder");if(f&&!y.webkit){g.addClass("ke-input-tip");g.val(f)}else y.webkit&&g.val("")},gh:function(g,f){g.removeClass("ke-input-tip");g.val(f)},zf:function(g,
f){g.attr("placeholder",f);if(!y.webkit){g.on("blur",function(){if(!r.trim(g.val())){g.addClass("ke-input-tip");g.val(f)}});g.on("focus",function(){g.removeClass("ke-input-tip");r.trim(g.val())==f&&g.val("")})}},Te:function(g){g=g[0]||g;for(var f=r.makeArray(g.childNodes),d=0;d<f.length;d++){var l=f[d];l.nodeType==m.n.f&&!r.trim(l.nodeValue)&&g.removeChild(l)}},pf:function(g){return!g?g:String(g).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},of:function(g){return!g?
g:String(g).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},ef:function(g,f){return g.toLowerCase()==f.toLowerCase()},Hd:function(g){g=r.clone(g);for(var f in g)if(g.hasOwnProperty(f)){var d=g[f];if(r.isFunction(d))g[f]=d()}return g},$e:function(g,f,d){function l(){var C={responseText:"",responseXML:w};C.Le=g?g.Le:w;try{var o;if((o=y.ie?i.contentWindow.document:i.contentDocument||window.frames[B].document)&&o.body)C.responseText=o.body.innerHTML;C.responseXML=
o&&o.XMLDocument?o.XMLDocument:o}catch(D){r.log(D)}t.remove(i,"load",l);g.Re&&g.Re(C);setTimeout(function(){A.h(i)},100)}var B=r.guid("form-upload-"),i=document.createElement("iframe");i.id=B;i.name=B;i.className="ke-hidden";var a="document.open();"+(q.qb()?'document.domain="'+document.domain+'";':"")+"document.close();";if(y.ie)i.src=y.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";r.log("doFormUpload : "+i.src);document.body.appendChild(i);if(y.ie)document.frames[B].name=B;a=A.Vc(g.form);
var b={target:a.target,method:a.method,encoding:a.encoding,enctype:a.enctype,action:a.action};a.target=B;a.method="POST";a.enctype=a.encoding="multipart/form-data";if(d)a.action=d;var e;if(f){e=[];f=m.k.Hd(f);for(var j in f)if(f.hasOwnProperty(j)){d=document.createElement("input");d.type="hidden";d.name=j;d.value=f[j];a.appendChild(d);e.push(d)}}t.on(i,"load",l);a.submit();a.target=b.target;a.method=b.method;a.enctype=b.enctype;a.encoding=b.encoding;a.action=b.action;if(e){f=0;for(j=e.length;f<j;f++)A.h(e[f])}return i},
o:function(g,f){for(var d in f)g[d]=f[d]},map:function(g,f){for(var d=0;d<g.length;d++)g[d]=f(g[d]);return g},Oa:s,Bf:function(g){y.ie?g.Ka():g.attr("onmousedown","return false;")},Sg:function(g){g=g.attributes;return g.type=="application/x-shockwave-flash"||/\.swf(?:$|\?)/i.test(g.src||"")},Je:function(){var g=this.ib=this.ib||[];g.push.apply(g,r.makeArray(arguments))},Ze:function(){for(var g=this.ib||[],f=0;f<g.length;f++){var d=g[f];if(r.isFunction(d))d();else{d.detach&&d.detach();d.ya&&d.ya();
d.nodeType&&d.remove&&d.remove()}}this.ib=[]}};m.k=q;m.Utils=q;y.Oa=q.Oa;q.o(q,{debugUrl:q.md,lazyRun:q.Gd,getXY:q.mf,tryThese:q.Wd,arrayCompare:q.Me,getByAddress:q.ud,clearAllMarkers:q.Ue,htmlEncodeAttr:q.nc,ltrim:q.Qa,rtrim:q.Sa,trim:q.trim,mix:q.mix,isCustomDomain:q.qb,duplicateStr:q.af,buffer:q.Qe,isNumber:q.isNumber,verifyInputs:q.Mf,sourceDisable:q.Hf,resetInput:q.Df,placeholder:q.zf,clean:q.Te,htmlEncode:q.pf,htmlDecode:q.of,equalsIgnoreCase:q.ef,normParams:q.Hd,throttle:q.Kf,doFormUpload:q.$e,
map:q.map})});
KISSY.Editor.add("dom",function(m){function w(a){if(a&&!a[0])return new s(a);return a}function r(a){return a[0]||a}function I(a){return a.replace(/-(\w)/g,function(b,e){return e.toUpperCase()})}var A=KISSY,y=A.DOM,t=A.UA,s=A.Node,q=m.k,g={abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1};m.n={e:1,f:3,ce:8,bg:11};m.NODE=m.n;m.$a={ea:0,ee:1,da:2,$:4,Z:8,Jc:16};m.POSITION=
m.$a;var f=m.n,d=m.$a,l={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},B={hr:1},i={D:w,Vc:r,g:function(a,b){if(!a&&!b)return T;if(!a||!b)return X;a=r(a);b=r(b);return a===b},qa:function(a,b){a=w(a);var e=A.mix(A.mix({},B),b||{});return l[a.css("display")]||e[a.d()]},ga:function(a){return a&&"scrollTo"in a&&a.document?a:a&&a.nodeType===9?a.defaultView||a.parentWindow:
X},v:function(a){a=r(a);for(var b=a.parentNode.childNodes,e=0;e<b.length;e++)if(b[e]===a)return e;return-1},le:function(a,b){a=r(a);var e=a.firstChild;if((e=e&&new s(e))&&b&&!b(e))e=e.Ia(b);return e},Tc:function(a,b,e){a=r(a);y.h(a);b=r(b);e?b.insertBefore(a,b.firstChild):b.appendChild(a)},d:function(a){a=r(a);var b=a.nodeName.toLowerCase();if(t.ie)if((a=a.scopeName)&&a!="HTML")b=a.toLowerCase()+":"+b;return b},Rc:function(a,b){if(a.d()!=b.d())return X;var e=a[0].attributes,j=b[0].attributes,C=e.length,
o=j.length;if(C!=o)return X;for(var D=0;D<C;D++){var k=e[D],v=k.name;if(k.specified&&a.attr(v)!=b.attr(v))return X}if(q.Oa<8)for(D=0;D<o;D++){k=j[D];v=k.name;if(k.specified&&a.attr(v)!=b.attr(v))return X}return T},Qb:function(a){a=r(a).childNodes;for(var b=0,e=a.length;b<e;b++){var j=a[b],C=j.nodeType;if(!(C==f.e&&j.getAttribute("_ke_bookmark")))if(C==f.e&&!i.Qb(j)||C==f.f&&A.trim(j.nodeValue))return X}return T},Rb:function(a,b,e){a=r(a);b=b[0]||b;if(a!=b)if(e)for(;e=a.lastChild;)b.insertBefore(a.removeChild(e),
b.firstChild);else for(;e=a.firstChild;)b.appendChild(a.removeChild(e))},ra:function(){function a(b,e,j){if(e[0]&&e[0].nodeType==f.e){for(var C=[];e.attr("_ke_bookmark")||e.Qb();){C.push(e);e=j?new s(e[0].nextSibling):new s(e[0].previousSibling);if(!e[0]||e[0].nodeType!=f.e)return}if(b.Rc(e)){for(var o=j?b[0].lastChild:b[0].firstChild;C.length;)C.shift().Tc(b,!j);e.Rb(b,!j);e.h();o[0]&&o[0].nodeType==f.e&&o.ra()}}}return function(b){if(b[0])if(g[b.d()]||b.d()=="a"){a(b,new s(b[0].nextSibling),T);
a(b,new s(b[0].previousSibling))}}}(),Ka:t.gecko?function(a){a=r(a);a.style.MozUserSelect="none"}:t.webkit?function(a){a=r(a);a.style.Zf="none"}:function(a){a=r(a);if(t.ie||t.opera){var b=0;a.setAttribute("unselectable","on");for(var e=a.getElementsByTagName("*");a=e[b++];)switch(a.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:a.setAttribute("unselectable","on")}}},Pb:function(a,b){a=r(a);var e,j=0;e=0;var C=a.ownerDocument.defaultView||a.ownerDocument.parentWindow,
o=a.ownerDocument,D=o.documentElement;b=b||o;if(a.getBoundingClientRect){if(a!==o.body&&D!==a){e=a.getBoundingClientRect();j=e.left+(b===o?y.scrollLeft(C):0);e=e.top+(b===o?y.scrollTop(C):0)}if(b)if(C!=(b.defaultView||b.parentWindow)&&C.frameElement){C=i.Pb(C.frameElement,b);j+=C.left;e+=C.top}}return{left:j,top:e}},ne:function(a){return(a=r(a))&&a.contentWindow.document},ia:function(a,b){a=r(a);var e=a.ownerDocument;if(!(!a||a.nodeType!=f.f)){if(t.ie&&b==a.nodeValue.length){var j=e.createTextNode("");
y.insertAfter(j,a);return new s(j)}j=new s(a.splitText(b));if(e.documentMode){e=e.createTextNode("");y.insertAfter(e,j[0]);y.h(e)}return j}},Sb:function(a,b){a=w(a);var e=[];do e[b?"push":"unshift"](a);while(a=a.parent());return e},K:function(a,b,e){a=r(a);a=a.cloneNode(b);if(!e){var j=function(C){if(C.nodeType==f.e){C.removeAttribute("id");C=C.childNodes;for(var o=0;o<C.length;o++)j(C[o])}};j(a)}return new s(a)},w:function(a,b,e,j){a=r(a);if(j&&!j.call){var C=j[0]||j;j=function(D){D=D[0]||D;return D!==
C}}b=!b&&a.firstChild;var o=new s(a);if(!b){if(a.nodeType==f.e&&j&&j(a,T)===X)return U;b=a.nextSibling}for(;!b&&(o=o.parent());){if(j&&j(o,T)===X)return U;b=o[0].nextSibling}if(!b)return U;b=y.D(b);if(j&&j(b)===X)return U;if(e&&e!=b[0].nodeType)return b.w(X,e,j);return b},ha:function(a,b,e,j){a=r(a);if(j&&!j.call){var C=j[0]||j;j=function(D){D=D[0]||D;return D!==C}}b=!b&&a.lastChild;var o=new s(a);if(!b){if(a.nodeType==f.e&&j&&j(a,T)===X)return U;b=a.previousSibling}for(;!b&&(o=o.parent());){if(j&&
j(o,T)===X)return U;b=o[0].previousSibling}if(!b)return U;b=y.D(b);if(j&&j(b)===X)return U;if(e&&b[0].nodeType!=e)return b.ha(X,e,j);return b},Ob:function(a,b){if(a.g(b))return a;if(b[0].nodeType!=f.f&&b.contains(a))return b;var e=a[0].nodeType==f.f?a.parent():a;do if(e[0].nodeType!=f.f&&e.contains(b))return e;while(e=e.parent());return U},Nc:function(a,b,e){a=r(a);if(!e)a=a.parentNode;if(b&&!A.isFunction(b)){var j=b;b=function(C){return C.d()==j}}for(;a&&a.nodeType!=9;){if(!b||b(new s(a))===T)return new s(a);
a=a.parentNode}return U},Pc:q.Oa<9?function(a,b){a=r(a);var e=a.attributes[b];return!!(e&&e.specified)}:function(a,b){a=r(a);return a.hasAttribute(b)},eb:q.Oa<9?function(a){a=r(a);for(var b=a.attributes,e=0;e<b.length;e++){var j=b[e];switch(j.name){case "class":if(a.getAttribute("class"))return T;break;default:if(j.specified)return T}}return X}:function(a){a=r(a);t.gecko&&a.removeAttribute("_moz_dirty");return a.hasAttributes()},Ja:function(a,b){var e=r(a),j=r(b);if(e.compareDocumentPosition)return e.compareDocumentPosition(j);
if(e==j)return d.ea;if(e.nodeType==f.e&&j.nodeType==f.e){if(e.contains){if(e.contains(j))return d.Jc+d.$;if(j.contains(e))return d.Z+d.da}if("sourceIndex"in e)return e.sourceIndex<0||j.sourceIndex<0?d.ee:e.sourceIndex<j.sourceIndex?d.$:d.da}e=a.Ha();j=b.Ha();for(var C=Math.min(e.length,j.length),o=0;o<=C-1;o++)if(e[o]!=j[o]){if(o<C)return e[o]<j[o]?d.$:d.da;break}return e.length<j.length?d.Jc+d.$:d.Z+d.da},Ha:function(a,b){a=r(a);for(var e=[],j=a.ownerDocument.documentElement,C=a;C&&C!=j;){var o=
C.parentNode,D=-1;if(o){for(var k=0;k<o.childNodes.length;k++){var v=o.childNodes[k];if(!(b&&v.nodeType==3&&v.previousSibling&&v.previousSibling.nodeType==3)){D++;if(v==C)break}}e.unshift(D)}C=o}return e},Nb:function(a,b){var e=new m.Range(a[0].ownerDocument);e.setStartAfter(a);e.setEndAfter(b);var j=e.extractContents();e.insertNode(a.h());a[0].parentNode.insertBefore(j,a[0].nextSibling)},L:function(a,b,e){a=w(a);if(e!==undefined)return a.css(b,e);a=r(a);return a.style[I(b)]},h:function(a,b){var e=
r(a),j=e.parentNode;if(j){if(b)for(var C;C=e.firstChild;)j.insertBefore(e.removeChild(C),e);j.removeChild(e)}return a},gb:function(a){y.Sc(a);y.Uc(a)},Sc:function(a){a=r(a);for(var b;b=a.firstChild;){if(b.nodeType==f.f){var e=q.Qa(b.nodeValue),j=b.nodeValue.length;if(e){if(e.length<j){(new s(b)).ia(j-e.length);a.removeChild(a.firstChild)}}else{a.removeChild(b);continue}}break}},Uc:function(a){a=r(a);for(var b;b=a.lastChild;){if(b.type==f.f){var e=q.Sa(b.nodeValue),j=b.nodeValue.length;if(e){if(e.length<
j){(new s(b)).ia(e.length);a.removeChild(a.lastChild)}}else{a.removeChild(b);continue}}break}if(!t.ie&&!t.opera)(b=a.lastChild)&&b.nodeType==1&&b.nodeName.toLowerCase()=="br"&&b.parentNode.removeChild(b)},Mb:function(a){a=r(a);for(var b=a.lastChild;b&&b.nodeType==f.f&&!A.trim(b.nodeValue);)b=b.previousSibling;if(!b||b.nodeType==f.f||y.d(b)!=="br"){b=t.opera?a.ownerDocument.createTextNode(""):a.ownerDocument.createElement("br");t.gecko&&b.setAttribute("type","_moz");a.appendChild(b)}},sa:function(a,
b){var e=r(a),j;do j=(e=e.previousSibling)&&new s(e);while(j&&b&&!b(j));return j},pe:function(a,b){a=y.D(a);var e=a[0].lastChild;if((e=e&&new s(e))&&b&&!b(e))e=e.sa(b);return e},Ia:function(a,b){var e=r(a),j;do j=(e=e.nextSibling)&&new s(e);while(j&&b&&!b(j));return j},fb:function(a){a=r(a);if(a.outerHTML)return a.outerHTML.replace(/<\?[^>]*>/,"");var b=a.ownerDocument.createElement("div");b.appendChild(a.cloneNode(T));return b.innerHTML},qe:function(a,b,e,j){a=y.D(a);var C=a.data("list_marker_id")||
a.data("list_marker_id",A.guid()).data("list_marker_id"),o=a.data("list_marker_names")||a.data("list_marker_names",{}).data("list_marker_names");b[C]=a;o[e]=1;return a.data(e,j)},Oc:function(a,b,e){a=w(a);var j=a.data("list_marker_names"),C=a.data("list_marker_id"),o;for(o in j)a.removeData(o);a.removeData("list_marker_names");if(e){a.removeData("list_marker_id");delete b[C]}},ke:function(a,b,e){a=r(a);b=w(b);var j=a.attributes;e=e||{};for(var C=0;C<j.length;C++){var o=j[C],D=o.name.toLowerCase(),
k;if(!(D in e))if(D=="checked"&&(k=y.attr(a,D)))b.attr(D,k);else if(o.specified||t.ie&&o.value&&D=="value"){k=y.attr(a,D);if(k===U)k=o.nodeValue;b.attr(D,k)}}if(a.style.cssText!=="")b[0].style.cssText=a.style.cssText},Qc:function(a){a=y.d(a);var b=m.m;return(a=!b.Gc[a]&&(b[a]||b.span))&&a["#"]},Tb:function(a){a=w(a);var b=a[0].ownerDocument,e=y.scrollLeft(b),j=y.scrollTop(b),C=a.offset(),o=C.left;C=C.top;if(y.viewportHeight(b)+j<C||C<j||y.viewportWidth(b)+e<o||o<e)a.scrollIntoView(b)},me:function(a,
b,e){a=r(a);if(!t.ie&&e)b=e+":"+b;e=[];a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)e.push(new s(a[b]));return e}};A.DOM.oe=function(a){A.mix(y,a);for(var b in a)a.hasOwnProperty(b)&&function(e){s.prototype[e]=function(){var j=[].slice.call(arguments,0);j.unshift(this);return a[e].apply(U,j)}}(b)};q.o(i,{_4e_wrap:i.D,_4e_unwrap:i.Vc,_4e_equals:i.g,_4e_isBlockBoundary:i.qa,_4e_getWin:i.ga,_4e_index:i.v,_4e_first:i.le,_4e_move:i.Tc,_4e_name:i.d,_4e_isIdentical:i.Rc,_4e_isEmptyInlineRemoveable:i.Qb,
_4e_moveChildren:i.Rb,_4e_mergeSiblings:i.ra,_4e_unselectable:i.Ka,_4e_getOffset:i.Pb,_4e_getFrameDocument:i.ne,_4e_splitText:i.ia,_4e_parents:i.Sb,_4e_clone:i.K,_4e_nextSourceNode:i.w,_4e_previousSourceNode:i.ha,_4e_commonAncestor:i.Ob,_4e_ascendant:i.Nc,_4e_hasAttribute:i.Pc,_4e_hasAttributes:i.eb,_4e_position:i.Ja,_4e_address:i.Ha,_4e_breakParent:i.Nb,_4e_style:i.L,_4e_remove:i.h,_4e_trim:i.gb,_4e_ltrim:i.Sc,_4e_rtrim:i.Uc,_4e_appendBogus:i.Mb,_4e_last:i.pe,_4e_previous:i.sa,_4e_next:i.Ia,_4e_outerHtml:i.fb,
_4e_setMarker:i.qe,_4e_clearMarkers:i.Oc,_4e_getUniqueId:i.ng,_4e_copyAttributes:i.ke,_4e_isEditable:i.Qc,_4e_scrollIntoView:i.Tb,_4e_getElementsByTagName:i.me});y.oe(i)});
KISSY.Editor.add("focusmanager",function(m){function w(){this.oc=q;s=this}function r(){this.oc=g;s=f}var I=KISSY,A=I.DOM,y=I.Event,t={},s;I={Yg:function(){for(var d in t){var l=t[d];l.document.designMode="off";l.document.designMode="on"}},Hg:function(){return s},hf:function(d){return t[d]},add:function(d){var l=A.ga(d.document);y.on(l,"focus",w,d);y.on(l,"blur",r,d)},Cf:function(d){t[d.Ub]=d},remove:function(d){delete t[d.Ub];var l=A.ga(d.document);y.remove(l,"focus",w,d);y.remove(l,"blur",r,d)}};
var q=T,g=X,f=U;m.rd=I;m.focusManager=I;m.jf=function(){return t};m.getInstances=m.jf});
KISSY.Editor.add("definition",function(m){var w=T,r=X,I=m.k,A=document,y=KISSY,t=y.UA,s=y.DOM,q=y.Node,g=!window.getSelection,f=y.Event,d=m.rd,l=I.Wd,B=1,i="document.open();"+(I.qb()?'document.domain="'+A.domain+'";':"")+"document.close();",a="<div  class='ke-editor-wrap'  > <div class='"+".ke-editor-tools".substring(1)+"' ></div><div class='"+".ke-textarea-wrap".substring(1)+'\'><iframe  style="width:100%;height:100%;border:none;"  width="100%"  height="100%"  frameborder="0"  title="kissy-editor"  src="'+(t.ie?
"javascript:void(function(){"+encodeURIComponent(i)+"}())":"")+'"  tabIndex="'+(t.webkit?-1:"$(tabIndex)")+'"  allowTransparency="true" ></iframe></div><div class=\''+".ke-editor-status".substring(1)+"'></div></div>";m.Lc=0;m.db=1;m.SOURCE_MODE=m.Lc;m.WYSIWYG_MODE=m.db;y.augment(m,{qf:function(b){var e=this;e.hb={};e.La={};e.ta={};t.ie&&s.addClass(A.body,"ke-ie"+t.ie);if(t.trident)s.addClass(A.body,"ke-trident"+t.trident);else if(t.gecko)s.addClass(A.body,"ke-gecko");else t.webkit&&s.addClass(A.body,
"ke-webkit");var j=new q(a.replace(/\$\(tabIndex\)/,b.attr("tabIndex")));e.cf=j;e.Ub=B++;d.Cf(e);e.Wa=j.one(".ke-textarea-wrap");e.wrap=e.Wa;e.Aa=e.Wa.one("iframe");e.iframe=e.Aa;e.Vd=j.one(".ke-editor-tools");e.toolBarDiv=e.Vd;e.W=b;e.textarea=e.W;e.Jf=j.one(".ke-editor-status");e.statusDiv=e.Jf;I.Bf(e.Vd);var C=b.L("width"),o=b.L("height");if(C){j.css("width",C);b.css("width","100%")}e.W.css("display","none");j.insertAfter(b);e.Wa[0].appendChild(b[0]);if(o){e.Wa.css("height",o);b.css("height","100%")}j=
e.Aa;e.on("dataReady",function(){e.Ae=w;m.fire("instanceCreated",{bf:e})});t.gecko?j.on("load",e.bd,e):e.bd();e.ua.attachForm&&b[0].form&&e.ve()},ya:function(){if(!this.te){var b=this.cf,e=this.W,j=this.document,C=this.Aa[0].contentWindow;this.Bb();m.rd.remove(this);f.remove(j);f.remove(j.documentElement);f.remove(j.body);f.remove(C);this.Aa.detach();j=this.ta;for(var o in j)if(j.hasOwnProperty(o)){C=j[o];C.ya&&C.ya()}this.fire("destroy");e.insertBefore(b);b.remove();e.css({width:b.css("width"),height:this.Wa.css("height")});
e.show();this.hb=this.La=this.ta=U;this.detach();this.te=T}},ve:function(){var b=this,e=new q(b.W[0].form);e.on("submit",b.Bb,b);b.on("destroy",function(){e.detach("submit",b.Bb,b)})},Lf:function(b,e){var j=this,C=m.de;C&&C.qc();j.use(b,function(){var o=j.vd(b);if(o){e(o);C&&C.fh()}else y.later(arguments.callee,50,X,j)})},Ie:function(b,e){this.La[b]=e},vd:function(b){return this.La[b]},Kg:function(b){var e=this.La[b];e&&e.ya();this.La[b]=U},Ge:function(b,e){this.hb[b]=e},nf:function(b){return this.hb[b]},
execCommand:function(b){var e=this.hb[b],j=y.makeArray(arguments);j.shift();j.unshift(this);return e.exec.apply(e,j)},jc:function(){return this.W.css("display")=="none"?m.db:m.Lc},getData:function(b){var e;e=this.jc()==m.db?this.document&&this.document.body?this.document.body.innerHTML:"":this.W.val();if(this.htmlDataProcessor)e=b?this.htmlDataProcessor.toHtml(e,"p"):this.htmlDataProcessor.toServer(e,"p");e=y.trim(e);if(/^<p>((&nbsp;)|\s)*<\/p>$/.test(e))e="";return e},setData:function(b){var e=b;
if(this.htmlDataProcessor)e=this.htmlDataProcessor.toDataFormat(b,"p");this.document.body.innerHTML=e;this.jc()!=m.db&&this.W.val(b)},Bb:function(){this.W.val(this.getData())},pg:function(){return this.document.body.innerHTML},tg:function(b){this.document.body.innerHTML=b},ze:function(b){var e=this.ua,j=e.cc;e=e.xa;var C="",o=m.k.md("../theme/editor-iframe.css");if(e)for(var D=0;D<e.length;D++)C+='<link href="'+e[D]+'" rel="stylesheet"/>';return"<!doctype html><html><head><title>${title}</title><link href='"+
o+"' rel='stylesheet'/><style>"+(j||"")+"</style>"+C+"</head><body class='ke-editor'>&nbsp;"+(b?'<script id="ke_actscript" type="text/javascript">'+(I.qb()?'document.domain="'+A.domain+'";':"")+'window.parent.KISSY.Editor._initIFrame("'+b+'");<\/script>':"")+"</body></html>"},getSelection:function(){return m.Mc.getSelection(this.document)},focus:function(){var b=this.document,e=s.ga(b);t.webkit&&e&&e.parent&&e.parent.focus();t.webkit&&e&&e.focus();b&&b.body.focus();this.ub()},blur:function(){s.ga(this.document).blur();
this.document&&this.document.body.blur()},He:function(b){var e=this.ua,j=this.document;e.cc=e.cc||"";e.cc+="\n"+b;e=j.createElement("style");j.getElementsByTagName("head")[0].appendChild(e);if(e.styleSheet)e.styleSheet.cssText=b;else e.appendChild(j.createTextNode(b))},zg:function(b){var e=this.ua,j=this.document;e.xa=e.xa||[];e.xa.push(b);e=j.createElement("link");e.rel="stylesheet";j.getElementsByTagName("head")[0].appendChild(e);e.href=b},Zg:function(b){for(var e=this.ua,j=y.makeArray(this.document.getElementsByTagName("link")),
C=0;C<j.length;C++)j[C].href==b&&s.h(j[C]);e.xa=e.xa||[];e=e.xa;b=y.indexOf(b,e);b!=-1&&e.splice(b,1)},bd:function(){function b(){D=o.document;e.document=D;j.detach();D.open("text/html","replace");D.write(C);D.close()}var e=this,j=e.Aa,C=e.ze(e.Ub),o=j[0].contentWindow,D;try{D=o.document}catch(k){j[0].src=j[0].src;if(t.ie<7){setTimeout(b,10);return}}b()},ready:function(b){this.Ae?b():this.on("dataReady",b)},Ag:function(b,e,j){this.ta=this.ta;j=j||{};j.gf=e;this.ta[b]=j},Xd:function(b){var e=this.ta[b];
if(e)if(!(e.status&&!e.duplicate)){b=this.Env.mods[b].requires||[];for(var j=0;j<b.length;j++)this.Xd(b[j]);e.gf.call(e);e.status=1}},jb:function(){var b=this;b.Zc&&clearTimeout(b.Zc);b.Zc=setTimeout(function(){var e=b.getSelection();if(e&&!e.Dd){var j=e.ob(),C=new m.Za(j);if(!b.vc||!b.vc.kd(C)){b.vc=C;b.fire("selectionChange",{selection:e,path:C,element:j})}}},100)},ub:function(){this.vc=U;this.jb()},Cd:function(b,e,j){var C=this;C.focus();setTimeout(function(){var o,D=b.d(),k=m.m,v=m.oa,J=m.n,x=
k.Xa[D],c=C.getSelection(),h=c&&c.A(),n,u,p,z;if(!h||h.length==0){var O=arguments,P=O.callee;setTimeout(function(){P.apply(C,O)},30)}else{C.fire("save");for(var L=h.length-1;L>=0;L--){n=h[L];n.deleteContents();o=!L&&b||b.K(w);e&&e(o);if(x)for(;(p=n.za(r,w))&&(z=k[p.d()])&&!(z&&z[D]);)if(p.d()in k.span)n.Ac(p);else if(n.va()&&n.ka()){n.setStartBefore(p);n.collapse(w);p.h()}else n.zc();n.insertNode(o);u||(u=o)}if(u){D=u.w(w);k=C.document;z=m.m;if(z.Ec[o.d()]){D=new q(k.createTextNode(" "));D.insertAfter(u)}else if(D){if(D.d()==
"br"&&z[D.parent().d()].p){z=new q("<p>&nbsp;</p>",U,k);D[0].parentNode.replaceChild(z[0],D[0]);D=z}}else{z=new q("<p>&nbsp;</p>",U,k);z.insertAfter(u);D=z}n.H(u,v.t);D&&D[0].nodeType==J.e&&n.sb(D);c.Ab([n]);C.focus();o&&o.Tb();setTimeout(function(){C.fire("save")},10);j&&j(o)}}},0)},rf:function(b){var e=this;if(e.htmlDataProcessor)b=e.htmlDataProcessor.toDataFormat(b);if(t.webkit){var j=s.create(b,U,e.document);j=j.nodeType==11?y.makeArray(j.childNodes):[j];for(var C=0;C<j.length;C++)e.Cd(new q(j[C]))}else{e.focus();
setTimeout(function(){var o=e.getSelection(),D=o&&o.A();if(!D||D.length==0){var k=arguments,v=k.callee;setTimeout(function(){v.apply(e,k)},30)}else{e.fire("save");if(g){o=o.r();o.type=="Control"&&o.clear();o.createRange().pasteHTML(b)}else e.document.execCommand("inserthtml",r,b);setTimeout(function(){e.fire("save")},10)}},0)}}});m._initIFrame=function(b){function e(c){l(function(){o.designMode="on";setTimeout(function(){o.designMode="off";k.focus();if(!arguments.callee.Ef)arguments.callee.Ef=w},
50)},function(){o.designMode="off";s.attr(k,"contentEditable",r);s.attr(k,"contentEditable",w);!c&&e(1)})}var j=d.hf(b);b=j.W[0];var C=j.Aa[0].contentWindow,o=j.document,D=j.ua;s.h(o.getElementById("ke_actscript"));var k=o.body;if(t.ie){k.hideFocus=w;k.disabled=w;k.contentEditable=w;k.removeAttribute("disabled")}else setTimeout(function(){if(t.gecko||t.opera)k.contentEditable=w;else if(t.webkit)k.parentNode.contentEditable=w;else o.designMode="on"},0);if(t.webkit){f.on(o,"click",function(c){var h=
new q(c.target);y.inArray(h.d(),["input","select"])&&c.preventDefault()});f.on(o,"mouseup",function(c){var h=new q(c.target);y.inArray(h.d(),["input","textarea"])&&c.preventDefault()})}if(t.gecko||t.ie||t.opera){var v;v=new q(s.insertAfter((new q('<span tabindex="-1" style="position:absolute; left:-10000" role="presentation"></span>'))[0],b));v.on("focus",function(){j.focus()});j.yg=function(){t.gecko&&j.oc&&v[0].focus()};j.on("destroy",function(){v.detach();v.remove()})}if(t.ie&&o.compatMode=="CSS1Compat"||
o.documentMode||t.gecko||t.opera){var J=o.documentElement;f.on(J,"mousedown",function(c){if(c.target==J){t.gecko&&e(r);v[0].focus()}})}f.on(C,"focus",function(){if(t.gecko)e(r);else t.opera&&k.focus();j.ub()});t.gecko&&f.on(j.document,"mousedown",function(){j.oc||e(r)});if(t.ie){f.on(o,"keydown",function(c){if(c.keyCode in{8:1,46:1}){var h=j.getSelection(),n=h.kc();if(n){j.fire("save");var u=h.A()[0].O();n.h();h.Rd([u]);j.fire("save");c.preventDefault()}}});if(o.compatMode=="CSS1Compat"){var x={33:1,
34:1};f.on(o,"keydown",function(c){c.keyCode in x&&setTimeout(function(){j.getSelection().scrollIntoView()},0)})}}setTimeout(function(){t.ie&&setTimeout(function(){if(o){k.runtimeStyle.marginBottom="0px";k.runtimeStyle.marginBottom=""}},1E3)},0);setTimeout(function(){j.fire("dataReady");var c=D.disableObjectResizing,h=D.disableInlineTableEditing;if(c||h)try{o.execCommand("enableObjectResizing",r,!c);o.execCommand("enableInlineTableEditing",r,!h)}catch(n){f.on(k,t.ie?"resizestart":"resize",function(u){var p=
new q(u.target);if(c||p.d()==="table"&&h)u.preventDefault()})}},10);t.webkit&&f.on(o,"mousedown",function(c){c=new q(c.target);y.inArray(c.d(),["img","hr","input","textarea","select"])&&j.getSelection().yc(c)});t.gecko&&f.on(o,"dragstart",function(c){var h=new q(c.target);h.d()==="img"&&/ke_/.test(h[0].className)&&c.preventDefault()});d.add(j)};i=m.prototype;I.o(i,{setData:i.setData,getData:i.getData,insertElement:i.Cd,insertHtml:i.rf,ready:i.ready,addCustomStyle:i.He,addCommand:i.Ge,hasCommand:i.nf,
execCommand:i.execCommand,useDialog:i.Lf,addDialog:i.Ie,getDialog:i.vd,getMode:i.jc,sync:i.Bb,getSelection:i.getSelection,focus:i.focus,blur:i.blur,notifySelectionChange:i.ub})});KISSY.Editor.add("zindex",function(){var m=KISSY.Editor;if(!m.Bc){m.Bc={Sf:1100,hg:1200,Uf:99999,ag:900,gg:9999,LOADING:11E3,$f:12E3,fe:1200};m.Yb=function(w){return(m.Tf.Yb||1E4)+w};m.baseZIndex=m.Yb;m.zIndexManager=m.Bc}});
KISSY.Editor.add("dtd",function(m){m.m=function(){function w(D){for(var k=arguments.length-1;k>0;)KISSY.mix(D,arguments[k--]);return D}var r={isindex:1,fieldset:1},I={input:1,button:1,select:1,textarea:1,label:1},A=w({a:1},I),y=w({iframe:1},A),t={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},s={ins:1,del:1,script:1,style:1},q=w({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,
s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},s),g=w({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},q),f=w({p:1},g);I=w({iframe:1},g,I);g={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,
del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};var d=w({a:1},I),l={tr:1},B={"#":1},i=w({param:1},g),a=w({form:1},r,y,t,f),b={li:1},e={base:1,link:1,meta:1,title:1},j=w(e,{style:1,script:1}),C={head:1,body:1},o={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1};return{Eb:w({html:1},C,e),Xa:o,Qf:{body:1,div:1,td:1,th:1,caption:1,
form:1},Ec:d,Cc:w({script:1,style:1},o),Dc:{script:1,style:1},Cb:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},Db:{dd:1,dt:1,li:1},Yd:{ul:1,ol:1,dl:1},Gc:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},ca:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},Rf:{a:1,area:1,button:1,input:1,object:1,select:1,
textarea:1},Hc:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:C,head:j,style:B,body:a,base:{},link:{},meta:{},title:B,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:a,td:a,br:{},th:a,center:a,kbd:d,button:w(f,t),basefont:{},h5:d,h4:d,samp:d,h6:d,ol:b,h1:d,h3:d,option:B,h2:d,form:w(r,y,t,f),select:{optgroup:1,option:1},font:d,ins:d,menu:b,abbr:d,label:d,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:d,script:B,tfoot:l,cite:d,li:a,input:{},iframe:a,
strong:d,textarea:B,noframes:a,big:d,small:d,span:d,hr:{},dt:d,sub:d,optgroup:{option:1},param:{},bdo:d,"var":d,div:a,object:i,sup:d,dd:a,strike:d,area:{},dir:b,map:w({area:1,form:1,p:1},r,s,t),applet:i,dl:{dt:1,dd:1},del:d,isindex:{},fieldset:w({Tg:1},g),thead:l,ul:b,acronym:d,b:d,a:I,blockquote:a,caption:d,i:d,u:d,tbody:l,s:d,address:w(y,f),tt:d,legend:d,q:d,pre:w(q,A),p:d,em:d,dfn:d}}();m.XHTML_DTD=m.m});
KISSY.Editor.add("elementpath",function(m){function w(g){var f=y,d=y,l=[];for(g=g;g&&g[0];){if(g[0].nodeType==A.e){if(!this.vf)this.vf=g;var B=g.d();if(!d){if(!f&&t[B])f=g;if(s[B]){var i;if(i=!f){if(i=B=="div"){a:{i=g;i=i[0]||i;i=i.childNodes;for(var a=0,b=i.length;a<b;a++){var e=i[a];if(e.nodeType==A.e&&I.Xa[e.nodeName.toLowerCase()]){i=T;break a}}i=X}i=!i}i=i}if(i)f=g;else d=g}}l.push(g);if(B=="body")break}g=g.parent()}this.block=this.z=f;this.blockLimit=this.F=d;this.elements=this.elements=l}var r=
KISSY.DOM,I=m.m,A=m.n,y=U,t={address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,dd:1},s={body:1,div:1,table:1,tbody:1,tr:1,td:1,th:1,caption:1,form:1};w.prototype={kd:function(g){var f=this.elements;g=g&&g.elements;if(!g||f.length!=g.length)return X;for(var d=0;d<f.length;d++)if(!r.g(f[d],g[d]))return X;return T},contains:function(g){for(var f=this.elements,d=0;d<f.length;d++)if(f[d].d()in g)return f[d];return y}};m.ElementPath=m.Za=w;var q=w.prototype;m.k.o(q,{compare:q.kd,
contains:q.contains})});
KISSY.Editor.add("walker",function(m){function w(l,B){if(this.c.end)return t;var i,a=this.Ca,b,e=this.lc,j=this.type,C=l?"_4e_previousSourceNode":"_4e_nextSourceNode";if(!this.c.start){this.c.start=1;a.trim();if(a.collapsed){this.end();return t}}if(!l&&!this.c.yd){var o=a.endContainer,D=new f(o[0].childNodes[a.endOffset]);this.c.yd=function(x,c){return(x=g.D(x))&&x[0]&&(!c||!g.g(o,x))&&(!D[0]||!x.g(D))&&(x[0].nodeType!=q.e||!c||x.d()!="body")}}if(l&&!this.c.zd){var k=a.startContainer,v=a.startOffset>
0&&new f(k[0].childNodes[a.startOffset-1]);this.c.zd=function(x,c){return(x=g.D(x))&&x[0]&&(!c||!x.g(k))&&(!v[0]||!x.g(v))&&(x[0].nodeType!=q.e||!c||x.d()!="body")}}var J=l?this.c.zd:this.c.yd;b=e?function(x,c){if(J(x,c)===y)return y;return e(x,c)}:J;if(this.mb)i=this.mb[C](y,j,b);else if(l){i=a.endContainer;if(a.endOffset>0){i=new f(i[0].childNodes[a.endOffset-1]);if(b(i)===y)i=t}else i=b(i,A)===y?t:i.ha(A,j,b)}else{i=a.startContainer;if((i=new f(i[0].childNodes[a.startOffset]))&&i[0]){if(b(i)===
y)i=t}else i=b(a.startContainer,A)===y?t:a.startContainer.w(A,j,b)}for(;i&&i[0]&&!this.c.end;){this.mb=i;if(!this.R||this.R(i)!==y){if(!B)return i}else if(B&&this.R)return y;i=i[C](y,j,b)}this.end();return this.mb=t}function r(l){for(var B,i=t;B=w.call(this,l);)i=B;return i}function I(l){this.Ca=l;this.c={}}var A=T,y=X,t=U,s=KISSY,q=m.n,g=s.DOM,f=s.Node;s.augment(I,{end:function(){this.c.end=1},next:function(){return w.call(this)},xb:function(){return w.call(this,A)},jd:function(){return w.call(this,
y,A)!==y},hd:function(){return w.call(this,A,A)!==y},Fd:function(){return r.call(this)},Ed:function(){return r.call(this,A)},reset:function(){delete this.mb;this.c={}}});I.Zb=function(l){return function(B){B=g.D(B);return!(B&&B[0].nodeType==q.e&&B.qa(l))}};I.xf=function(){return this.Zb({$b:1})};I.Ma=function(l,B){function i(a){return a&&a[0]&&a.d()=="span"&&a.attr("_ke_bookmark")}return function(a){var b,e;b=a&&a[0]&&a[0].nodeType==q.f&&(e=a.parent())&&i(e);b=l?b:b||i(a);return B^b}};I.Va=function(l){return function(B){B=
(B=B[0]||B)&&B.nodeType==q.f&&!s.trim(B.nodeValue);return l^B}};I.sf=function(l){var B=I.Va();return function(i){i=B(i)||i[0].nodeType==q.e&&!i[0].offsetHeight;return l^i}};m.Ga=I;m.Walker=I;var d=I.prototype;m.k.o(d,{end:d.end,next:d.next,previous:d.xb,checkForward:d.jd,checkBackward:d.hd,lastForward:d.Fd,lastBackward:d.Ed,reset:d.reset});m.k.o(I,{blockBoundary:I.Zb,listItemBoundary:I.xf,bookmark:I.Ma,whitespaces:I.Va,invisible:I.sf})});
KISSY.Editor.add("range",function(m){function w(c){this.endOffset=this.endContainer=this.startOffset=this.startContainer=g;this.collapsed=s;this.document=c}function r(c){var h=c[0].nodeType!=d.f&&c.d()in j.ca,n=!f.trim(c[0].nodeValue);c=!!c.parent().attr("_ke_bookmark");return h||n||c}function I(c){return!v(c)&&!J(c)}function A(c){var h=q,n=i.Ma(s);return function(u){if(n(u))return s;if(u[0].nodeType==d.f){if(f.trim(u[0].nodeValue).length)return q}else if(u[0].nodeType==d.e)if(!k[u.d()])if(!c&&!e.ie&&
u.d()=="br"&&!h)h=s;else return q;return s}}function y(c,h){function n(u){return u&&u.nodeName=="span"&&u.getAttribute("_ke_bookmark")}return function(u){var p,z;p=u&&!u.nodeName&&(z=u.parentNode)&&n(z);p=c?p:p||n(u);return h^p}}function t(c){return function(h){h=(h=h[0]||h)&&h.nodeType==d.f&&!f.trim(h.nodeValue);return c^h}}m.oa={Y:1,J:2,C:3,t:4,Hb:1,Gb:2,Ya:3,bb:1,be:2,ig:3,fa:1,Kc:2};m.RANGE=m.oa;var s=T,q=X,g=U,f=KISSY,d=m.n,l=m.oa,B=m.$a,i=m.Ga,a=f.DOM,b=m.k.ud,e=f.UA,j=m.m,C=m.Za,o=f.Node,D=
{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1};w.prototype.toString=function(){var c=[];c.push((this.startContainer[0].id||this.startContainer[0].nodeName)+":"+this.startOffset);c.push((this.endContainer[0].id||this.endContainer[0].nodeName)+":"+this.endOffset);return c.join("<br/>")};f.augment(w,{Ua:function(){this.collapsed=this.startContainer&&this.endContainer&&a.g(this.startContainer,this.endContainer)&&this.startOffset==this.endOffset},tc:function(){var c=this.startContainer,
h=this.startOffset;if(c[0].nodeType!=d.e)if(h)h>=c[0].nodeValue.length&&this.setStartAfter(c);else this.setStartBefore(c);c=this.endContainer;h=this.endOffset;if(c[0].nodeType!=d.e)if(h)h>=c[0].nodeValue.length&&this.setEndAfter(c);else this.setEndBefore(c)},setStartAfter:function(c){this.setStart(c.parent(),c.v()+1)},setStartBefore:function(c){this.setStart(c.parent(),c.v())},setEndAfter:function(c){this.setEnd(c.parent(),c.v()+1)},setEndBefore:function(c){this.setEnd(c.parent(),c.v())},uc:function(){var c=
this.startContainer,h=this.endContainer;c&&c.d()=="span"&&c.attr("_ke_bookmark")&&this.V(c,l.C);h&&h.d()=="span"&&h.attr("_ke_bookmark")&&this.U(h,l.t)},setStart:function(c,h){if(c[0].nodeType==d.e&&D[c.d()]){c=c.parent();h=c.v()}this.startContainer=c;this.startOffset=h;if(!this.endContainer){this.endContainer=c;this.endOffset=h}this.Ua()},setEnd:function(c,h){if(c[0].nodeType==d.e&&D[c.d()]){c=c.parent();h=c.v()+1}this.endContainer=c;this.endOffset=h;if(!this.startContainer){this.startContainer=
c;this.startOffset=h}this.Ua()},V:function(c,h){switch(h){case l.Y:this.setStart(c,0);break;case l.J:c[0].nodeType==d.f?this.setStart(c,c[0].nodeValue.length):this.setStart(c,c[0].childNodes.length);break;case l.C:this.setStartBefore(c);break;case l.t:this.setStartAfter(c)}this.Ua()},U:function(c,h){switch(h){case l.Y:this.setEnd(c,0);break;case l.J:c[0].nodeType==d.f?this.setEnd(c,c[0].nodeValue.length):this.setEnd(c,c[0].childNodes.length);break;case l.C:this.setEndBefore(c);break;case l.t:this.setEndAfter(c)}this.Ua()},
fc:function(c,h){var n=this.startContainer,u=this.endContainer,p=this.startOffset,z=this.endOffset,O,P=this.document,L;this.uc();if(u[0].nodeType==d.f)u=u.ia(z);else if(u[0].childNodes.length>0)if(z>=u[0].childNodes.length){u=new o(u[0].appendChild(P.createTextNode("")));L=s}else u=new o(u[0].childNodes[z]);if(n[0].nodeType==d.f){n.ia(p);if(n.g(u))u=new o(n[0].nextSibling)}else if(p)if(p>=n[0].childNodes.length){O=new o(P.createTextNode(""));n.append(O);n=O;O=s}else n=new o(n[0].childNodes[p].previousSibling);
else{O=new o(P.createTextNode(""));n.prepend(O);n=O;O=s}p=n.Sb();z=u.Sb();var Q,S,W;for(Q=0;Q<p.length;Q++){S=p[Q];W=z[Q];if(!S.g(W))break}P=h;for(var V,Y,E,K=Q;K<p.length;K++){V=p[K];Y=P&&!V.g(n)?P.appendChild(V.K()[0]):U;for(V=V[0].nextSibling;V;){if(a.g(z[K],V)||a.g(u,V))break;E=V.nextSibling;if(c==2)P.appendChild(V.cloneNode(s));else{a.h(V);c==1&&P.appendChild(V)}V=E}if(Y)P=Y}P=h;for(Q=Q;Q<z.length;Q++){V=z[Q];Y=P&&c>0&&!V.g(u)?P.appendChild(V.K()[0]):U;if(!p[Q]||!V.parent().g(p[Q].parent()))for(V=
V[0].previousSibling;V;){if(a.g(p[Q],V)||a.g(n,V))break;E=V.previousSibling;if(c==2)P.insertBefore(V.cloneNode(s),P.firstChild);else{a.h(V);c==1&&P.insertBefore(V,P.firstChild)}V=E}if(Y)P=Y}if(c==2){W=this.startContainer[0];if(W.nodeType==d.f&&W.nextSibling&&W.nextSibling.nodeType==d.f){W.data+=W.nextSibling.data;W.parentNode.removeChild(W.nextSibling)}W=this.endContainer[0];if(W.nodeType==d.f&&W.nextSibling&&W.nextSibling.nodeType==d.f){W.data+=W.nextSibling.data;W.parentNode.removeChild(W.nextSibling)}}else{if(S&&
W&&(!n.parent().g(S.parent())||!u.parent().g(W.parent()))){S=W.v();O&&W.parent().g(n.parent())&&S--;this.setStart(W.parent(),S)}this.collapse(s)}O&&n.h();L&&u[0].parentNode&&u.h()},collapse:function(c){if(c){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this.collapsed=s},clone:function(){var c=new w(this.document);c.startContainer=this.startContainer;c.startOffset=this.startOffset;c.endContainer=this.endContainer;
c.endOffset=this.endOffset;c.collapsed=this.collapsed;return c},wd:function(){var c=this.clone();c.tc();if(c.startContainer[0].nodeType!=d.e||c.endContainer[0].nodeType!=d.e)return g;var h=new m.Ga(c),n=y(s,undefined),u=t(s);c.R=function(p){return u(p)&&n(p)};c=h.next();h.reset();h=h.xb();return c&&c.g(h)?c:g},Ta:function(c,h){if(!this.collapsed){c=c||l.Kc;var n=this.clone(),u=this.startContainer,p=this.endContainer,z=this.startOffset,O=this.endOffset,P=1,L=1;if(u&&u[0].nodeType==d.f)if(z)if(z>=u[0].nodeValue.length)n.setStartAfter(u);
else{n.setStartBefore(u);P=0}else n.setStartBefore(u);if(p&&p[0].nodeType==d.f)if(O)if(O>=p[0].nodeValue.length)n.setEndAfter(p);else{n.setEndAfter(p);L=0}else n.setEndBefore(p);n=new i(n);n.R=function(S){S=S[0]||S;return S.nodeType==(c==l.fa?d.e:d.f)};var Q;n.lc=function(S,W){S=S[0]||S;if(c==l.fa&&S.nodeType==d.f)return q;if(W&&S==Q)return q;if(!W&&S.nodeType==d.e)Q=S;return s};if(P)(u=n[c==l.fa?"lastForward":"next"]())&&this.V(u,h?l.Y:l.C);if(L){n.reset();(n=n[c==l.fa?"lastBackward":"previous"]())&&
this.U(n,h?l.J:l.t)}return!!(P||L)}},lf:function(){var c=this.startContainer;if(this.collapsed||c[0].nodeType!=d.e)return c;return c.childNodes[this.startOffset]||c},ld:function(c){var h=this.startContainer,n=this.endContainer,u=this.startOffset,p=this.endOffset,z,O;if(!h||!n)return{start:0,end:0};if(c){if(h[0].nodeType==d.e)if((z=new o(h[0].childNodes[u]))&&z[0]&&z[0].nodeType==d.f&&u>0&&z[0].previousSibling.nodeType==d.f){h=z;u=0}for(;h[0].nodeType==d.f&&(O=h.sa())&&O[0].nodeType==d.f;){h=O;u+=
O[0].nodeValue.length}if(!this.collapsed){if(n[0].nodeType==d.e)if((z=new o(n[0].childNodes[p]))&&z[0]&&z[0].nodeType==d.f&&p>0&&z[0].previousSibling.nodeType==d.f){n=z;p=0}for(;n[0].nodeType==d.f&&(O=n.sa())&&O[0].nodeType==d.f;){n=O;p+=O[0].nodeValue.length}}}return{start:h.Ha(c),end:this.collapsed?g:n.Ha(c),startOffset:u,endOffset:p,Id:c,tf:s}},O:function(c){var h,n,u,p,z=this.collapsed;h=new o("<span>",g,this.document);h.attr("_ke_bookmark",1);h.css("display","none");h.html("&nbsp;");if(c){u=
f.guid("ke_bm_");h.attr("id",u+"S")}if(!z){n=h.K();n.html("&nbsp;");c&&n.attr("id",u+"E");p=this.clone();p.collapse();p.insertNode(n)}p=this.clone();p.collapse(s);p.insertNode(h);if(n){this.setStartAfter(h);this.setEndBefore(n)}else this.H(h,l.t);return{aa:c?u+"S":h,Q:c?u+"E":n,Td:c,collapsed:z}},H:function(c,h){this.V(c,h);this.collapse(s)},trim:function(c,h){var n=this.startContainer,u=this.startOffset,p=this.collapsed;if((!c||p)&&n[0]&&n[0].nodeType==d.f){if(u)if(u>=n[0].nodeValue.length){u=n.v()+
1;n=n.parent()}else{var z=n.ia(u);u=n.v()+1;n=n.parent();if(a.g(this.startContainer,this.endContainer))this.setEnd(z,this.endOffset-this.startOffset);else if(a.g(n,this.endContainer))this.endOffset+=1}else{u=n.v();n=n.parent()}this.setStart(n,u);if(p){this.collapse(s);return}}n=this.endContainer;u=this.endOffset;if(!(h||p)&&n[0]&&n[0].nodeType==d.f){if(u){u>=n.nodeValue.length||n.ia(u);u=n.v()+1}else u=n.v();n=n.parent();this.setEnd(n,u)}},insertNode:function(c){this.uc();this.trim(q,s);var h=this.startContainer;
h[0].insertBefore(c[0]||c,h[0].childNodes[this.startOffset]||U);a.g(c.parent(),this.endContainer)&&this.endOffset++;this.setStartBefore(c)},moveToBookmark:function(c){if(c.tf){var h=b(this.document,c.start,c.Id),n=c.startOffset,u=c.end&&b(this.document,c.end,c.Id);c=c.endOffset;this.setStart(h,n);u?this.setEnd(u,c):this.collapse(s)}else{h=(n=c.Td)?f.one("#"+c.aa,this.document):c.aa;c=n?f.one("#"+c.Q,this.document):c.Q;this.setStartBefore(h);h.h();if(c&&c[0]){this.setEndBefore(c);c.h()}else this.collapse(s)}},
za:function(c,h){var n=this.startContainer,u=this.endContainer;n=a.g(n,u)?c&&n[0].nodeType==d.e&&this.startOffset==this.endOffset-1?new o(n[0].childNodes[this.startOffset]):n:n.Ob(u);return h&&n[0].nodeType==d.f?n.parent():n},Na:function(c){switch(c){case l.Hb:if(this.collapsed)break;c=this.za();var h=new o(this.document.body),n,u,p,z,O,P=q,L,Q;L=this.startContainer;Q=this.startOffset;if(L[0].nodeType==d.f){if(Q){L=!f.trim(L[0].nodeValue.substring(0,Q)).length&&L;P=!!L}if(L)if(!(z=L[0].previousSibling))p=
L.parent()}else{if(Q)z=L[0].childNodes[Q-1]||L[0].lastChild;z||(p=L)}for(;p||z;){if(p&&!z){if(!O&&a.g(p,c))O=s;if(!h.contains(p))break;if(!P||p.css("display")!="inline"){P=q;if(O)n=p;else this.setStartBefore(p)}z=p[0].previousSibling}for(;z;){L=q;if(z.nodeType==d.f){Q=z.nodeValue;if(/[^\s\ufeff]/.test(Q))z=g;L=/[\s\ufeff]$/.test(Q)}else if(z.offsetWidth>0&&!z.getAttribute("_ke_bookmark"))if(P&&j.ca[z.nodeName.toLowerCase()]){Q=a.text(z);if(/[^\s\ufeff]/.test(Q))z=g;else for(var S=z.all||z.getElementsByTagName("*"),
W=0,V;V=S[W++];)if(!j.ca[V.nodeName.toLowerCase()]){z=g;break}if(z)L=!!Q.length}else z=g;if(L)if(P)if(O)n=p;else p&&this.setStartBefore(p);else P=s;if(z){L=z.previousSibling;if(!p&&!L){p=new o(z);z=g;break}z=L}else p=g}if(p)p=p.parent()}L=this.endContainer;Q=this.endOffset;p=z=g;O=P=q;if(L[0].nodeType==d.f){L=!f.trim(L[0].nodeValue.substring(Q)).length&&L;P=!(L&&L[0].nodeValue.length);if(L)if(!(z=L[0].nextSibling))p=L.parent()}else(z=L[0].childNodes[Q])||(p=L);for(;p||z;){if(p&&!z){if(!O&&a.g(p,c))O=
s;if(!h.contains(p))break;if(!P||p.css("display")!="inline"){P=q;if(O)u=p;else p&&this.setEndAfter(p)}z=p[0].nextSibling}for(;z;){L=q;if(z.nodeType==d.f){Q=z.nodeValue;if(/[^\s\ufeff]/.test(Q))z=g;L=/^[\s\ufeff]/.test(Q)}else if(z.offsetWidth>0&&!z.getAttribute("_ke_bookmark"))if(P&&j.ca[z.nodeName.toLowerCase()]){Q=a.text(z);if(/[^\s\ufeff]/.test(Q))z=g;else{S=z.all||z.getElementsByTagName("*");for(W=0;V=S[W++];)if(!j.ca[V.nodeName.toLowerCase()]){z=g;break}}if(z)L=!!Q.length}else z=g;if(L)if(P)if(O)u=
p;else this.setEndAfter(p);if(z){L=z.nextSibling;if(!p&&!L){p=new o(z);z=g;break}z=L}else p=g}if(p)p=p.parent()}if(n&&u){c=n.contains(u)?u:n;this.setStartBefore(c);this.setEndAfter(c)}break;case l.Gb:case l.Ya:p=new w(this.document);h=new o(this.document.body);p.V(h,l.Y);p.setEnd(this.startContainer,this.startOffset);p=new i(p);var Y,E,K=i.Zb(c==l.Ya?{$b:1}:g),G=function(F){var H=K(F);H||(Y=F);return H};n=function(F){var H=G(F);if(!H&&F[0]&&F.d()=="br")E=F;return H};p.lc=G;p=p.Ed();Y=Y||h;this.V(Y,
Y.d()!="br"&&(!p&&this.va()||p&&Y.contains(p))?l.Y:l.t);p=this.clone();p.collapse();p.U(h,l.J);p=new i(p);p.lc=c==l.Ya?n:G;Y=g;p=p.Fd();Y=Y||h;this.U(Y,!p&&this.ka()||p&&Y.contains(p)?l.J:l.C);E&&this.setEndAfter(E)}},va:function(){var c=this.startContainer,h=this.startOffset;if(h&&c[0].nodeType==d.f)if(f.trim(c[0].nodeValue.substring(0,h)).length)return q;this.trim();c=new C(this.startContainer);h=this.clone();h.collapse(s);h.V(c.z||c.F,l.Y);c=new i(h);c.R=A(s);return c.hd()},ka:function(){var c=
this.endContainer,h=this.endOffset;if(c[0].nodeType==d.f)if(f.trim(c[0].nodeValue.substring(h)).length)return q;this.trim();c=new C(this.endContainer);h=this.clone();h.collapse(q);h.U(c.z||c.F,l.J);c=new i(h);c.R=A(q);return c.jd()},deleteContents:function(){this.collapsed||this.fc(0)},extractContents:function(){var c=this.document.createDocumentFragment();this.collapsed||this.fc(1,c);return c},bc:function(c,h){var n=this.clone();n[h==l.bb?"setStartAt":"setEndAt"](c,h==l.bb?l.Y:l.J);n=new i(n);n.R=
r;return n[h==l.bb?"checkBackward":"checkForward"]()},sd:function(){var c=this.startContainer,h=this.endContainer,n=this.startOffset,u=this.endOffset,p;if(c[0].nodeType==d.e){p=c[0].childNodes.length;if(p>n)c=new o(c[0].childNodes[n]);else if(p<1)c=c.ha();else{for(c=c[0];c.lastChild;)c=c.lastChild;c=new o(c);c=c.w()||c}}if(h[0].nodeType==d.e){p=h[0].childNodes.length;if(p>u)h=(new o(h[0].childNodes[u])).ha(s);else if(p<1)h=h.ha();else{for(h=h[0];h.lastChild;)h=h.lastChild;h=new o(h)}}if(c.Ja(h)&B.da)c=
h;return{aa:c,Q:h}},nb:function(c,h){var n=this.O(),u=new o(this.document.createElement(h));this.collapse(c);this.Na(l.Gb);u[0].appendChild(this.extractContents());u.gb();e.ie||u.Mb();this.insertNode(u);this.moveToBookmark(n);return u},zc:function(c){var h=new C(this.startContainer),n=new C(this.endContainer),u=h.z,p=n.z,z=g;if(!h.F.g(n.F))return g;if(c!="br"){if(!u){u=this.nb(s,c);p=(new C(this.endContainer)).z}p||(p=this.nb(q,c))}c=u&&this.va();h=p&&this.ka();this.deleteContents();if(u&&a.g(u,p))if(h){z=
new C(this.startContainer);this.H(p,l.t);p=g}else if(c){z=new C(this.startContainer);this.H(u,l.C);u=g}else{p=this.Ac(u);!e.ie&&!f.inArray(u.d(),["ul","ol"])&&u.Mb()}return{Xg:u,Vg:p,Of:c,Nf:h,Pg:z}},Ac:function(c){if(!this.collapsed)return g;this.U(c,l.J);var h=this.extractContents(),n=c.K(q);n[0].appendChild(h);n.insertAfter(c);this.H(c,l.t);return n},sb:function(c,h){var n,u=m.m;if(u.Cb[c.d()])return q;for(;c&&c[0].nodeType==d.e;){if(n=c.Qc())this.H(c,h?l.J:l.Y);else if(u.Ec[c.d()]){this.H(c,h?
l.t:l.C);return s}if((c=u.Cb[c.d()]?c[h?"_4e_previous":"_4e_next"](I):c[h?"_4e_last":"_4e_first"](I))&&c[0].nodeType==d.f){this.H(c,h?l.t:l.C);return s}}return n},selectNodeContents:function(c){this.setStart(c,0);this.setEnd(c,c[0].nodeType==d.f?c[0].nodeValue.length:c[0].childNodes.length)}});var k={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},v=new i.Va,J=new i.Ma;m.Range=
w;m.Range=w;var x=w.prototype;m.k.o(x,{updateCollapsed:x.Ua,optimize:x.tc,setStartAfter:x.setStartAfter,setEndAfter:x.setEndAfter,setStartBefore:x.setStartBefore,setEndBefore:x.setEndBefore,optimizeBookmark:x.uc,setStart:x.setStart,setEnd:x.setEnd,setStartAt:x.V,setEndAt:x.U,execContentsAction:x.fc,collapse:x.collapse,clone:x.clone,getEnclosedNode:x.wd,shrink:x.Ta,getTouchedStartNode:x.lf,createBookmark2:x.ld,createBookmark:x.O,moveToPosition:x.H,trim:x.trim,insertNode:x.insertNode,moveToBookmark:x.moveToBookmark,
getCommonAncestor:x.za,enlarge:x.Na,checkStartOfBlock:x.va,checkEndOfBlock:x.ka,deleteContents:x.deleteContents,extractContents:x.extractContents,checkBoundaryOfElement:x.bc,getBoundaryNodes:x.sd,fixBlock:x.nb,splitBlock:x.zc,splitElement:x.Ac,moveToElementEditablePosition:x.sb,selectNodeContents:x.selectNodeContents})});
KISSY.Editor.add("domiterator",function(m){function w(i){if(!(arguments.length<1)){this.Ca=i;this.hc=I;this.qd=r;this.ec=I;this.c||(this.c={})}}var r=T,I=X,A=KISSY,y=A.UA,t=m.Ga,s=m.Range,q=m.oa,g=m.n,f=m.Za,d=A.Node,l=A.DOM,B=/^[\r\n\t ]*$/;A.augment(w,{kf:function(i){var a,b,e,j,C;if(!this.c.I){b=this.Ca.clone();b.Ta(q.fa,r);b.Na(this.hc||!this.qd?q.Ya:q.Gb);var o=new t(b),D=t.Ma(r,r);o.R=D;this.c.la=o.next();o=new t(b);o.R=D;o=o.xb();this.c.I=o.w(r);if(this.c.I&&this.c.I[0].nodeType==g.f&&!A.trim(this.c.I[0].nodeValue)&&
this.c.I.parent().qa()){D=new s(b.document);D.H(this.c.I,q.t);if(D.ka()){D=new f(D.endContainer);this.c.I=(D.z||D.F).w(r)}}if(!this.c.I){this.c.I=this.c.od=new d(b.document.createTextNode(""));l.insertAfter(this.c.I[0],o[0])}b=U}D=this.c.la;o=this.c.I;for(this.c.la=U;D;){var k=I,v=D[0].nodeType!=g.e,J=I;if(v){if(D[0].nodeType==g.f)if(B.test(D[0].nodeValue))v=I}else{var x=D.d();if(D.qa(this.hc&&{$b:1})){if(x=="br")v=r;else if(!b&&!D[0].childNodes.length&&x!="hr"){a=D;e=D.g(o);break}if(b){b.U(D,q.C);
if(x!="br")this.c.la=D}k=r}else{if(D[0].firstChild){if(!b){b=new s(this.Ca.document);b.V(D,q.C)}D=new d(D[0].firstChild);continue}v=r}}if(v&&!b){b=new s(this.Ca.document);b.V(D,q.C)}e=(!k||v)&&D.g(o);if(b&&!k)for(;!D[0].nextSibling&&!e;){x=D.parent();if(x.qa(this.hc&&{$b:1})){k=r;e||x.g(o);break}D=x;v=r;e=D.g(o);J=r}v&&b.U(D,q.t);D=D.w(J,U,o);if((e=!D)||k&&b)break}if(!a){if(!b){this.c.od&&this.c.od.h();return this.c.la=U}a=new f(b.startContainer);D=a.F;k={Lg:1,eh:1,dh:1};a=a.z;if((!a||!a[0])&&!this.ec&&
k[D.d()]&&b.va()&&b.ka())a=D;else if(!a||this.ec&&a.d()=="li"){a=new d(this.Ca.document.createElement(i||"p"));a[0].appendChild(b.extractContents());a.gb();b.insertNode(a);j=C=r}else if(a.d()!="li"){if(!b.va()||!b.ka()){a=a.K(I);a[0].appendChild(b.extractContents());a.gb();C=b.zc();j=!C.Of;C=!C.Nf;b.insertNode(a)}}else if(!e)this.c.la=a.g(o)?U:b.sd().Q.w(r,U,o)}if(j){b=new d(a[0].previousSibling);if(b[0]&&b[0].nodeType==g.e)if(b.d()=="br")b.h();else b[0].lastChild&&l.d(b[0].lastChild)=="br"&&l.h(b[0].lastChild)}if(C){b=
t.Ma(I,r);j=new d(a[0].lastChild);if(j[0]&&j[0].nodeType==g.e&&j.d()=="br")if(y.ie||j.sa(b)||j.Ia(b))j.h()}if(!this.c.la)this.c.la=e||a.g(o)?U:a.w(r,U,o);return a}});s.prototype.Ye=function(){return new w(this)}});
KISSY.Editor.add("selection",function(m){function w(k){this.document=this.document=k;this.c={M:{}};if(a){var v=this.r().createRange();if(!v||v.item&&v.item(0).ownerDocument!=k||v.parentElement&&v.parentElement().ownerDocument!=k)this.Dd=A}}function r(k){k=new w(k);return!k||k.Dd?t:k}function I(k){var v=k.document,J=new d(v.body),x=new d(v.documentElement);if(q.ie){if(q.ie<8||document.documentMode==7)x.on("click",function(L){(new d(L.target)).d()==="html"&&k.getSelection().A()[0].select()});var c,
h,n=1;x.on("mousedown",function(){n=0});x.on("mouseup",function(){n=1});J.on("focusin",function(L){if((new d(L.target)).d()=="body")if(c){try{n&&c.select()}catch(Q){}c=t}});J.on("focus",function(){h=A;p()});J.on("beforedeactivate",function(L){if(!L.relatedTarget){h=y;n=1}});f.on(g.ga(v),"blur",function(){v&&v.selection.empty()});J.on("mousedown",function(){u()});J.on("mouseup",function(){h=A;setTimeout(function(){p(A)},0)});var u=function(){h=y},p=function(L){if(h){var Q=k.document,S=k.getSelection(),
W=S&&S.pb(),V=S&&S.r();if(L&&V&&W==l.Jb)if(!Q.queryCommandEnabled("InsertImage")){setTimeout(function(){p(A)},50);return}var Y;if(!(V&&W==l.pa&&(Y=g.d(S.ob()))&&Y in{input:1,textarea:1})){c=V&&S.A()[0];k.jb()}}};J.on("keydown",u);J.on("keyup",function(){h=A;p()});f.on(v,"selectionchange",p)}else{f.on(v,"mouseup",k.jb,k);f.on(v,"keyup",k.jb,k)}var z={table:1,pre:1},O=/\s*<(p|div|address|h\d|center)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\1>)?(?=\s*$|<\/body>)/gi,P=m.Ga.Va(A);k.on("selectionChange",
function(L){var Q=L.path;L=(L=L.selection)&&L.A()[0];if(!(!L||!L.collapsed||Q.z))if(Q.F.d()=="body"){Q=L.nb(A,"p");if(Q.fb().match(O)){var S=Q.Ia(P);if(S&&S[0].nodeType==i.e&&!z[S.d()]){L.sb(S);Q.h()}else if((S=Q.sa(P))&&S[0].nodeType==i.e&&!z[S.d()]){L.sb(S,S.fb().match(O)?y:A);Q.h()}}L.select();a||k.ub()}})}m.ge={Jb:1,pa:2,ab:3};var A=T,y=X,t=U,s=KISSY,q=s.UA,g=s.DOM,f=s.Event,d=s.Node,l=m.ge,B=m.oa,i=m.n,a=!window.getSelection,b=m.Ga,e=m.Range,j={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,
object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};s.augment(w,{r:!a?function(){var k=this.c.M;return k.rc||(k.rc=g.ga(this.document).getSelection())}:function(){var k=this.c.M;return k.rc||(k.rc=this.document.selection)},pb:!a?function(){var k=this.c.M;if(k.type)return k.type;var v=l.pa,J=this.r();if(J){if(J.rangeCount==1){J=J.getRangeAt(0);var x=J.startContainer;if(x==J.endContainer&&x.nodeType==i.e&&J.endOffset-J.startOffset===1&&j[x.childNodes[J.startOffset].nodeName.toLowerCase()])v=
l.ab}}else v=l.Jb;return k.type=v}:function(){var k=this.c.M;if(k.type)return k.type;var v=l.Jb;try{var J=this.r(),x=J.type;if(x=="Text")v=l.pa;if(x=="Control")v=l.ab;if(J.createRange().parentElement)v=l.pa}catch(c){}return k.type=v},A:a?function(){function k(v,J){v=v.duplicate();v.collapse(J);for(var x=v.parentElement(),c=x.childNodes,h,n=0;n<c.length;n++){var u=c[n];if(u.nodeType==i.e){h=v.duplicate();h.moveToElementText(u);u=h.compareEndPoints("StartToStart",v);var p=h.compareEndPoints("EndToStart",
v);h.collapse();if(u>0)break;else if(!u||p==1&&u==-1)return{wa:x,offset:n};else if(!p)return{wa:x,offset:n+1};h=t}}if(!h){h=v.duplicate();h.moveToElementText(x);h.collapse(y)}h.setEndPoint("StartToStart",v);h=h.text.replace(/\r\n|\r/g,"\n").length;try{for(;h>0;)h-=c[--n].nodeValue.length}catch(z){h=0}return h===0?{wa:x,offset:n}:{wa:c[n],offset:-h}}return function(){var v=this.c.M;if(v.na)return v.na;var J=this.r(),x=J&&J.createRange(),c=this.pb();if(!J)return[];if(c==l.pa){J=new e(this.document);
c=k(x,A);J.setStart(new d(c.wa),c.offset);c=k(x);J.setEnd(new d(c.wa),c.offset);return v.na=[J]}else if(c==l.ab){v=v.na=[];for(c=0;c<x.length;c++){var h=x.item(c),n=h.parentNode,u=0;for(J=new e(this.document);u<n.childNodes.length&&n.childNodes[u]!=h;u++);J.setStart(new d(n),u);J.setEnd(new d(n),u+1);v.push(J)}return v}return v.na=[]}}():function(){var k=this.c.M;if(k.na)return k.na;var v=[],J=this.r();if(!J)return[];for(var x=0;x<J.rangeCount;x++){var c=J.getRangeAt(x),h=new e(this.document);h.setStart(new d(c.startContainer),
c.startOffset);h.setEnd(new d(c.endContainer),c.endOffset);v.push(h)}return k.na=v},ob:function(){var k=this.c.M;if(k.Ud!==undefined)return k.Ud;var v,J=this.r();switch(this.pb()){case l.ab:return this.kc();case l.pa:var x=this.A()[0];if(x)if(!x.collapsed){for(x.tc();A;){v=x.startContainer;if(x.startOffset==(v[0].nodeType===i.e?v[0].childNodes.length:v[0].nodeValue.length)&&!v.qa())x.setStartAfter(v);else break}v=x.startContainer;if(v[0].nodeType!=i.e)return v.parent();v=new d(v[0].childNodes[x.startOffset]);
if(!v[0]||v[0].nodeType!=i.e)return x.startContainer;for(x=v[0].firstChild;x&&x.nodeType==i.e;){v=new d(x);x=x.firstChild}return v}if(a){x=J.createRange();x.collapse(A);v=x.parentElement()}else if((v=J.anchorNode)&&v.nodeType!=i.e)v=v.parentNode}return k.Ud=v?g.D(v):t},kc:function(){var k=this,v,J=k.c.M;if(J.Sd!==undefined)return J.Sd;if(a){v=k.r().createRange();v=v.item&&v.item(0)}v||(v=function(){for(var x=k.A()[0],c,h,n=2;n&&!((c=x.wd())&&c[0].nodeType==i.e&&j[c.d()]&&(h=c));n--)x.Ta(B.fa);return h&&
h[0]}());return J.Sd=g.D(v)},reset:function(){this.c.M={}},yc:function(k){var v,J=this.document;if(a)try{v=J.body.createControlRange();v.addElement(k[0]);v.select()}catch(x){v=J.body.createTextRange();v.moveToElementText(k[0]);v.select()}finally{}else{v=J.createRange();v.selectNode(k[0]);k=this.r();k.removeAllRanges();k.addRange(v)}this.reset()},Ab:function(k){if(a){if(k.length>1){var v=k[k.length-1];k[0].setEnd(v.endContainer,v.endOffset);k.length=1}k[0]&&k[0].select()}else{v=this.r();if(!v)return;
v.removeAllRanges();for(var J=0;J<k.length;J++){var x=k[J],c=this.document.createRange(),h=x.startContainer;x.collapsed&&q.gecko&&q.gecko<1.09&&h[0].nodeType==i.e&&!h[0].childNodes.length&&h[0].appendChild(this.document.createTextNode(""));c.setStart(h[0],x.startOffset);c.setEnd(x.endContainer[0],x.endOffset);v.addRange(c)}}this.reset()},Xe:function(k){for(var v=[],J=this.A(),x=0;x<J.length;x++)v.push(J[x].ld(k));return v},We:function(k,v){var J=[],x=this.document,c;v=v||this.A();for(var h=v.length,
n=0;n<h;n++){J.push(c=v[n].O(k,A));var u=(k=c.Td)?s.one("#"+c.aa,x):c.aa;c=k?s.one("#"+c.Q,x):c.Q;for(var p=n+1;p<h;p++){var z=v[p],O=z.startContainer,P=z.endContainer;g.g(O,u.parent())&&z.startOffset++;g.g(O,c.parent())&&z.startOffset++;g.g(P,u.parent())&&z.endOffset++;g.g(P,c.parent())&&z.endOffset++}}return J},Rd:function(k){for(var v=[],J=0;J<k.length;J++){var x=new e(this.document);x.moveToBookmark(k[J]);v.push(x)}this.Ab(v);return this},za:function(){var k=this.A();return k[0].startContainer.Ob(k[k.length-
1].endContainer)},scrollIntoView:function(){var k=this.ob();k&&k.Tb()},removeAllRanges:function(){var k=this.r();if(a)k&&k.clear();else k&&k.removeAllRanges()}});var C={table:1,tbody:1,tr:1},o=b.Va(A),D=/\ufeff|\u00a0/;e.prototype.select=e.prototype.select=!a?function(){var k=this.startContainer;this.collapsed&&k[0].nodeType==i.e&&!k[0].childNodes.length&&k[0].appendChild(this.document.createTextNode(""));var v=this.document.createRange();v.setStart(k[0],this.startOffset);try{v.setEnd(this.endContainer[0],
this.endOffset)}catch(J){if(J.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0){this.collapse(A);v.setEnd(this.endContainer[0],this.endOffset)}else throw J;}k=r(this.document).r();k.removeAllRanges();k.addRange(v)}:function(k){var v=this.collapsed,J,x;if(this.startContainer[0]===this.endContainer[0]&&this.endOffset-this.startOffset==1){var c=this.startContainer[0].childNodes[this.startOffset];if(c.nodeType==i.e){(new w(this.document)).yc(new d(c));return}}if(this.startContainer[0].nodeType==i.e&&this.startContainer.d()in
C||this.endContainer[0].nodeType==i.e&&this.endContainer.d()in C)this.Ta(B.fa,A);var h=this.O();c=h.aa;var n;if(!v)n=h.Q;h=this.document.body.createTextRange();h.moveToElementText(c[0]);h.moveStart("character",1);if(n){k=this.document.body.createTextRange();k.moveToElementText(n[0]);h.setEndPoint("EndToEnd",k);h.moveEnd("character",-1)}else{for(J=c[0].nextSibling;J&&!o(J);)J=J.nextSibling;J=!(J&&J.nodeValue&&J.nodeValue.match(D))&&(k||!c[0].previousSibling||c[0].previousSibling&&g.d(c[0].previousSibling)==
"br");x=new d(this.document.createElement("span"));x.html("&#65279;");x.insertBefore(c);J&&g.insertBefore(this.document.createTextNode("\ufeff"),c)}this.setStartBefore(c);c.h();if(v){if(J){h.moveStart("character",-1);h.select();this.document.selection.clear()}else h.select();if(x){this.H(x,B.C);x.h()}}else{this.setEndBefore(n);n.h();h.select()}};w.getSelection=r;m.Mc=w;m.Selection=w;b=w.prototype;m.k.o(b,{getNative:b.r,getType:b.pb,getRanges:b.A,getStartElement:b.ob,getSelectedElement:b.kc,reset:b.reset,
selectElement:b.yc,selectRanges:b.Ab,createBookmarks2:b.Xe,createBookmarks:b.We,getCommonAncestor:b.za,scrollIntoView:b.scrollIntoView,selectBookmarks:b.Rd,removeAllRanges:b.removeAllRanges});m.on("instanceCreated",function(k){I(k.bf)})});
KISSY.Editor.add("styles",function(m){function w(E,K){for(var G in E)E[G]=E[G].replace(V,function(F,H){return K[H]})}function r(E,K){if(K){E=v.clone(E);w(E.attributes,K);w(E.styles,K)}var G=this.element=this.element=(E.element||"*").toLowerCase();this.type=this.type=G=="#"||Q[G]?c.Kb:S[G]?c.cb:c.Fa;this.c={definition:E}}function I(E,K){var G=K?this.xc:this.Vb;E.body.focus();for(var F=new n(E),H=F.A(),N=0;N<H.length;N++)G.call(this,H[N]);F.Ab(H)}function A(E,K){var G;G=E.element;if(G=="*")G="span";
G=new O(K.createElement(G));return y(G,E)}function y(E,K){var G=K.c.definition,F=G.attributes;G=r.xd(G);if(F)for(var H in F)E.attr(H,F[H]);if(G)E[0].style.cssText=G;return E}function t(E){var K=E.O(o),G=E.Ye();G.ec=o;G.qd=o;for(var F,H=E.document;F=G.kf();){var N=A(this,H);F=F;var M=N;N=M.d=="pre";var R=F.d=="pre",ba=!N&&R;if(N&&!R){R=F;M=M;ba=R.html();ba=s(ba,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");ba=ba.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1");ba=ba.replace(/([ \t\n\r]+|&nbsp;)/g," ");ba=
ba.replace(/<br\b[^>]*>/gi,"\n");if(P.ie){R=R[0].ownerDocument.createElement("div");R.appendChild(M[0]);M[0].outerHTML="<pre>"+ba+"</pre>";M=new O(R.firstChild);M.h()}else M.html(ba);M=M}else if(ba)M=g(q(F),M);else F.Rb(M);F[0].parentNode.replaceChild(M[0],F[0]);if(N){F=M;N=void 0;if((N=F.ha(o,u.e))&&N.d()=="pre"){M=s(N.html(),/\n$/,"")+"\n\n"+s(F.html(),/^\n/,"");if(P.ie)F[0].outerHTML="<pre>"+M+"</pre>";else F.html(M);N.h()}}}E.moveToBookmark(K)}function s(E,K,G){var F="",H="";E=E.replace(/(^<span[^>]+_ke_bookmark.*?\/span>)|(<span[^>]+_ke_bookmark.*?\/span>$)/gi,
function(N,M,R){M&&(F=M);R&&(H=R);return""});return F+E.replace(K,G)+H}function q(E){var K=[];s(E.fb(),/(\S\s*)\n(?:\s|(<span[^>]+_ck_bookmark.*?\/span>))*\n(?!$)/gi,function(G,F,H){return F+"</pre>"+H+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(G,F){K.push(F)});return K}function g(E,K){for(var G=K[0].ownerDocument.createDocumentFragment(),F=0;F<E.length;F++){var H=E[F];H=H.replace(/(\r\n|\r)/g,"\n");H=s(H,/^[ \t]*\n/,"");H=s(H,/\n$/,"");H=s(H,/^[ \t]+|[ \t]+$/g,function(M,R){return M.length==
1?"&nbsp;":R?" "+Array(M.length).join("&nbsp;"):Array(M.length).join("&nbsp;")+" "});H=H.replace(/\n/g,"<br>");H=H.replace(/[ \t]{2,}/g,function(M){return Array(M.length).join("&nbsp;")+" "});var N=K.K();N.html(H);G.appendChild(N[0])}return G}function f(E){var K=E.document;if(E.collapsed){K=A(this,K);E.insertNode(K);E.H(K,h.J)}else{var G=this.element,F=this.c.definition,H,N=m.m[G]||(H=o,m.m.span),M=E.O();E.Na(h.Hb);E.trim();var R=E.O(),ba=R.aa;R=R.Q;for(var $=ba,da;$&&$[0];){var Z=D;if(x.g($,R)){$=
k;Z=o}else{var aa=$[0].nodeType,ca=aa==u.e?$.d():k;if(ca&&$.attr("_ke_bookmark")){$=$.w(o);continue}if(!ca||N[ca]&&($.Ja(R)|p.$|p.ea|p.Z)==p.$+p.ea+p.Z&&(!F.childRule||F.childRule($))){var ga=$.parent();if(ga&&ga[0]&&((m.m[ga.d()]||m.m.span)[G]||H)&&(!F.parentRule||F.parentRule(ga))){if(!da&&(!ca||!m.m.ca[ca]||($.Ja(R)|p.$|p.ea|p.Z)==p.$+p.ea+p.Z)){da=new z(K);da.setStartBefore($)}if(aa==u.f||aa==u.e&&!$[0].childNodes.length){aa=$;var fa;for(ca=aa.Ia(function(ja){return!ja.attr("_ke_bookmark")});!ca&&
(fa=aa.parent(),N[fa.d()])&&(fa.Ja(ba)|p.da|p.ea|p.Z)==p.da+p.ea+p.Z&&(!F.childRule||F.childRule(fa));)aa=fa;da.setEndAfter(aa);aa[0].nextSibling||(Z=o)}}else Z=o}else Z=o;$=$.w()}if(Z&&da&&!da.collapsed){Z=A(this,K);aa=da.za();ca={bh:{},Ne:{},fd:{},ed:{}};for(var ea,ha,ia;Z&&aa&&Z[0]&&aa[0];){if(aa.d()==G){for(ea in F.attributes)if(!(ca.ed[ea]||!(ia=aa.attr(ha))))if(Z.attr(ea)==ia)Z.removeAttr(ea);else ca.ed[ea]=1;for(ha in F.styles)if(!(ca.fd[ha]||!(ia=aa.L(ha))))if(Z.L(ha)==ia)Z.L(ha,"");else ca.fd[ha]=
1;if(!Z.eb()){Z=k;break}}aa=aa.parent()}if(Z){Z[0].appendChild(da.extractContents());e(this,Z);da.insertNode(Z);Z.ra();P.ie||Z[0].normalize()}else{Z=new O(K.createElement("span"));Z[0].appendChild(da.extractContents());da.insertNode(Z);e(this,Z);Z.h(T)}da=k}}ba.h();R.h();E.moveToBookmark(M);E.Ta(h.Kc)}}function d(E){E.Na(h.Hb);var K=E.O(),G=K.aa;if(E.collapsed){for(var F=new L(G.parent()),H,N=0,M;N<F.elements.length&&(M=F.elements[N]);N++){if(M==F.z||M==F.F)break;if(this.ja(M)){var R=E.bc(M,h.be),
ba=!R&&E.bc(M,h.bb);if(ba||R){H=M;H.match=ba?"start":"end"}else{M.ra();M.d()==this.element?a(this,M):j(M,i(this)[M.d()])}}}if(H&&H[0]){M=G;for(N=0;;N++){R=F.elements[N];if(x.g(R,H))break;else if(R.match)continue;else R=R.K();R[0].appendChild(M[0]);M=R}x[H.match=="start"?"insertBefore":"insertAfter"](M,H)}}else{var $=K.Q,da=this;F=function(){for(var Z=new L(G.parent()),aa=new L($.parent()),ca=k,ga=k,fa=0;fa<Z.elements.length;fa++){var ea=Z.elements[fa];if(ea==Z.z||ea==Z.F)break;if(da.ja(ea))ca=ea}for(fa=
0;fa<aa.elements.length;fa++){ea=aa.elements[fa];if(ea==aa.z||ea==aa.F)break;if(da.ja(ea))ga=ea}ga&&$.Nb(ga);ca&&G.Nb(ca)};F();for(H=new O(G[0].nextSibling);H[0]!==$[0];){N=H.w();if(H[0]&&H[0].nodeType==u.e&&this.ja(H)){H.d()==this.element?a(this,H):j(H,i(this)[H.d()]);if(N[0].nodeType==u.e&&N.contains(G)){F();N=new O(G[0].nextSibling)}}H=N}}E.moveToBookmark(K)}function l(E){var K={};E.replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(G,F,H){K[F]=H});return K}function B(E,
K){var G;if(K!==D){G=document.createElement("span");G.style.cssText=E;G=G.style.cssText||""}else G=E;return G.replace(/\s*([;:])\s*/,"$1").replace(/([^\s;])$/,"$1;").replace(/,\s+/g,",").toLowerCase()}function i(E){if(E.c.Qd)return E.c.Qd;var K=E.c.Qd={},G=E.c.definition.overrides;if(G){v.isArray(G)||(G=[G]);for(var F=0;F<G.length;F++){var H=G[F],N,M;if(typeof H=="string")N=H.toLowerCase();else{N=H.element?H.element.toLowerCase():E.element;M=H.attributes}H=K[N]||(K[N]={});if(M){H=H.attributes=H.attributes||
[];for(var R in M)H.push([R.toLowerCase(),M[R]])}}}return K}function a(E,K){var G=E.c.definition,F=J.mix(G.attributes,i(E)[K.d()]);G=G.styles;var H=v.isEmptyObject(F)&&v.isEmptyObject(G),N;for(N in F)if(!((N=="class"||E.c.definition.fullMatch)&&K.attr(N)!=b(N,F[N]))){H=H||!!K.Pc(N);K.removeAttr(N)}for(var M in G)if(!(E.c.definition.fullMatch&&K.L(M)!=b(M,G[M],o))){H=H||!!K.L(M);K.L(M,"")}C(K)}function b(E,K,G){var F=new O("<span>");F[G?"_4e_style":"attr"](E,K);return F[G?"_4e_style":"attr"](E)}function e(E,
K){for(var G=i(E),F=K.all(E.element),H=F.length;--H>=0;)a(E,new O(F[H]));for(var N in G)if(N!=E.element){F=K.all(N);for(H=F.length-1;H>=0;H--){var M=new O(F[H]);j(M,G[N])}}}function j(E,K){var G=K&&K.attributes;if(G)for(var F=0;F<G.length;F++){var H=G[F][0],N;if(N=E.attr(H)){var M=G[F][1];if(M===k||M.test&&M.test(N)||typeof M=="string"&&N==M)E[0].removeAttribute(H)}}C(E)}function C(E){if(!E.eb()){var K=E[0].firstChild,G=E[0].lastChild;E.h(o);if(K){K.nodeType==u.e&&x.ra(K);G&&K!=G&&G.nodeType==u.e&&
x.ra(G)}}}var o=T,D=X,k=U,v=KISSY,J=m.k,x=v.DOM,c={Kb:1,Fa:2,cb:3},h=m.oa,n=m.Mc,u=m.n,p=m.$a,z=m.Range,O=v.Node,P=v.UA,L=m.Za,Q={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1},S={embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1},W=/\s*(?:;\s*|$)/g,V=/#\((.+?)\)/g;m.jg=c;r.prototype={apply:function(E){I.call(this,E,D)},remove:function(E){I.call(this,E,o)},Vb:function(E){return(this.Vb=this.type==c.Fa?f:this.type==c.Kb?t:this.type==c.cb?k:k).call(this,
E)},xc:function(E){return(this.xc=this.type==c.Fa?d:k).call(this,E)},Ke:function(E){y(E,this)},ja:function(E,K){if(!E)return D;var G=this.c.definition;if(E.d()==this.element){if(!K&&!E.eb())return o;var F=G.re;if(F)G=F;else{F={};var H=0,N=G.attributes;if(N)for(var M in N){H++;F[M]=N[M]}if(N=r.xd(G)){F.style||H++;F.style=N}F._length=H;G=G.re=F}if(G._length){for(var R in G)if(R!="_length"){H=E.attr(R)||"";if(R=="style")a:{F=G[R];H=B(H,D);typeof F=="string"&&(F=l(F));typeof H=="string"&&(H=l(H));N=void 0;
for(N in F)if(!(N in H&&(H[N]==F[N]||F[N]=="inherit"||H[N]=="inherit"))){F=D;break a}F=o}else F=G[R]==H;if(F){if(!K)return o}else if(K)return D}if(K)return o}else return o}if(R=i(this)[E.d()]){if(!(G=R.attributes))return o;for(F=0;F<G.length;F++){R=G[F][0];if(R=E.attr(R)){H=G[F][1];if(H===k||typeof H=="string"&&R==H||H.test&&H.test(R))return o}}}return D},Se:function(E){switch(this.type){case c.Kb:return this.ja(E.z||E.F,o);case c.cb:case c.Fa:for(var K=E.elements,G=0,F;G<K.length;G++){F=K[G];if(!(this.type==
c.Fa&&(x.g(F,E.z)||x.g(F,E.F))))if(!(this.type==c.cb&&!(F.d()in S)))if(this.ja(F,o))return o}}return D}};r.xd=function(E){var K=E.se;if(K)return K;K=E.styles;var G=E.attributes&&E.attributes.style||"",F="";if(G.length)G=G.replace(W,";");for(var H in K){var N=K[H],M=(H+":"+N).replace(W,";");if(N=="inherit")F+=M;else G+=M}if(G.length)G=B(G);G+=F;return E.se=G};m.kg=r;m.Style=r;var Y=r.prototype;m.k.o(Y,{apply:Y.apply,remove:Y.remove,applyToRange:Y.Vb,removeFromRange:Y.xc,applyToObject:Y.Ke,checkElementRemovable:Y.ja,
checkActive:Y.Se})});
KISSY.Editor.add("htmlparser",function(){function m(){}function w(){this.c={Ad:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)--\>)|(?:([^\\s>]+)\\s*((?:(?:[^\"'>]+)|(?:\"[^\"]*\")|(?:'[^']*'))*)\\/?>))","g")}}var r=KISSY,I=r.Editor,A=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,y={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},t=I.m;r.augment(w,{Ba:m,Pd:m,ma:m,Ld:m,Ra:m,parse:function(s){for(var q,
g,f=0,d;q=this.c.Ad.exec(s);){g=q.index;if(g>f){f=s.substring(f,g);d?d.push(f):this.ma(f)}f=this.c.Ad.lastIndex;if(g=q[1]){g=g.toLowerCase();if(d&&t.Dc[g]){this.Ld(d.join(""));d=U}if(!d){this.Pd(g);continue}}if(d)d.push(q[0]);else if(g=q[3]){g=g.toLowerCase();if(!/="/.test(g)){var l={},B;q=q[4];var i=!!(q&&q.charAt(q.length-1)=="/");if(q)for(;B=A.exec(q);){var a=B[1].toLowerCase();B=B[2]||B[3]||B[4]||"";l[a]=!B&&y[a]?a:B}this.Ba(g,l,i);if(!d&&t.Dc[g])d=[]}}else if(g=q[2])this.Ra(g)}s.length>f&&this.ma(s.substring(f,
s.length))}});I.j=w;I.HtmlParser=w});
KISSY.Editor.add("htmlparser-basicwriter",function(){function m(){this.c={l:[]}}var w=KISSY,r=w.Editor,I=r.k;w.augment(m,{vb:function(A){this.c.l.push("<",A)},wb:function(A,y){y?this.c.l.push(" />"):this.c.l.push(">")},kb:function(A,y){if(typeof y=="string")y=I.nc(y);this.c.l.push(" ",A,'="',y,'"')},lb:function(A){this.c.l.push("</",A,">")},text:function(A){this.c.l.push(A)},N:function(A){this.c.l.push("<!--",A,"--\>")},write:function(A){this.c.l.push(A)},reset:function(){this.c.l=[];this.c.B=X},
ic:function(A){var y=this.c.l.join("");A&&this.reset();return y}});r.j.Fb=m;r.j.BasicWriter=m;w=m.prototype;r.k.o(w,{openTag:w.vb,openTagClose:w.wb,attribute:w.kb,closeTag:w.lb,text:w.text,comment:w.N,write:w.write,reset:w.reset,getHtml:w.ic})});
KISSY.Editor.add("htmlparser-htmlwriter",function(){function m(){m.superclass.constructor.call(this);this.Bd="\t";this.Ff=" />";this.wf="\n";this.ff=y;this.Gf=A;this.c.B=y;this.c.G="";this.c.rules={};var t=r.m,s;for(s in I.mix({},t.Eb,t.Xa,t.Db,t.Hc))this.Da(s,{B:A,Pe:A,ac:A,gd:!t[s]["#"],Oe:A});this.Da("br",{ac:A});this.Da("title",{B:y,ac:y});this.Da("style",{B:y,gd:A});this.Da("pre",{B:y})}var w=KISSY,r=w.Editor,I=r.k,A=T,y=X;w.extend(m,r.j.Fb,{vb:function(t){var s=this.c.rules[t];if(this.c.B)this.G();
else if(s&&s.Pe){this.Pa();this.G()}this.c.l.push("<",t)},wb:function(t,s){var q=this.c.rules[t];if(s)this.c.l.push(this.Ff);else{this.c.l.push(">");if(q&&q.B)this.c.G+=this.Bd}q&&q.ac&&this.Pa()},kb:function(t,s){if(typeof s=="string"){this.ff&&(s=s.replace(/&amp;/g,"&"));s=I.nc(s)}this.c.l.push(" ",t,'="',s,'"')},lb:function(t){var s=this.c.rules[t];if(s&&s.B)this.c.G=this.c.G.substr(this.Bd.length);if(this.c.B)this.G();else if(s&&s.gd){this.Pa();this.G()}this.c.l.push("</",t,">");s&&s.Oe&&this.Pa()},
text:function(t){if(this.c.B){this.G();t=I.Qa(t)}this.c.l.push(t)},N:function(t){this.c.B&&this.G();this.c.l.push("<!--",t,"--\>")},Pa:function(){this.c.l.length>0&&this.c.l.push(this.wf);this.c.B=A},G:function(){this.c.l.push(this.c.G);this.c.B=y},Da:function(t,s){var q=this.c.rules[t];if(q)I.mix(q,s);else this.c.rules[t]=s}});r.j.Yf=m;r.j.HtmlWriter=m;w=m.prototype;r.k.o(w,{openTag:w.vb,openTagClose:w.wb,attribute:w.kb,closeTag:w.lb,text:w.text,comment:w.N,lineBreak:w.Pa,indentation:w.G,setRules:w.Da})});
KISSY.Editor.add("htmlparser-fragment",function(){function m(){this.children=[];this.parent=I;this.c={S:w,mc:r}}var w=T,r=X,I=U,A=KISSY.Editor,y={colgroup:1,dd:1,dt:1,li:1,option:1,p:1,td:1,tfoot:1,th:1,thead:1,tr:1},t=KISSY,s=A.k,q=A.n,g=A.m,f=s.mix({table:1,ul:1,ol:1,dl:1},g.table,g.ul,g.ol,g.dl),d=g.Yd,l=g.Db;m.Ib=function(B,i){function a(h){var n;if(o.length>0)for(var u=0;u<o.length;u++){var p=o[u],z=p.name,O=g[z],P=k.name&&g[k.name];if((!P||P[z])&&(!h||!O||O[h]||!g[h])){if(!n){b();n=1}p=p.clone();
p.parent=k;k=p;o.splice(u,1);u--}}}function b(){for(;D.length;)k.add(D.shift())}function e(h,n,u){n=n||k||C;if(i&&!n.type){var p,z;if((p=h.attributes&&(z=h.attributes._ke_real_element_type)?z:h.name)&&!(p in g.Cc)&&!(p in g.Eb)){p=k;k=n;j.Ba(i,{});n=k;if(u)k=p}}if(h.c.S&&h.name!="pre"){u=h.children.length;if((p=h.children[u-1])&&p.type==q.f)if(z=s.Sa(p.value))p.value=z;else h.children.length=u-1}n.add(h);if(h.yb){k=h.yb;delete h.yb}}var j=new A.j,C=new m,o=[],D=[],k=C,v=r,J;j.Ba=function(h,n,u){var p=
new A.j.Ic(h,n);if(p.pc&&u)p.rb=w;if(g.ca[h])o.push(p);else{if(h==="pre")v=w;else if(h==="br"&&v){k.add(new A.j.Lb("\n"));return}if(h==="br")D.push(p);else{var z=k.name,O=z&&(g[z]||(k.c.S?g.div:g.span));if(O&&!p.pc&&!k.pc&&!O[h]){O=r;var P;if(h in d&&z in d){z=k.children;(z=z[z.length-1])&&z.name in l||e(z=new A.j.Ic("li"),k);J=k;P=z}else if(h==z)e(k,k.parent);else{if(f[z])J||(J=k);else{e(k,k.parent,w);y[z]||o.unshift(k)}O=w}k=P?P:k.yb||k.parent;if(O){j.Ba.apply(this,arguments);return}}a(h);b();p.parent=
k;p.yb=J;J=0;if(p.rb)e(p);else k=p}}};j.Pd=function(h){for(var n=o.length-1;n>=0;n--)if(h==o[n].name){o.splice(n,1);return}for(var u=[],p=[],z=k;z.type&&z.name!=h;){z.c.S||p.unshift(z);u.push(z);z=z.parent}if(z.type){for(n=0;n<u.length;n++){var O=u[n];e(O,O.parent)}k=z;if(k.name=="pre")v=r;z.c.S&&b();e(z,z.parent);if(z==k)k=k.parent;o=o.concat(p)}if(h=="body")i=r};j.ma=function(h){if(!k.c.mc&&!v){h=s.Qa(h);if(h.length===0)return}b();a();if(i&&(!k.type||k.name=="body")&&s.trim(h))this.Ba(i,{});v||
(h=h.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));k.add(new A.j.Lb(h))};j.Ld=function(){};j.Ra=function(h){k.add(new A.j.$d(h))};j.parse(B);for(b();k.type;){var x=k.parent,c=k;if(i&&(!x.type||x.name=="body")&&!g.Cc[c.name]){k=x;j.Ba(i,{});x=k}x.add(c);k=x}return C};t.augment(m,{add:function(B){var i=this.children.length;if(i=i>0&&this.children[i-1]||I){if(B.c.S&&i.type==q.f){i.value=s.Sa(i.value);if(i.value.length===0){this.children.pop();this.add(B);return}}i.next=B}B.xb=i;B.parent=this;this.children.push(B);
this.c.mc=B.type==q.f||B.type==q.e&&!B.c.S},ba:function(B,i){var a;this.filterChildren=this.gc=function(){var b=new A.j.Fb;this.X.call(this,b,i,w);b=b.ic();this.children=(new m.Ib(b)).children;a=1};!this.name&&i&&i.Nd(this);this.X(B,a?I:i)},X:function(B,i){for(var a=0;a<this.children.length;a++)this.children[a].ba(B,i)}});A.j.Ea=m;A.j.Fragment=m;m.FromHtml=m.Ib;t=m.prototype;A.k.o(t,{add:t.add,writeHtml:t.ba,writeChildrenHtml:t.X})});
KISSY.Editor.add("htmlparser-element",function(){function m(y,t){y=y[0];t=t[0];return y<t?-1:y>t?1:0}function w(y,t){this.name=y;this.attributes=t||(t={});this.children=[];var s=t.qg||y,q=r.m;s=!!(q.Eb[s]||q.Xa[s]||q.Db[s]||q.Hc[s]||q.Gc[s]||s=="br");var g=!!q.Cb[y];this.rb=g;this.pc=!q[y];this.c={S:s,mc:g||!s}}var r=KISSY.Editor,I=r.n;KISSY.augment(w,{type:I.e,add:r.j.Ea.prototype.add,clone:function(){return new w(this.name,this.attributes)},ba:function(y,t){var s=this.attributes,q=this,g=q.name,
f,d,l,B;q.gc=function(){if(!B){var b=new r.j.Fb;r.j.Ea.prototype.X.call(q,b,t);q.children=(new r.j.Ea.Ib(b.ic())).children;B=1}};q.filterChildren=q.gc;if(t){for(;;){if(!(g=t.Md(g)))return;q.name=g;if(!(q=t.sc(q)))return;q.parent=this.parent;if(q.name==g)break;if(q.type!=I.e){q.ba(y,t);return}g=q.name;if(!g){this.X.call(q,y,B?U:t);return}}s=q.attributes}y.vb(g,s);for(var i=[],a=0;a<2;a++)for(f in s){d=f;l=s[f];if(a==1)i.push([f,l]);else if(t){for(;;)if(d=t.Kd(f))if(d!=f){delete s[f];f=d}else break;
else{delete s[f];break}if(d)if((l=t.Jd(q,d,l))===X)delete s[d];else s[d]=l}}y.Gf&&i.sort(m);s=i.length;for(a=0;a<s;a++){f=i[a];y.kb(f[0],f[1])}y.wb(g,q.rb);if(!q.rb){this.X.call(q,y,B?U:t);y.lb(g)}},X:function(){r.j.Ea.prototype.X.apply(this,arguments)}});r.j.Ic=w;r.j.Element=w;var A=w.prototype;r.k.o(A,{type:A.type,add:A.add,clone:A.clone,writeHtml:A.ba,writeChildrenHtml:A.X})});
KISSY.Editor.add("htmlparser-filter",function(){function m(f){this.c={dc:[],Xb:[],elements:{Fc:0},attributes:{Fc:0}};f&&this.cd(f,10)}function w(f,d){for(var l=0;f&&l<d.length;l++){var B=d[l];f=f.replace(B[0],B[1])}return f}function r(f,d,l){if(typeof d=="function")d=[d];var B,i;i=f.length;var a=d&&d.length;if(a){for(B=0;B<i&&f[B].wc<l;B++);for(i=a-1;i>=0;i--)if(a=d[i]){a.wc=l;f.splice(B,0,a)}}}function I(f,d,l){if(d)for(var B in d){var i=f[B];f[B]=A(i,d[B],l);i||f.Fc++}}function A(f,d,l){if(d){d.wc=
l;if(f){if(f.splice)r(f,d,l);else{f=f.wc>l?[d,f]:[f,d];f.filter=y}return f}else return d.filter=d}}function y(f){for(var d=f.type||f instanceof s.j.Ea,l=0;l<this.length;l++){if(d)var B=f.type,i=f.name;var a=this[l].apply(window,arguments);if(a===g)return a;if(d){if(a&&(a.name!=i||a.type!=B))return a}else if(typeof a!="string")return a;a!=undefined&&(f=a)}return f}var t=KISSY,s=t.Editor,q=s.n,g=X;t.augment(m,{cd:function(f,d){if(typeof d!="number")d=10;r(this.c.dc,f.dc,d);r(this.c.Xb,f.Xb,d);I(this.c.elements,
f.elements,d);I(this.c.attributes,f.attributes,d);this.c.text=A(this.c.text,f.text,d)||this.c.text;this.c.N=A(this.c.N,f.N,d)||this.c.N;this.c.zb=A(this.c.zb,f.zb,d)||this.c.zb},Md:function(f){return w(f,this.c.dc)},Kd:function(f){return w(f,this.c.Xb)},ma:function(f){var d=this.c.text;return d?d.filter(f):f},Ra:function(f,d){var l=this.c.N;return l?l.filter(f,d):f},Nd:function(f){var d=this.c.zb;return d?d.filter(f):f},sc:function(f){for(var d=[this.c.elements["^"],this.c.elements[f.name],this.c.elements.Pf],
l,B=0;B<3;B++)if(l=d[B]){l=l.filter(f,this);if(l===g)return U;if(l&&l!=f)return this.Od(l);if(f.parent&&!f.name)break}return f},Od:function(f){var d=f.type;return d==q.e?this.sc(f):d==q.f?new s.j.Lb(this.ma(f.value)):U},Jd:function(f,d,l){if(d=this.c.attributes[d]){f=d.filter(l,f,this);if(f===g)return g;if(typeof f!="undefined")return f}return l}});s.j.Xf=m;t=m.prototype;s.k.o(t,{addRules:t.cd,onElementName:t.Md,onAttributeName:t.Kd,onText:t.ma,onComment:t.Ra,onFragment:t.Nd,onElement:t.sc,onNode:t.Od,
onAttribute:t.Jd});s.j.Filter=m});KISSY.Editor.add("htmlparser-text",function(){function m(A){this.value=A;this.c={S:I}}var w=KISSY,r=w.Editor,I=X;w.augment(m,{type:r.n.f,ba:function(A,y){var t=this.value;y&&!(t=y.ma(t,this))||A.text(t)}});r.j.Lb=m;r.j.Text=m});
KISSY.Editor.add("htmlparser-comment",function(){function m(I){this.value=I;this.c={S:X}}var w=KISSY.Editor,r=w.n;w.j.$d=m;w.j.Comment=m;m.prototype={constructor:m,type:r.ce,ba:function(I,A){var y=this.value;if(A){if(!(y=A.Ra(y,this)))return;if(typeof y!="string"){y.parent=this.parent;y.ba(I,A);return}}I.N(y)}}});
KISSY.Editor.add("button",function(){var m=KISSY,w=m.Editor;if(w.je)m.log("TripleButton attach twice","warn");else{m=m.UIBase.create([m.UIBase.Box],{Dg:function(){var r=this,I=r.get("el");I.on("click",r.ue,r);I.on("mousedown",function(){r.get("state")=="off"&&I.addClass("ke-triplebutton-active")});I.on("mouseup mouseleave",function(){r.get("state")=="off"&&I.hasClass("ke-triplebutton-active")&&setTimeout(function(){I.removeClass("ke-triplebutton-active")},300)})},xg:function(){this.get("el").attr("title",
this.get("title"))},ug:function(r){var I=this.get("el");if(r!==undefined){I.html("<span class='ke-toolbar-item "+r+"'>");I.Ka()}},wg:function(r){var I=this.get("el");r!==undefined&&I.html(r)},vg:function(r){this["_"+r]()},nd:function(){this.Ce=this.get("state");this.set("state","disabled")},pd:function(){this.get("state")=="disabled"&&this.set("state",this.Ce)},ue:function(r){this.fire(this.get("state")+"Click",{mg:r});this.fire("click",{lg:this.get("state")+"Click"});r.preventDefault()},Fg:function(){this.set("state",
"on")},Eg:function(){this.set("state","off")},sg:function(){var r=this.get("el");r.removeClass("ke-triplebutton-off ke-triplebutton-disabled");r.addClass("ke-triplebutton-on")},rg:function(){var r=this.get("el");r.removeClass("ke-triplebutton-on ke-triplebutton-disabled");r.addClass("ke-triplebutton-off")},og:function(){var r=this.get("el");r.removeClass("ke-triplebutton-off ke-triplebutton-on");r.addClass("ke-triplebutton-disabled")}},{Zd:{If:{value:"off"},df:{value:"ke-triplebutton ke-triplebutton-off"},
Ng:{value:{hideFocus:T,tabIndex:-1}},Og:{value:"a"},title:{},Gg:{},text:{}}});m.eg="on";m.cg="off";m.ae="disabled";m.fg="ke-triplebutton-on";m.dg="ke-triplebutton-off";m.Vf="ke-triplebutton-disabled";w.je=m}});
KISSY.Editor.add("select",function(){function m(g){m.superclass.constructor.call(this,g);this.xe()}var w=KISSY,r=w.Node,I=w.Event,A=w.DOM,y=w.Editor;if(y.he)w.log("ke select attach more");else{m.ae=0;m.Wf=1;var t=y.m;m.Zd={ah:{},P:{},Ve:{},wa:{},Mg:{},value:{},width:{},title:{},uf:{},align:{value:["l","b"]},Ug:{hh:function(){for(var g=this.P.parent();g;){var f=g.d();if(t[f]&&t[f].div)return g;g=g.parent()}return new r(document.body)}},If:{value:1}};m.Jg=function(g){for(var f=g.width(),d=[],l=g.all("option"),
B=0;B<l.length;B++){var i=l[B];d.push({name:A.html(i),value:A.attr(i,"value")})}return new m({width:f+"px",P:g,uf:d,Ve:"ke-combox",value:g.val()})};var s=y.k.Je,q=y.k.Ze;w.extend(m,w.Base,{xe:function(){var g=this.get("container"),f=this.get("el"),d=new r("<span class='ke-select-wrap'><a onclick='return false;' class='ke-select'><span class='ke-select-text'><span class='ke-select-text-inner'></span></span><span class='ke-select-drop-wrap'><span class='ke-select-drop'></span></span></a></span>"),l=
this.get("title")||"",B=this.get("cls"),i=d.one(".ke-select-text"),a=d.one(".ke-select-text-inner");d.one(".ke-select-drop");this.get("value")!==undefined?a.html(this.Wc(this.get("value"))):a.html(l);i.css("width",this.get("width"));d.Ka();l&&d.attr("title",l);B&&d.addClass(B);if(f)f[0].parentNode.replaceChild(d[0],f[0]);else g&&d.appendTo(g);d.on("click",this.we,this);this.P=d;this.title=a;this.Xc=d.one("a.ke-select");y.k.Gd(this,"_prepare","_real");this.on("afterValueChange",this.Fe,this);this.on("afterStateChange",
this.Ee,this)},Wc:function(g){var f=this.get("title")||"",d=this.get("items");if(this.get("showValue"))return g||f;for(var l=0;l<d.length;l++){var B=d[l];if(B.value==g){f=B.name;break}}return f},Fe:function(g){this.title.html(this.Wc(g.tb))},Yc:function(g){g=g.tb;var f=this.ad;f.html("");if(g)for(var d=0;d<g.length;d++){var l=g[d];(new r("<a class='ke-select-menu-item' href='#' data-value='"+l.value+"'>"+l.name+"</a>",l.Ne)).appendTo(f).Ka()}this.Wb=f.all("a")},val:function(g){if(g!==undefined){this.set("value",
g);return this}else return this.get("value")},$c:function(){this.T.get("visible")&&this.Be()},ye:function(){function g(b){b=new r(b.target);d.contains(b)||d.g(b)||i.hide()}var f=this,d=f.P,l=f.get("popUpWidth"),B=f.Xc,i=new y.de({Bg:T,$g:f.get("menuContainer"),content:"<div>",Qg:X,df:"ke-menu",width:l?l:d.width(),zIndex:y.Yb(y.Bc.fe),Rg:X}),a=f.get("items");s.call(f,i);l=i.get("contentEl").one("div");f.T=i;I.on(window,"resize",f.$c,f);s.call(f,function(){I.remove(window,"resize",f.$c,f)});f.get("title")&&
(new r("<div class='ke-menu-title ke-select-menu-item' style='margin-top:-6px;' >"+f.get("title")+"</div>")).appendTo(l);f.ad=(new r("<div>")).appendTo(l);f.Yc({tb:a});i.on("show",function(){B.addClass("ke-select-active")});i.on("hide",function(){B.removeClass("ke-select-active")});I.on(document,"click",g);s.call(f,function(){I.remove(document,"click",g)});f.get("doc")&&I.on(f.get("doc"),"click",g);l.on("click",f.De,f);f.Wb=f.ad.all("a");I.on(l[0],"mouseenter",function(){f.Wb.removeClass("ke-menu-selected")});
s.call(f,l);f.on("afterItemsChange",f.Yc,f);f.yf=l},Ee:function(g){var f=this.P;g.tb==1?f.removeClass("ke-select-disabled"):f.addClass("ke-select-disabled")},pd:function(){this.set("state",1)},nd:function(){this.set("state",0)},De:function(g){g.halt();var f=this.T,d=this.yf;if(g=(new r(g.target)).Nc(function(i){return d.contains(i)&&i.d()=="a"},T)){var l=this.get("value"),B=g.attr("data-value");this.set("value",B);this.fire("click",{tb:B,Wg:l,name:g.html()});f.hide()}},Be:function(){var g=this.P,
f=g.offset(),d=w.clone(f),l=this.T.get("el").height(),B=this.T.get("el").width(),i=A.scrollTop(),a=A.scrollLeft(),b=A.viewportHeight(),e=A.viewportWidth();e=a+e-60;b=i+b;var j=f.top+(g.height()-2);g=f.left+g.width()-2;var C=this.get("align"),o=C[0];if(C[1]=="b"){f.top=j;if(f.top+l>b&&d.top-i>b-j)f.top=d.top-l}else{f.top=d.top-l;if(f.top<i&&d.top-i<b-j)f.top=j}if(o=="l"){if(f.left+B>e&&g-a>e-d.left)f.left=g-B}else{f.left=g-B;if(f.left<a&&g-a<e-d.left)f.left=d.left}this.T.set("xy",[f.left,f.top]);this.T.show()},
we:function(g){if(!this.qc){g.preventDefault();var f=this;g=f.P;var d=f.get("value");if(!g.hasClass("ke-select-disabled"))if(f.Xc.hasClass("ke-select-active"))f.T&&f.T.hide();else{f.qc=T;y.use("overlay",function(){f.qc=X;f.ye();d&&f.T&&f.Wb.each(function(l){l.attr("data-value")==d?l.addClass("ke-menu-selected"):l.removeClass("ke-menu-selected")})})}}},ya:function(){q.call(this);this.P.detach();this.P.remove()}});y.he=m}});
