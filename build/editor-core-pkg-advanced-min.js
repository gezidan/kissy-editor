/*
 Constructor for kissy editor,dependency moved to independent module
 thanks to CKSource's intelligent work on CKEditor
 @author: yiminghe@gmail.com, lifesinger@gmail.com
 @version: 2.1.5
 @buildtime: 2011-01-12 23:00:39
*/
var T=true,V=null,Y=false;
KISSY.add("editor",function(k){function x(u,q){var l=this;if(!(l instanceof x))return new x(u,q);if(k.isString(u))u=k.one(u);u=I.C(u);q=q||{};q.Bf=q.pluginConfig||{};l.va=q;q.pluginConfig=q.Bf;l.cfg=q;k.app(l,k.EventTarget);var d=["htmldataprocessor","enterkey","clipboard"],f=A;l.use=function(e,i){e=e.split(",");if(!f)for(var r=0;r<d.length;r++){var j=d[r];k.inArray(j,e)||e.unshift(j)}l.ready(function(){k.use.call(l,e.join(","),function(){for(var a=0;a<e.length;a++)l.Zd(e[a]);i&&i.call(l);if(!f){l.setData(u.val());
if(q.focus)l.focus();else(a=l.getSelection())&&a.removeAllRanges();f=C}},{global:x})});return l};l.use=l.use;l.Config.base=x.Config.base;l.Config.debug=x.Config.debug;l.Config.componentJsName=p;l.rf(u);return l}function p(){return"plugin-min.js?t=2011-01-12 23:00:39"}var I=k.DOM,C=T,A=Y;k.app(x,k.EventTarget);x.Config.base=k.Config.base+"editor/plugins/";x.Config.debug=k.Config.debug;x.Config.componentJsName=p;k.Editor=x;k.Editor=x});
KISSY.Editor.add("utils",function(k){var x=V,p=KISSY,I=p.Node,C=p.DOM,A=p.UA,u=p.Event,q;if(A.ie)q=document.documentMode||A.ie;var l={od:function(d){d=d.replace(/-min\.(js|css)/i,".$1");k.Config.debug||(d=d.replace(/\.(js|css)/i,"-min.$1"));if(d.indexOf("?t")==-1){d+=d.indexOf("?")!=-1?"&":"?";d+="t="+encodeURIComponent("2011-02-11 16:22:45")}return k.Config.Eg+d},Id:function(d,f,e){var i=d[f],r=d[e];d[f]=function(){i.apply(this,arguments);d[f]=d[e];return r.apply(this,arguments)}},nf:function(d,
f,e,i){e=e.defaultView||e.parentWindow;d-=C.scrollLeft(e);f-=C.scrollTop(e);if(i)if(e!=(i.defaultView||i.parentWindow)&&e.frameElement){i=C.Rb(e.frameElement,i);d+=i.left;f+=i.top}return{left:d,top:f}},Yd:function(){for(var d,f=0,e=arguments.length;f<e;f++){var i=arguments[f];try{d=i();break}catch(r){}}return d},Ne:function(d,f){if(!d&&!f)return T;if(!d||!f||d.length!=f.length)return Y;for(var e=0;e<d.length;e++)if(d[e]!==f[e])return Y;return T},wd:function(d,f,e){d=d.documentElement;for(var i=0;d&&
i<f.length;i++){var r=f[i];if(e)for(var j=-1,a=0;a<d.childNodes.length;a++){var b=d.childNodes[a];if(!(e===T&&b.nodeType==3&&b.previousSibling&&b.previousSibling.nodeType==3)){j++;if(j==r){d=b;break}}}else d=d.childNodes[r]}return d?new I(d):x},Ve:function(d){for(var f in d)d[f].Pc(d,T)},pc:function(d){return d.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/,"&gt;")},Qa:function(d){return d.replace(/^\s+/,"")},Sa:function(d){return d.replace(/\s+$/,"")},trim:function(d){return this.Qa(this.Sa(d))},
mix:function(){for(var d={},f=0;f<arguments.length;f++)d=p.mix(d,arguments[f]);return d},rb:function(){if(!A.ie)return Y;var d=document.domain,f=window.location.hostname;return d!=f&&d!="["+f+"]"},bf:function(d,f){return Array(f+1).join(d)},Mf:function(d,f,e){e=e||150;if(e===-1)return function(){d.apply(f,arguments)};var i=(new Date).getTime();return function(){var r=(new Date).getTime();if(r-i>e){i=r;d.apply(f,arguments)}}},Re:function(d,f,e){e=e||0;var i=x;return function(){i&&clearTimeout(i);var r=
arguments;i=setTimeout(function(){return d.apply(f,r)},e)}},isNumber:function(d){return/^\d+(.\d+)?$/.test(p.trim(d))},Of:function(d){for(var f=0;f<d.length;f++){var e=C.C(d[f]),i=p.trim(e.val()),r=e.attr("data-verify");e=e.attr("data-warning");if(r&&!RegExp(r).test(i)){alert(e);return Y}}return T},If:function(d,f){d.on("sourcemode",f.pd,f);d.on("wysiwygmode",f.rd,f)},Ef:function(d){var f=d.attr("placeholder");if(f&&!A.webkit){d.addClass("ke-input-tip");d.val(f)}else A.webkit&&d.val("")},kh:function(d,
f){d.removeClass("ke-input-tip");d.val(f)},Af:function(d,f){d.attr("placeholder",f);if(!A.webkit){d.on("blur",function(){if(!p.trim(d.val())){d.addClass("ke-input-tip");d.val(f)}});d.on("focus",function(){d.removeClass("ke-input-tip");p.trim(d.val())==f&&d.val("")})}},Ue:function(d){d=d[0]||d;for(var f=p.makeArray(d.childNodes),e=0;e<f.length;e++){var i=f[e];i.nodeType==k.n.f&&!p.trim(i.nodeValue)&&d.removeChild(i)}},qf:function(d){return!d?d:String(d).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,
"&lt;").replace(/"/g,"&quot;")},pf:function(d){return!d?d:String(d).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},ff:function(d,f){return d.toLowerCase()==f.toLowerCase()},Jd:function(d){d=p.clone(d);for(var f in d)if(d.hasOwnProperty(f)){var e=d[f];if(p.isFunction(e))d[f]=e()}return d},af:function(d,f,e){function i(){var B={responseText:"",responseXML:x};B.Me=d?d.Me:x;try{var y;if((y=A.ie?j.contentWindow.document:j.contentDocument||window.frames[r].document)&&
y.body)B.responseText=y.body.innerHTML;B.responseXML=y&&y.XMLDocument?y.XMLDocument:y}catch(s){p.log(s)}u.remove(j,"load",i);d.Se&&d.Se(B);setTimeout(function(){C.j(j)},100)}var r=p.guid("form-upload-"),j=document.createElement("iframe");j.id=r;j.name=r;j.className="ke-hidden";var a="document.open();"+(l.rb()?'document.domain="'+document.domain+'";':"")+"document.close();";if(A.ie)j.src=A.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";p.log("doFormUpload : "+j.src);document.body.appendChild(j);
if(A.ie)document.frames[r].name=r;a=C.Wc(d.form);var b={target:a.target,method:a.method,encoding:a.encoding,enctype:a.enctype,action:a.action};a.target=r;a.method="POST";a.enctype=a.encoding="multipart/form-data";if(e)a.action=e;var g;if(f){g=[];f=k.k.Jd(f);for(var o in f)if(f.hasOwnProperty(o)){e=document.createElement("input");e.type="hidden";e.name=o;e.value=f[o];a.appendChild(e);g.push(e)}}u.on(j,"load",i);a.submit();a.target=b.target;a.method=b.method;a.enctype=b.enctype;a.encoding=b.encoding;
a.action=b.action;if(g){f=0;for(o=g.length;f<o;f++)C.j(g[f])}return j},o:function(d,f){for(var e in f)d[e]=f[e]},map:function(d,f){for(var e=0;e<d.length;e++)d[e]=f(d[e]);return d},Ba:q,Cf:function(d){A.ie?d.ta():d.attr("onmousedown","return false;")},Wg:function(d){d=d.attributes;return d.type=="application/x-shockwave-flash"||/\.swf(?:$|\?)/i.test(d.src||"")},Ke:function(){var d=this.jb=this.jb||[];d.push.apply(d,p.makeArray(arguments))},$e:function(){for(var d=this.jb||[],f=0;f<d.length;f++){var e=
d[f];if(p.isFunction(e))e();else{e.detach&&e.detach();e.za&&e.za();e.nodeType&&e.remove&&e.remove()}}this.jb=[]}};k.k=l;k.Utils=l;A.Ba=l.Ba;l.o(l,{debugUrl:l.od,lazyRun:l.Id,getXY:l.nf,tryThese:l.Yd,arrayCompare:l.Ne,getByAddress:l.wd,clearAllMarkers:l.Ve,htmlEncodeAttr:l.pc,ltrim:l.Qa,rtrim:l.Sa,trim:l.trim,mix:l.mix,isCustomDomain:l.rb,duplicateStr:l.bf,buffer:l.Re,isNumber:l.isNumber,verifyInputs:l.Of,sourceDisable:l.If,resetInput:l.Ef,placeholder:l.Af,clean:l.Ue,htmlEncode:l.qf,htmlDecode:l.pf,
equalsIgnoreCase:l.ff,normParams:l.Jd,throttle:l.Mf,doFormUpload:l.af,map:l.map})});
KISSY.Editor.add("dom",function(k){function x(a){if(a&&!a[0])return new q(a);return a}function p(a){return a[0]||a}function I(a){return a.replace(/-(\w)/g,function(b,g){return g.toUpperCase()})}var C=KISSY,A=C.DOM,u=C.UA,q=C.Node,l=k.k,d={abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1};k.n={e:1,f:3,ee:8,dg:11};k.NODE=k.n;k.$a={ea:0,ge:1,da:2,aa:4,$:8,Kc:16};k.POSITION=
k.$a;var f=k.n,e=k.$a,i={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},r={hr:1},j={C:x,Wc:p,g:function(a,b){if(!a&&!b)return T;if(!a||!b)return Y;a=p(a);b=p(b);return a===b},qa:function(a,b){a=x(a);var g=C.mix(C.mix({},r),b||{});return i[a.css("display")]||g[a.d()]},pa:function(a){return a&&"scrollTo"in a&&a.document?a:a&&a.nodeType===9?a.defaultView||a.parentWindow:
Y},t:function(a){a=p(a);for(var b=a.parentNode.childNodes,g=0;g<b.length;g++)if(b[g]===a)return g;return-1},me:function(a,b){a=p(a);var g=a.firstChild;if((g=g&&new q(g))&&b&&!b(g))g=g.Ka(b);return g},Uc:function(a,b,g){a=p(a);A.j(a);b=p(b);g?b.insertBefore(a,b.firstChild):b.appendChild(a)},d:function(a){a=p(a);var b=a.nodeName.toLowerCase();if(u.ie)if((a=a.scopeName)&&a!="HTML")b=a.toLowerCase()+":"+b;return b},Sc:function(a,b){if(a.d()!=b.d())return Y;var g=a[0].attributes,o=b[0].attributes,B=g.length,
y=o.length;if(B!=y)return Y;for(var s=0;s<B;s++){var w=g[s],z=w.name;if(w.specified&&a.attr(z)!=b.attr(z))return Y}if(l.Ba<8)for(s=0;s<y;s++){w=o[s];z=w.name;if(w.specified&&a.attr(z)!=b.attr(z))return Y}return T},Sb:function(a){a=p(a).childNodes;for(var b=0,g=a.length;b<g;b++){var o=a[b],B=o.nodeType;if(!(B==f.e&&o.getAttribute("_ke_bookmark")))if(B==f.e&&!j.Sb(o)||B==f.f&&C.trim(o.nodeValue))return Y}return T},Tb:function(a,b,g){a=p(a);b=b[0]||b;if(a!=b)if(g)for(;g=a.lastChild;)b.insertBefore(a.removeChild(g),
b.firstChild);else for(;g=a.firstChild;)b.appendChild(a.removeChild(g))},ra:function(){function a(b,g,o){if(g[0]&&g[0].nodeType==f.e){for(var B=[];g.attr("_ke_bookmark")||g.Sb();){B.push(g);g=o?new q(g[0].nextSibling):new q(g[0].previousSibling);if(!g[0]||g[0].nodeType!=f.e)return}if(b.Sc(g)){for(var y=o?b[0].lastChild:b[0].firstChild;B.length;)B.shift().Uc(b,!o);g.Tb(b,!o);g.j();y[0]&&y[0].nodeType==f.e&&y.ra()}}}return function(b){if(b[0])if(d[b.d()]||b.d()=="a"){a(b,new q(b[0].nextSibling),T);
a(b,new q(b[0].previousSibling))}}}(),ta:u.gecko?function(a){a=p(a);a.style.MozUserSelect="none"}:u.webkit?function(a){a=p(a);a.style.ag="none"}:function(a){a=p(a);if(u.ie||u.opera){var b=0;a.setAttribute("unselectable","on");for(var g=a.getElementsByTagName("*");a=g[b++];)switch(a.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:a.setAttribute("unselectable","on")}}},Rb:function(a,b){a=p(a);var g,o=0;g=0;var B=a.ownerDocument.defaultView||a.ownerDocument.parentWindow,
y=a.ownerDocument,s=y.documentElement;b=b||y;if(a.getBoundingClientRect){if(a!==y.body&&s!==a){g=a.getBoundingClientRect();o=g.left+(b===y?A.scrollLeft(B):0);g=g.top+(b===y?A.scrollTop(B):0)}if(b)if(B!=(b.defaultView||b.parentWindow)&&B.frameElement){B=j.Rb(B.frameElement,b);o+=B.left;g+=B.top}}return{left:o,top:g}},oe:function(a){return(a=p(a))&&a.contentWindow.document},ha:function(a,b){a=p(a);var g=a.ownerDocument;if(!(!a||a.nodeType!=f.f)){if(u.ie&&b==a.nodeValue.length){var o=g.createTextNode("");
A.insertAfter(o,a);return new q(o)}o=new q(a.splitText(b));if(g.documentMode){g=g.createTextNode("");A.insertAfter(g,o[0]);A.j(g)}return o}},Ub:function(a,b){a=x(a);var g=[];do g[b?"push":"unshift"](a);while(a=a.parent());return g},K:function(a,b,g){a=p(a);a=a.cloneNode(b);if(!g){var o=function(B){if(B.nodeType==f.e){B.removeAttribute("id");B=B.childNodes;for(var y=0;y<B.length;y++)o(B[y])}};o(a)}return new q(a)},v:function(a,b,g,o){a=p(a);if(o&&!o.call){var B=o[0]||o;o=function(s){s=s[0]||s;return s!==
B}}b=!b&&a.firstChild;var y=new q(a);if(!b){if(a.nodeType==f.e&&o&&o(a,T)===Y)return V;b=a.nextSibling}for(;!b&&(y=y.parent());){if(o&&o(y,T)===Y)return V;b=y[0].nextSibling}if(!b)return V;b=A.C(b);if(o&&o(b)===Y)return V;if(g&&g!=b[0].nodeType)return b.v(Y,g,o);return b},ga:function(a,b,g,o){a=p(a);if(o&&!o.call){var B=o[0]||o;o=function(s){s=s[0]||s;return s!==B}}b=!b&&a.lastChild;var y=new q(a);if(!b){if(a.nodeType==f.e&&o&&o(a,T)===Y)return V;b=a.previousSibling}for(;!b&&(y=y.parent());){if(o&&
o(y,T)===Y)return V;b=y[0].previousSibling}if(!b)return V;b=A.C(b);if(o&&o(b)===Y)return V;if(g&&b[0].nodeType!=g)return b.ga(Y,g,o);return b},Qb:function(a,b){if(a.g(b))return a;if(b[0].nodeType!=f.f&&b.contains(a))return b;var g=a[0].nodeType==f.f?a.parent():a;do if(g[0].nodeType!=f.f&&g.contains(b))return g;while(g=g.parent());return V},Oc:function(a,b,g){a=p(a);if(!g)a=a.parentNode;if(b&&!C.isFunction(b)){var o=b;b=function(B){return B.d()==o}}for(;a&&a.nodeType!=9;){if(!b||b(new q(a))===T)return new q(a);
a=a.parentNode}return V},eb:l.Ba<9?function(a,b){a=p(a);var g=a.getAttributeNode(b);return!!(g&&g.specified)}:function(a,b){a=p(a);return a.hasAttribute(b)},fb:l.Ba<9?function(a){a=p(a);for(var b=a.attributes,g=0;g<b.length;g++){var o=b[g];switch(o.name){case "class":if(a.getAttribute("class"))return T;break;default:if(o.specified)return T}}return Y}:function(a){a=p(a);u.gecko&&a.removeAttribute("_moz_dirty");return a.hasAttributes()},La:function(a,b){var g=p(a),o=p(b);if(g.compareDocumentPosition)return g.compareDocumentPosition(o);
if(g==o)return e.ea;if(g.nodeType==f.e&&o.nodeType==f.e){if(g.contains){if(g.contains(o))return e.Kc+e.aa;if(o.contains(g))return e.$+e.da}if("sourceIndex"in g)return g.sourceIndex<0||o.sourceIndex<0?e.ge:g.sourceIndex<o.sourceIndex?e.aa:e.da}g=a.Ja();o=b.Ja();for(var B=Math.min(g.length,o.length),y=0;y<=B-1;y++)if(g[y]!=o[y]){if(y<B)return g[y]<o[y]?e.aa:e.da;break}return g.length<o.length?e.Kc+e.aa:e.$+e.da},Ja:function(a,b){a=p(a);for(var g=[],o=a.ownerDocument.documentElement,B=a;B&&B!=o;){var y=
B.parentNode,s=-1;if(y){for(var w=0;w<y.childNodes.length;w++){var z=y.childNodes[w];if(!(b&&z.nodeType==3&&z.previousSibling&&z.previousSibling.nodeType==3)){s++;if(z==B)break}}g.unshift(s)}B=y}return g},Pb:function(a,b){var g=new k.Range(a[0].ownerDocument);g.setStartAfter(a);g.setEndAfter(b);var o=g.extractContents();g.insertNode(a.j());a[0].parentNode.insertBefore(o,a[0].nextSibling)},L:function(a,b,g){a=x(a);if(g!==undefined)return a.css(b,g);a=p(a);return a.style[I(b)]},j:function(a,b){var g=
p(a),o=g.parentNode;if(o){if(b)for(var B;B=g.firstChild;)o.insertBefore(g.removeChild(B),g);o.removeChild(g)}return a},hb:function(a){A.Tc(a);A.Vc(a)},Tc:function(a){a=p(a);for(var b;b=a.firstChild;){if(b.nodeType==f.f){var g=l.Qa(b.nodeValue),o=b.nodeValue.length;if(g){if(g.length<o){(new q(b)).ha(o-g.length);a.removeChild(a.firstChild)}}else{a.removeChild(b);continue}}break}},Vc:function(a){a=p(a);for(var b;b=a.lastChild;){if(b.type==f.f){var g=l.Sa(b.nodeValue),o=b.nodeValue.length;if(g){if(g.length<
o){(new q(b)).ha(g.length);a.removeChild(a.lastChild)}}else{a.removeChild(b);continue}}break}if(!u.ie&&!u.opera)(b=a.lastChild)&&b.nodeType==1&&b.nodeName.toLowerCase()=="br"&&b.parentNode.removeChild(b)},Ob:function(a){a=p(a);for(var b=a.lastChild;b&&b.nodeType==f.f&&!C.trim(b.nodeValue);)b=b.previousSibling;if(!b||b.nodeType==f.f||A.d(b)!=="br"){b=u.opera?a.ownerDocument.createTextNode(""):a.ownerDocument.createElement("br");u.gecko&&b.setAttribute("type","_moz");a.appendChild(b)}},sa:function(a,
b){var g=p(a),o;do o=(g=g.previousSibling)&&new q(g);while(o&&b&&!b(o));return o},qe:function(a,b){a=A.C(a);var g=a[0].lastChild;if((g=g&&new q(g))&&b&&!b(g))g=g.sa(b);return g},Ka:function(a,b){var g=p(a),o;do o=(g=g.nextSibling)&&new q(g);while(o&&b&&!b(o));return o},gb:function(a){a=p(a);if(a.outerHTML)return a.outerHTML.replace(/<\?[^>]*>/,"");var b=a.ownerDocument.createElement("div");b.appendChild(a.cloneNode(T));return b.innerHTML},re:function(a,b,g,o){a=A.C(a);var B=a.data("list_marker_id")||
a.data("list_marker_id",C.guid()).data("list_marker_id"),y=a.data("list_marker_names")||a.data("list_marker_names",{}).data("list_marker_names");b[B]=a;y[g]=1;return a.data(g,o)},Pc:function(a,b,g){a=x(a);var o=a.data("list_marker_names"),B=a.data("list_marker_id"),y;for(y in o)a.removeData(y);a.removeData("list_marker_names");if(g){a.removeData("list_marker_id");delete b[B]}},Qc:function(a,b,g){a=p(a);b=x(b);var o=a.attributes;g=g||{};for(var B=0;B<o.length;B++){var y=o[B],s=y.name.toLowerCase(),
w;if(!(s in g))if(s=="checked"&&(w=A.attr(a,s)))b.attr(s,w);else if(y.specified||u.ie&&y.value&&s=="value"){w=A.attr(a,s);if(w===V)w=y.nodeValue;b.attr(s,w)}}if(a.style.cssText!=="")b[0].style.cssText=a.style.cssText},Rc:function(a){a=A.d(a);var b=k.m;return(a=!b.Hc[a]&&(b[a]||b.span))&&a["#"]},Vb:function(a){a=x(a);var b=a[0].ownerDocument,g=A.scrollLeft(b),o=A.scrollTop(b),B=a.offset(),y=B.left;B=B.top;if(A.viewportHeight(b)+o<B||B<o||A.viewportWidth(b)+g<y||y<g)a.scrollIntoView(b)},ne:function(a,
b,g){a=p(a);if(!u.ie&&g)b=g+":"+b;g=[];a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)g.push(new q(a[b]));return g}};C.DOM.pe=function(a){C.mix(A,a);for(var b in a)a.hasOwnProperty(b)&&function(g){q.prototype[g]=function(){var o=[].slice.call(arguments,0);o.unshift(this);return a[g].apply(V,o)}}(b)};l.o(j,{_4e_wrap:j.C,_4e_unwrap:j.Wc,_4e_equals:j.g,_4e_isBlockBoundary:j.qa,_4e_getWin:j.pa,_4e_index:j.t,_4e_first:j.me,_4e_move:j.Uc,_4e_name:j.d,_4e_isIdentical:j.Sc,_4e_isEmptyInlineRemoveable:j.Sb,
_4e_moveChildren:j.Tb,_4e_mergeSiblings:j.ra,_4e_unselectable:j.ta,_4e_getOffset:j.Rb,_4e_getFrameDocument:j.oe,_4e_splitText:j.ha,_4e_parents:j.Ub,_4e_clone:j.K,_4e_nextSourceNode:j.v,_4e_previousSourceNode:j.ga,_4e_commonAncestor:j.Qb,_4e_ascendant:j.Oc,_4e_hasAttribute:j.eb,_4e_hasAttributes:j.fb,_4e_position:j.La,_4e_address:j.Ja,_4e_breakParent:j.Pb,_4e_style:j.L,_4e_remove:j.j,_4e_trim:j.hb,_4e_ltrim:j.Tc,_4e_rtrim:j.Vc,_4e_appendBogus:j.Ob,_4e_last:j.qe,_4e_previous:j.sa,_4e_next:j.Ka,_4e_outerHtml:j.gb,
_4e_setMarker:j.re,_4e_clearMarkers:j.Pc,_4e_getUniqueId:j.pg,_4e_copyAttributes:j.Qc,_4e_isEditable:j.Rc,_4e_scrollIntoView:j.Vb,_4e_getElementsByTagName:j.ne});A.pe(j)});
KISSY.Editor.add("focusmanager",function(k){function x(){var i=this;i.qc=d;l=i;q&&clearTimeout(q);q=setTimeout(function(){i.fire("focus")},100)}function p(){var i=this;i.qc=f;l=e;q&&clearTimeout(q);q=setTimeout(function(){i.fire("blur")},100)}var I=KISSY,C=I.DOM,A=I.Event,u={},q,l;I={dh:function(){for(var i in u){var r=u[i];r.document.designMode="off";r.document.designMode="on"}},Jg:function(){return l},jf:function(i){return u[i]},add:function(i){var r=C.pa(i.document);A.on(r,"focus",x,i);A.on(r,
"blur",p,i)},Df:function(i){u[i.Wb]=i},remove:function(i){delete u[i.Wb];var r=C.pa(i.document);A.remove(r,"focus",x,i);A.remove(r,"blur",p,i)}};var d=T,f=Y,e=V;k.ud=I;k.focusManager=I;k.kf=function(){return u};k.getInstances=k.kf});
KISSY.Editor.add("definition",function(k){var x=T,p=Y,I=k.k,C=document,A=KISSY,u=A.UA,q=A.DOM,l=A.Node,d=A.Event,f=k.ud,e=I.Yd,i=1,r="document.open();"+(I.rb()?'document.domain="'+C.domain+'";':"")+"document.close();",j="<div  class='ke-editor-wrap'  > <div class='"+".ke-editor-tools".substring(1)+"' ></div><div class='"+".ke-textarea-wrap".substring(1)+'\'><iframe  style="width:100%;height:100%;border:none;"  width="100%"  height="100%"  frameborder="0"  title="kissy-editor"  src="'+(u.ie?"javascript:void(function(){"+
encodeURIComponent(r)+"}())":"")+'"  allowTransparency="true" ></iframe></div><div class=\''+".ke-editor-status".substring(1)+"'></div></div>";k.Mc=0;k.db=1;k.SOURCE_MODE=k.Mc;k.WYSIWYG_MODE=k.db;A.augment(k,{rf:function(a){var b=this;b.ib={};b.Ma={};b.ua={};u.ie&&q.addClass(C.body,"ke-ie"+u.ie);if(u.trident)q.addClass(C.body,"ke-trident"+u.trident);else if(u.gecko)q.addClass(C.body,"ke-gecko");else u.webkit&&q.addClass(C.body,"ke-webkit");var g=new l(j);b.df=g;b.Wb=i++;f.Df(b);b.Wa=g.one(".ke-textarea-wrap");
b.wrap=b.Wa;b.Ca=b.Wa.one("iframe");b.iframe=b.Ca;b.Xd=g.one(".ke-editor-tools");b.toolBarDiv=b.Xd;b.W=a;b.textarea=b.W;b.Kf=g.one(".ke-editor-status");b.statusDiv=b.Kf;I.Cf(b.Xd);var o=a.L("width"),B=a.L("height");if(o){g.css("width",o);a.css("width","100%")}b.W.css("display","none");g.insertAfter(a);b.Wa[0].appendChild(a[0]);if(B){b.Wa.css("height",B);a.css("height","100%")}g=b.Ca;if(a.eb("tabindex"))g[0].tabIndex=u.webkit?-1:a[0].tabIndex;b.on("dataReady",function(){b.Be=x;k.fire("instanceCreated",
{cf:b})});u.gecko?g.on("load",b.cd,b):b.cd();b.va.attachForm&&a[0].form&&b.we()},za:function(){if(!this.ue){var a=this.df,b=this.W,g=this.document,o=this.Ca[0].contentWindow;this.Cb();k.ud.remove(this);d.remove(g);d.remove(g.documentElement);d.remove(g.body);d.remove(o);this.Ca.detach();g=this.ua;for(var B in g)if(g.hasOwnProperty(B)){o=g[B];o.za&&o.za()}this.fire("destroy");b.insertBefore(a);a.remove();b.css({width:a.css("width"),height:this.Wa.css("height")});b.show();this.ib=this.Ma=this.ua=V;
this.detach();this.ue=T}},we:function(){var a=this,b=new l(a.W[0].form);b.on("submit",a.Cb,a);a.on("destroy",function(){b.detach("submit",a.Cb,a)})},Nf:function(a,b){var g=this,o=k.fe;o&&o.sc();g.use(a,function(){var B=g.xd(a);if(B){b(B);o&&o.jh()}else A.later(arguments.callee,50,Y,g)})},Je:function(a,b){this.Ma[a]=b},xd:function(a){return this.Ma[a]},Mg:function(a){var b=this.Ma[a];b&&b.za();this.Ma[a]=V},He:function(a,b){this.ib[a]=b},of:function(a){return this.ib[a]},execCommand:function(a){var b=
this.ib[a],g=A.makeArray(arguments);g.shift();g.unshift(this);return b.exec.apply(b,g)},lc:function(){return this.W.css("display")=="none"?k.db:k.Mc},getData:function(a){var b;b=this.lc()==k.db?this.document&&this.document.body?this.document.body.innerHTML:"":this.W.val();if(this.htmlDataProcessor)b=a?this.htmlDataProcessor.toHtml(b,"p"):this.htmlDataProcessor.toServer(b,"p");b=A.trim(b);if(/^<p>((&nbsp;)|\s)*<\/p>$/.test(b))b="";return b},setData:function(a){var b=a;if(this.htmlDataProcessor)b=this.htmlDataProcessor.toDataFormat(a,
"p");this.document.body.innerHTML=b;this.lc()!=k.db&&this.W.val(a)},Cb:function(){this.W.val(this.getData())},rg:function(){return this.document.body.innerHTML},vg:function(a){this.document.body.innerHTML=a},Ae:function(a){var b=this.va,g=b.ec;b=b.ya;var o="",B=k.k.od("../theme/editor-iframe.css");if(b)for(var y=0;y<b.length;y++)o+='<link href="'+b[y]+'" rel="stylesheet"/>';return"<!doctype html><html><head><title>${title}</title><link href='"+B+"' rel='stylesheet'/><style>"+(g||"")+"</style>"+o+
"</head><body class='ke-editor'>&nbsp;"+(a?'<script id="ke_actscript" type="text/javascript">'+(I.rb()?'document.domain="'+C.domain+'";':"")+'window.parent.KISSY.Editor._initIFrame("'+a+'");<\/script>':"")+"</body></html>"},getSelection:function(){return k.Nc.getSelection(this.document)},focus:function(){var a=this.document,b=q.pa(a);u.webkit&&b&&b.parent&&b.parent.focus();u.webkit&&b&&b.focus();a&&a.body.focus();this.vb()},blur:function(){q.pa(this.document).blur();this.document&&this.document.body.blur()},
Ie:function(a){var b=this.va,g=this.document;b.ec=b.ec||"";b.ec+="\n"+a;b=g.createElement("style");g.getElementsByTagName("head")[0].appendChild(b);if(b.styleSheet)b.styleSheet.cssText=a;else b.appendChild(g.createTextNode(a))},Bg:function(a){var b=this.va,g=this.document;b.ya=b.ya||[];b.ya.push(a);b=g.createElement("link");b.rel="stylesheet";g.getElementsByTagName("head")[0].appendChild(b);b.href=a},eh:function(a){for(var b=this.va,g=A.makeArray(this.document.getElementsByTagName("link")),o=0;o<
g.length;o++)g[o].href==a&&q.j(g[o]);b.ya=b.ya||[];b=b.ya;a=A.indexOf(a,b);a!=-1&&b.splice(a,1)},cd:function(){function a(){y=B.document;b.document=y;g.detach();y.open("text/html","replace");y.write(o);y.close()}var b=this,g=b.Ca,o=b.Ae(b.Wb),B=g[0].contentWindow,y;try{y=B.document}catch(s){g[0].src=g[0].src;if(u.ie<7){setTimeout(a,10);return}}a()},ready:function(a){this.Be?a():this.on("dataReady",a)},Cg:function(a,b,g){this.ua=this.ua;g=g||{};g.hf=b;this.ua[a]=g},Zd:function(a){var b=this.ua[a];
if(b)if(!(b.status&&!b.duplicate)){a=this.Env.mods[a].requires||[];for(var g=0;g<a.length;g++)this.Zd(a[g]);b.hf.call(b);b.status=1}},kb:function(){var a=this;a.$c&&clearTimeout(a.$c);a.$c=setTimeout(function(){var b=a.getSelection();if(b&&!b.Fd){var g=b.pb(),o=new k.Za(g);if(!a.xc||!a.xc.md(o)){a.xc=o;a.fire("selectionChange",{selection:b,path:o,element:g})}}},100)},vb:function(){this.xc=V;this.kb()},Ed:function(a,b,g){var o=this;o.focus();setTimeout(function(){var B,y=a.d(),s=k.m,w=k.na,z=k.n,J=
s.Xa[y],t=o.getSelection(),c=t&&t.H(),h,m,v,n;if(!c||c.length==0){var D=arguments,P=D.callee;setTimeout(function(){P.apply(o,D)},30)}else{o.fire("save");for(var O=c.length-1;O>=0;O--){h=c[O];h.deleteContents();B=!O&&a||a.K(x);b&&b(B);if(J)for(;(v=h.Aa(p,x))&&(n=s[v.d()])&&!(n&&n[y]);)if(v.d()in s.span)h.Cc(v);else if(h.wa()&&h.ja()){h.setStartBefore(v);h.collapse(x);v.j()}else h.Bc();h.insertNode(B);m||(m=B)}if(m){y=m.v(x);s=o.document;n=k.m;if(n.Eb[B.d()]){y=new l(s.createTextNode(" "));y.insertAfter(m)}else if(y){if(y.d()==
"br"&&n[y.parent().d()].p){n=new l("<p>&nbsp;</p>",V,s);y[0].parentNode.replaceChild(n[0],y[0]);y=n}}else{n=new l("<p>&nbsp;</p>",V,s);n.insertAfter(m);y=n}h.G(m,w.r);y&&y[0].nodeType==z.e&&h.tb(y);t.Bb([h]);o.focus();B&&B.Vb();setTimeout(function(){o.fire("save")},10);g&&g(B)}}},0)},sf:function(a,b){var g=this;if(g.htmlDataProcessor)a=g.htmlDataProcessor.toDataFormat(a,V,b);if(u.webkit){var o=q.create(a,V,g.document);o=o.nodeType==11?A.makeArray(o.childNodes):[o];for(var B=0;B<o.length;B++)g.Ed(new l(o[B]))}else{g.focus();
setTimeout(function(){var y=g.getSelection();y=y&&y.H();if(!y||y.length==0){var s=arguments,w=s.callee;setTimeout(function(){w.apply(g,s)},30)}else{g.fire("save");if(document.selection){y=document.selection;y.type=="Control"&&y.clear();y.createRange().pasteHTML(a)}else g.document.execCommand("inserthtml",p,a);setTimeout(function(){g.fire("save")},10)}},0)}}});k._initIFrame=function(a){function b(t){e(function(){B.designMode="on";setTimeout(function(){B.designMode="off";s.focus();if(!arguments.callee.Ff)arguments.callee.Ff=
x},50)},function(){B.designMode="off";q.attr(s,"contentEditable",p);q.attr(s,"contentEditable",x);!t&&b(1)})}var g=f.jf(a);a=g.W[0];var o=g.Ca[0].contentWindow,B=g.document,y=g.va;q.j(B.getElementById("ke_actscript"));var s=B.body;if(u.ie){s.hideFocus=x;s.disabled=x;s.contentEditable=x;s.removeAttribute("disabled")}else setTimeout(function(){if(u.gecko||u.opera)s.contentEditable=x;else if(u.webkit)s.parentNode.contentEditable=x;else B.designMode="on"},0);if(u.webkit){d.on(B,"click",function(t){var c=
new l(t.target);A.inArray(c.d(),["input","select"])&&t.preventDefault()});d.on(B,"mouseup",function(t){var c=new l(t.target);A.inArray(c.d(),["input","textarea"])&&t.preventDefault()})}if(u.gecko||u.ie||u.opera){var w;w=new l(q.insertAfter((new l('<span tabindex="-1" style="position:absolute; left:-10000" role="presentation"></span>'))[0],a));w.on("focus",function(){g.focus()});g.Ag=function(){u.gecko&&g.qc&&w[0].focus()};g.on("destroy",function(){w.detach();w.remove()})}if(B.documentMode||u.gecko||
u.opera){var z=B.documentElement;d.on(z,"mousedown",function(t){if((new l(t.target))[0]==z){u.gecko&&b(p);w[0].focus()}})}d.on(o,"focus",function(){if(u.gecko)b(p);else u.opera&&s.focus();g.vb()});u.gecko&&d.on(g.document,"mousedown",function(){g.qc||b(p)});if(u.ie){d.on(B,"keydown",function(t){if(t.keyCode in{8:1,46:1}){var c=g.getSelection(),h=c.mc();if(h){g.fire("save");var m=c.H()[0].O();h.j();c.Td([m]);g.fire("save");t.preventDefault()}}});if(B.compatMode=="CSS1Compat"){var J={33:1,34:1};d.on(B,
"keydown",function(t){t.keyCode in J&&setTimeout(function(){g.getSelection().scrollIntoView()},0)})}}setTimeout(function(){u.ie&&setTimeout(function(){if(B){s.runtimeStyle.marginBottom="0px";s.runtimeStyle.marginBottom=""}},1E3)},0);setTimeout(function(){g.fire("dataReady");var t=y.disableObjectResizing,c=y.disableInlineTableEditing;if(t||c)try{B.execCommand("enableObjectResizing",p,!t);B.execCommand("enableInlineTableEditing",p,!c)}catch(h){d.on(s,u.ie?"resizestart":"resize",function(m){var v=new l(m.target);
if(t||v.d()==="table"&&c)m.preventDefault()})}},10);u.webkit&&d.on(B,"mousedown",function(t){t=new l(t.target);A.inArray(t.d(),["img","hr","input","textarea","select"])&&g.getSelection().Ac(t)});u.gecko&&d.on(B,"dragstart",function(t){var c=new l(t.target);c.d()==="img"&&/ke_/.test(c[0].className)&&t.preventDefault()});f.add(g)};document.documentMode>7&&function(){for(var a=A.all("link"),b=0;b<a.length;b++){var g=new l(a[b]),o=g.attr("href");o.indexOf("editor-pkg-min-mhtml.css")!=-1&&g.attr("href",
o.replace(/editor-pkg-min-mhtml\.css/g,"editor-pkg-min-datauri.css"))}}();r=k.prototype;I.o(r,{setData:r.setData,getData:r.getData,insertElement:r.Ed,insertHtml:r.sf,ready:r.ready,addCustomStyle:r.Ie,addCommand:r.He,hasCommand:r.of,execCommand:r.execCommand,useDialog:r.Nf,addDialog:r.Je,getDialog:r.xd,getMode:r.lc,sync:r.Cb,getSelection:r.getSelection,focus:r.focus,blur:r.blur,notifySelectionChange:r.vb})});
KISSY.Editor.add("zindex",function(){var k=KISSY.Editor;if(!k.Dc){k.Dc={Uf:1100,jg:1200,Wf:99999,cg:900,ig:9999,LOADING:11E3,bg:12E3,he:1200};k.$b=function(x){return(k.Vf.$b||1E4)+x};k.baseZIndex=k.$b;k.zIndexManager=k.Dc}});
KISSY.Editor.add("dtd",function(k){k.m=function(){function x(s){for(var w=arguments.length-1;w>0;)KISSY.mix(s,arguments[w--]);return s}var p={isindex:1,fieldset:1},I={input:1,button:1,select:1,textarea:1,label:1},C=x({a:1},I),A=x({iframe:1},C),u={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},q={ins:1,del:1,script:1,style:1},l=x({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,
s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},q),d=x({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},l),f=x({p:1},d);I=x({iframe:1},d,I);d={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,
del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};var e=x({a:1},I),i={tr:1},r={"#":1},j=x({param:1},d),a=x({form:1},p,A,u,f),b={li:1},g={base:1,link:1,meta:1,title:1},o=x(g,{style:1,script:1}),B={head:1,body:1},y={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1};return{Gb:x({html:1},B,g),Xa:y,Sf:{body:1,div:1,td:1,th:1,caption:1,
form:1},Eb:e,Ec:x({script:1,style:1},y),Fc:{script:1,style:1},Db:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},Fb:{dd:1,dt:1,li:1},$d:{ul:1,ol:1,dl:1},Hc:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},ca:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},Tf:{a:1,area:1,button:1,input:1,object:1,select:1,
textarea:1},Ic:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:B,head:o,style:r,body:a,base:{},link:{},meta:{},title:r,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:a,td:a,br:{},th:a,center:a,kbd:e,button:x(f,u),basefont:{},h5:e,h4:e,samp:e,h6:e,ol:b,h1:e,h3:e,option:r,h2:e,form:x(p,A,u,f),select:{optgroup:1,option:1},font:e,ins:e,menu:b,abbr:e,label:e,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:e,script:r,tfoot:i,cite:e,li:a,input:{},iframe:a,
strong:e,textarea:r,noframes:a,big:e,small:e,span:e,hr:{},dt:e,sub:e,optgroup:{option:1},param:{},bdo:e,"var":e,div:a,object:j,sup:e,dd:a,strike:e,area:{},dir:b,map:x({area:1,form:1,p:1},p,q,u),applet:j,dl:{dt:1,dd:1},del:e,isindex:{},fieldset:x({Xg:1},d),thead:i,ul:b,acronym:e,b:e,a:I,blockquote:a,caption:e,i:e,u:e,tbody:i,s:e,address:x(A,f),tt:e,legend:e,q:e,pre:x(l,C),p:e,em:e,dfn:e}}();k.XHTML_DTD=k.m});
KISSY.Editor.add("elementpath",function(k){function x(d){var f=A,e=A,i=[];for(d=d;d&&d[0];){if(d[0].nodeType==C.e){if(!this.wf)this.wf=d;var r=d.d();if(!e){if(!f&&u[r])f=d;if(q[r]){var j;if(j=!f){if(j=r=="div"){a:{j=d;j=j[0]||j;j=j.childNodes;for(var a=0,b=j.length;a<b;a++){var g=j[a];if(g.nodeType==C.e&&I.Xa[g.nodeName.toLowerCase()]){j=T;break a}}j=Y}j=!j}j=j}if(j)f=d;else e=d}}i.push(d);if(r=="body")break}d=d.parent()}this.block=this.w=f;this.blockLimit=this.D=e;this.elements=this.elements=i}var p=
KISSY.DOM,I=k.m,C=k.n,A=V,u={address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,dd:1},q={body:1,div:1,table:1,tbody:1,tr:1,td:1,th:1,caption:1,form:1};x.prototype={md:function(d){var f=this.elements;d=d&&d.elements;if(!d||f.length!=d.length)return Y;for(var e=0;e<f.length;e++)if(!p.g(f[e],d[e]))return Y;return T},contains:function(d){for(var f=this.elements,e=0;e<f.length;e++)if(f[e].d()in d)return f[e];return A}};k.ElementPath=k.Za=x;var l=x.prototype;k.k.o(l,{compare:l.md,
contains:l.contains})});
KISSY.Editor.add("walker",function(k){function x(i,r){if(this.c.end)return u;var j,a=this.Ea,b,g=this.nc,o=this.type,B=i?"_4e_previousSourceNode":"_4e_nextSourceNode";if(!this.c.start){this.c.start=1;a.trim();if(a.collapsed){this.end();return u}}if(!i&&!this.c.Ad){var y=a.endContainer,s=new f(y[0].childNodes[a.endOffset]);this.c.Ad=function(t,c){return(t=d.C(t))&&t[0]&&(!c||!d.g(y,t))&&(!s[0]||!t.g(s))&&(t[0].nodeType!=l.e||!c||t.d()!="body")}}if(i&&!this.c.Bd){var w=a.startContainer,z=a.startOffset>
0&&new f(w[0].childNodes[a.startOffset-1]);this.c.Bd=function(t,c){return(t=d.C(t))&&t[0]&&(!c||!t.g(w))&&(!z[0]||!t.g(z))&&(t[0].nodeType!=l.e||!c||t.d()!="body")}}var J=i?this.c.Bd:this.c.Ad;b=g?function(t,c){if(J(t,c)===A)return A;return g(t,c)}:J;if(this.nb)j=this.nb[B](A,o,b);else if(i){j=a.endContainer;if(a.endOffset>0){j=new f(j[0].childNodes[a.endOffset-1]);if(b(j)===A)j=u}else j=b(j,C)===A?u:j.ga(C,o,b)}else{j=a.startContainer;if((j=new f(j[0].childNodes[a.startOffset]))&&j[0]){if(b(j)===
A)j=u}else j=b(a.startContainer,C)===A?u:a.startContainer.v(C,o,b)}for(;j&&j[0]&&!this.c.end;){this.nb=j;if(!this.R||this.R(j)!==A){if(!r)return j}else if(r&&this.R)return A;j=j[B](A,o,b)}this.end();return this.nb=u}function p(i){for(var r,j=u;r=x.call(this,i);)j=r;return j}function I(i){this.Ea=i;this.c={}}var C=T,A=Y,u=V,q=KISSY,l=k.n,d=q.DOM,f=q.Node;q.augment(I,{end:function(){this.c.end=1},next:function(){return x.call(this)},yb:function(){return x.call(this,C)},ld:function(){return x.call(this,
A,C)!==A},kd:function(){return x.call(this,C,C)!==A},Hd:function(){return p.call(this)},Gd:function(){return p.call(this,C)},reset:function(){delete this.nb;this.c={}}});I.ac=function(i){return function(r){r=d.C(r);return!(r&&r[0].nodeType==l.e&&r.qa(i))}};I.yf=function(){return this.ac({bc:1})};I.Na=function(i,r){function j(a){return a&&a[0]&&a.d()=="span"&&a.attr("_ke_bookmark")}return function(a){var b,g;b=a&&a[0]&&a[0].nodeType==l.f&&(g=a.parent())&&j(g);b=i?b:b||j(a);return r^b}};I.Va=function(i){return function(r){r=
(r=r[0]||r)&&r.nodeType==l.f&&!q.trim(r.nodeValue);return i^r}};I.tf=function(i){var r=I.Va();return function(j){j=r(j)||j[0].nodeType==l.e&&!j[0].offsetHeight;return i^j}};k.Ia=I;k.Walker=I;var e=I.prototype;k.k.o(e,{end:e.end,next:e.next,previous:e.yb,checkForward:e.ld,checkBackward:e.kd,lastForward:e.Hd,lastBackward:e.Gd,reset:e.reset});k.k.o(I,{blockBoundary:I.ac,listItemBoundary:I.yf,bookmark:I.Na,whitespaces:I.Va,invisible:I.tf})});
KISSY.Editor.add("range",function(k){function x(c){this.endOffset=this.endContainer=this.startOffset=this.startContainer=d;this.collapsed=q;this.document=c}function p(c){var h=c[0].nodeType!=e.f&&c.d()in o.ca,m=!f.trim(c[0].nodeValue);c=!!c.parent().attr("_ke_bookmark");return h||m||c}function I(c){return!z(c)&&!J(c)}function C(c){var h=l,m=j.Na(q);return function(v){if(m(v))return q;if(v[0].nodeType==e.f){if(f.trim(v[0].nodeValue).length)return l}else if(v[0].nodeType==e.e)if(!w[v.d()])if(!c&&!g.ie&&
v.d()=="br"&&!h)h=q;else return l;return q}}function A(c,h){function m(v){return v&&v.nodeName=="span"&&v.getAttribute("_ke_bookmark")}return function(v){var n,D;n=v&&!v.nodeName&&(D=v.parentNode)&&m(D);n=c?n:n||m(v);return h^n}}function u(c){return function(h){h=(h=h[0]||h)&&h.nodeType==e.f&&!f.trim(h.nodeValue);return c^h}}k.na={Z:1,J:2,B:3,r:4,Jb:1,Ib:2,Ya:3,bb:1,de:2,kg:3,fa:1,Lc:2};k.RANGE=k.na;var q=T,l=Y,d=V,f=KISSY,e=k.n,i=k.na,r=k.$a,j=k.Ia,a=f.DOM,b=k.k.wd,g=f.UA,o=k.m,B=k.Za,y=f.Node,s=
{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1};x.prototype.toString=function(){var c=[];c.push((this.startContainer[0].id||this.startContainer[0].nodeName)+":"+this.startOffset);c.push((this.endContainer[0].id||this.endContainer[0].nodeName)+":"+this.endOffset);return c.join("<br/>")};f.augment(x,{Ua:function(){this.collapsed=this.startContainer&&this.endContainer&&a.g(this.startContainer,this.endContainer)&&this.startOffset==this.endOffset},vc:function(){var c=this.startContainer,
h=this.startOffset;if(c[0].nodeType!=e.e)if(h)h>=c[0].nodeValue.length&&this.setStartAfter(c);else this.setStartBefore(c);c=this.endContainer;h=this.endOffset;if(c[0].nodeType!=e.e)if(h)h>=c[0].nodeValue.length&&this.setEndAfter(c);else this.setEndBefore(c)},setStartAfter:function(c){this.setStart(c.parent(),c.t()+1)},setStartBefore:function(c){this.setStart(c.parent(),c.t())},setEndAfter:function(c){this.setEnd(c.parent(),c.t()+1)},setEndBefore:function(c){this.setEnd(c.parent(),c.t())},wc:function(){var c=
this.startContainer,h=this.endContainer;c&&c.d()=="span"&&c.attr("_ke_bookmark")&&this.V(c,i.B);h&&h.d()=="span"&&h.attr("_ke_bookmark")&&this.U(h,i.r)},setStart:function(c,h){if(c[0].nodeType==e.e&&s[c.d()]){c=c.parent();h=c.t()}this.startContainer=c;this.startOffset=h;if(!this.endContainer){this.endContainer=c;this.endOffset=h}this.Ua()},setEnd:function(c,h){if(c[0].nodeType==e.e&&s[c.d()]){c=c.parent();h=c.t()+1}this.endContainer=c;this.endOffset=h;if(!this.startContainer){this.startContainer=
c;this.startOffset=h}this.Ua()},V:function(c,h){switch(h){case i.Z:this.setStart(c,0);break;case i.J:c[0].nodeType==e.f?this.setStart(c,c[0].nodeValue.length):this.setStart(c,c[0].childNodes.length);break;case i.B:this.setStartBefore(c);break;case i.r:this.setStartAfter(c)}this.Ua()},U:function(c,h){switch(h){case i.Z:this.setEnd(c,0);break;case i.J:c[0].nodeType==e.f?this.setEnd(c,c[0].nodeValue.length):this.setEnd(c,c[0].childNodes.length);break;case i.B:this.setEndBefore(c);break;case i.r:this.setEndAfter(c)}this.Ua()},
hc:function(c,h){var m=this.startContainer,v=this.endContainer,n=this.startOffset,D=this.endOffset,P,O=this.document,Q;this.wc();if(v[0].nodeType==e.f)v=v.ha(D);else if(v[0].childNodes.length>0)if(D>=v[0].childNodes.length){v=new y(v[0].appendChild(O.createTextNode("")));Q=q}else v=new y(v[0].childNodes[D]);if(m[0].nodeType==e.f){m.ha(n);if(m.g(v))v=new y(m[0].nextSibling)}else if(n)if(n>=m[0].childNodes.length){P=new y(O.createTextNode(""));m.append(P);m=P;P=q}else m=new y(m[0].childNodes[n].previousSibling);
else{P=new y(O.createTextNode(""));m.prepend(P);m=P;P=q}n=m.Ub();D=v.Ub();var N,W,R;for(N=0;N<n.length;N++){W=n[N];R=D[N];if(!W.g(R))break}O=h;for(var X,aa,ca,F=N;F<n.length;F++){X=n[F];aa=O&&!X.g(m)?O.appendChild(X.K()[0]):V;for(X=X[0].nextSibling;X;){if(a.g(D[F],X)||a.g(v,X))break;ca=X.nextSibling;if(c==2)O.appendChild(X.cloneNode(q));else{a.j(X);c==1&&O.appendChild(X)}X=ca}if(aa)O=aa}O=h;for(N=N;N<D.length;N++){X=D[N];aa=O&&c>0&&!X.g(v)?O.appendChild(X.K()[0]):V;if(!n[N]||!X.parent().g(n[N].parent()))for(X=
X[0].previousSibling;X;){if(a.g(n[N],X)||a.g(m,X))break;ca=X.previousSibling;if(c==2)O.insertBefore(X.cloneNode(q),O.firstChild);else{a.j(X);c==1&&O.insertBefore(X,O.firstChild)}X=ca}if(aa)O=aa}if(c==2){R=this.startContainer[0];if(R.nodeType==e.f&&R.nextSibling&&R.nextSibling.nodeType==e.f){R.data+=R.nextSibling.data;R.parentNode.removeChild(R.nextSibling)}R=this.endContainer[0];if(R.nodeType==e.f&&R.nextSibling&&R.nextSibling.nodeType==e.f){R.data+=R.nextSibling.data;R.parentNode.removeChild(R.nextSibling)}}else{if(W&&
R&&(!m.parent().g(W.parent())||!v.parent().g(R.parent()))){W=R.t();P&&R.parent().g(m.parent())&&W--;this.setStart(R.parent(),W)}this.collapse(q)}P&&m.j();Q&&v[0].parentNode&&v.j()},collapse:function(c){if(c){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this.collapsed=q},clone:function(){var c=new x(this.document);c.startContainer=this.startContainer;c.startOffset=this.startOffset;c.endContainer=this.endContainer;
c.endOffset=this.endOffset;c.collapsed=this.collapsed;return c},yd:function(){var c=this.clone();c.vc();if(c.startContainer[0].nodeType!=e.e||c.endContainer[0].nodeType!=e.e)return d;var h=new k.Ia(c),m=A(q,undefined),v=u(q);c.R=function(n){return v(n)&&m(n)};c=h.next();h.reset();h=h.yb();return c&&c.g(h)?c:d},Ta:function(c,h){if(!this.collapsed){c=c||i.Lc;var m=this.clone(),v=this.startContainer,n=this.endContainer,D=this.startOffset,P=this.endOffset,O=1,Q=1;if(v&&v[0].nodeType==e.f)if(D)if(D>=v[0].nodeValue.length)m.setStartAfter(v);
else{m.setStartBefore(v);O=0}else m.setStartBefore(v);if(n&&n[0].nodeType==e.f)if(P)if(P>=n[0].nodeValue.length)m.setEndAfter(n);else{m.setEndAfter(n);Q=0}else m.setEndBefore(n);m=new j(m);m.R=function(W){W=W[0]||W;return W.nodeType==(c==i.fa?e.e:e.f)};var N;m.nc=function(W,R){W=W[0]||W;if(c==i.fa&&W.nodeType==e.f)return l;if(R&&W==N)return l;if(!R&&W.nodeType==e.e)N=W;return q};if(O)(v=m[c==i.fa?"lastForward":"next"]())&&this.V(v,h?i.Z:i.B);if(Q){m.reset();(m=m[c==i.fa?"lastBackward":"previous"]())&&
this.U(m,h?i.J:i.r)}return!!(O||Q)}},mf:function(){var c=this.startContainer;if(this.collapsed||c[0].nodeType!=e.e)return c;return c.childNodes[this.startOffset]||c},nd:function(c){var h=this.startContainer,m=this.endContainer,v=this.startOffset,n=this.endOffset,D,P;if(!h||!m)return{start:0,end:0};if(c){if(h[0].nodeType==e.e)if((D=new y(h[0].childNodes[v]))&&D[0]&&D[0].nodeType==e.f&&v>0&&D[0].previousSibling.nodeType==e.f){h=D;v=0}for(;h[0].nodeType==e.f&&(P=h.sa())&&P[0].nodeType==e.f;){h=P;v+=
P[0].nodeValue.length}if(!this.collapsed){if(m[0].nodeType==e.e)if((D=new y(m[0].childNodes[n]))&&D[0]&&D[0].nodeType==e.f&&n>0&&D[0].previousSibling.nodeType==e.f){m=D;n=0}for(;m[0].nodeType==e.f&&(P=m.sa())&&P[0].nodeType==e.f;){m=P;n+=P[0].nodeValue.length}}}return{start:h.Ja(c),end:this.collapsed?d:m.Ja(c),startOffset:v,endOffset:n,Kd:c,uf:q}},O:function(c){var h,m,v,n,D=this.collapsed;h=new y("<span>",d,this.document);h.attr("_ke_bookmark",1);h.css("display","none");h.html("&nbsp;");if(c){v=
f.guid("ke_bm_");h.attr("id",v+"S")}if(!D){m=h.K();m.html("&nbsp;");c&&m.attr("id",v+"E");n=this.clone();n.collapse();n.insertNode(m)}n=this.clone();n.collapse(q);n.insertNode(h);if(m){this.setStartAfter(h);this.setEndBefore(m)}else this.G(h,i.r);return{ba:c?v+"S":h,Q:c?v+"E":m,Vd:c,collapsed:D}},G:function(c,h){this.V(c,h);this.collapse(q)},trim:function(c,h){var m=this.startContainer,v=this.startOffset,n=this.collapsed;if((!c||n)&&m[0]&&m[0].nodeType==e.f){if(v)if(v>=m[0].nodeValue.length){v=m.t()+
1;m=m.parent()}else{var D=m.ha(v);v=m.t()+1;m=m.parent();if(a.g(this.startContainer,this.endContainer))this.setEnd(D,this.endOffset-this.startOffset);else if(a.g(m,this.endContainer))this.endOffset+=1}else{v=m.t();m=m.parent()}this.setStart(m,v);if(n){this.collapse(q);return}}m=this.endContainer;v=this.endOffset;if(!(h||n)&&m[0]&&m[0].nodeType==e.f){if(v){v>=m.nodeValue.length||m.ha(v);v=m.t()+1}else v=m.t();m=m.parent();this.setEnd(m,v)}},insertNode:function(c){this.wc();this.trim(l,q);var h=this.startContainer;
h[0].insertBefore(c[0]||c,h[0].childNodes[this.startOffset]||V);a.g(c.parent(),this.endContainer)&&this.endOffset++;this.setStartBefore(c)},moveToBookmark:function(c){if(c.uf){var h=b(this.document,c.start,c.Kd),m=c.startOffset,v=c.end&&b(this.document,c.end,c.Kd);c=c.endOffset;this.setStart(h,m);v?this.setEnd(v,c):this.collapse(q)}else{h=(m=c.Vd)?f.one("#"+c.ba,this.document):c.ba;c=m?f.one("#"+c.Q,this.document):c.Q;this.setStartBefore(h);h.j();if(c&&c[0]){this.setEndBefore(c);c.j()}else this.collapse(q)}},
Aa:function(c,h){var m=this.startContainer,v=this.endContainer;m=a.g(m,v)?c&&m[0].nodeType==e.e&&this.startOffset==this.endOffset-1?new y(m[0].childNodes[this.startOffset]):m:m.Qb(v);return h&&m[0].nodeType==e.f?m.parent():m},Oa:function(c){switch(c){case i.Jb:if(this.collapsed)break;c=this.Aa();var h=new y(this.document.body),m,v,n,D,P,O=l,Q,N;Q=this.startContainer;N=this.startOffset;if(Q[0].nodeType==e.f){if(N){Q=!f.trim(Q[0].nodeValue.substring(0,N)).length&&Q;O=!!Q}if(Q)if(!(D=Q[0].previousSibling))n=
Q.parent()}else{if(N)D=Q[0].childNodes[N-1]||Q[0].lastChild;D||(n=Q)}for(;n||D;){if(n&&!D){if(!P&&a.g(n,c))P=q;if(!h.contains(n))break;if(!O||n.css("display")!="inline"){O=l;if(P)m=n;else this.setStartBefore(n)}D=n[0].previousSibling}for(;D;){Q=l;if(D.nodeType==e.f){N=D.nodeValue;if(/[^\s\ufeff]/.test(N))D=d;Q=/[\s\ufeff]$/.test(N)}else if(D.offsetWidth>0&&!D.getAttribute("_ke_bookmark"))if(O&&o.ca[D.nodeName.toLowerCase()]){N=a.text(D);if(/[^\s\ufeff]/.test(N))D=d;else for(var W=D.all||D.getElementsByTagName("*"),
R=0,X;X=W[R++];)if(!o.ca[X.nodeName.toLowerCase()]){D=d;break}if(D)Q=!!N.length}else D=d;if(Q)if(O)if(P)m=n;else n&&this.setStartBefore(n);else O=q;if(D){Q=D.previousSibling;if(!n&&!Q){n=new y(D);D=d;break}D=Q}else n=d}if(n)n=n.parent()}Q=this.endContainer;N=this.endOffset;n=D=d;P=O=l;if(Q[0].nodeType==e.f){Q=!f.trim(Q[0].nodeValue.substring(N)).length&&Q;O=!(Q&&Q[0].nodeValue.length);if(Q)if(!(D=Q[0].nextSibling))n=Q.parent()}else(D=Q[0].childNodes[N])||(n=Q);for(;n||D;){if(n&&!D){if(!P&&a.g(n,c))P=
q;if(!h.contains(n))break;if(!O||n.css("display")!="inline"){O=l;if(P)v=n;else n&&this.setEndAfter(n)}D=n[0].nextSibling}for(;D;){Q=l;if(D.nodeType==e.f){N=D.nodeValue;if(/[^\s\ufeff]/.test(N))D=d;Q=/^[\s\ufeff]/.test(N)}else if(D.offsetWidth>0&&!D.getAttribute("_ke_bookmark"))if(O&&o.ca[D.nodeName.toLowerCase()]){N=a.text(D);if(/[^\s\ufeff]/.test(N))D=d;else{W=D.all||D.getElementsByTagName("*");for(R=0;X=W[R++];)if(!o.ca[X.nodeName.toLowerCase()]){D=d;break}}if(D)Q=!!N.length}else D=d;if(Q)if(O)if(P)v=
n;else this.setEndAfter(n);if(D){Q=D.nextSibling;if(!n&&!Q){n=new y(D);D=d;break}D=Q}else n=d}if(n)n=n.parent()}if(m&&v){c=m.contains(v)?v:m;this.setStartBefore(c);this.setEndAfter(c)}break;case i.Ib:case i.Ya:n=new x(this.document);h=new y(this.document.body);n.V(h,i.Z);n.setEnd(this.startContainer,this.startOffset);n=new j(n);var aa,ca,F=j.ac(c==i.Ya?{bc:1}:d),K=function(E){var H=F(E);H||(aa=E);return H};m=function(E){var H=K(E);if(!H&&E[0]&&E.d()=="br")ca=E;return H};n.nc=K;n=n.Gd();aa=aa||h;this.V(aa,
aa.d()!="br"&&(!n&&this.wa()||n&&aa.contains(n))?i.Z:i.r);n=this.clone();n.collapse();n.U(h,i.J);n=new j(n);n.nc=c==i.Ya?m:K;aa=d;n=n.Hd();aa=aa||h;this.U(aa,!n&&this.ja()||n&&aa.contains(n)?i.J:i.B);ca&&this.setEndAfter(ca)}},wa:function(){var c=this.startContainer,h=this.startOffset;if(h&&c[0].nodeType==e.f)if(f.trim(c[0].nodeValue.substring(0,h)).length)return l;this.trim();c=new B(this.startContainer);h=this.clone();h.collapse(q);h.V(c.w||c.D,i.Z);c=new j(h);c.R=C(q);return c.kd()},ja:function(){var c=
this.endContainer,h=this.endOffset;if(c[0].nodeType==e.f)if(f.trim(c[0].nodeValue.substring(h)).length)return l;this.trim();c=new B(this.endContainer);h=this.clone();h.collapse(l);h.U(c.w||c.D,i.J);c=new j(h);c.R=C(l);return c.ld()},deleteContents:function(){this.collapsed||this.hc(0)},extractContents:function(){var c=this.document.createDocumentFragment();this.collapsed||this.hc(1,c);return c},dc:function(c,h){var m=this.clone();m[h==i.bb?"setStartAt":"setEndAt"](c,h==i.bb?i.Z:i.J);m=new j(m);m.R=
p;return m[h==i.bb?"checkBackward":"checkForward"]()},vd:function(){var c=this.startContainer,h=this.endContainer,m=this.startOffset,v=this.endOffset,n;if(c[0].nodeType==e.e){n=c[0].childNodes.length;if(n>m)c=new y(c[0].childNodes[m]);else if(n<1)c=c.ga();else{for(c=c[0];c.lastChild;)c=c.lastChild;c=new y(c);c=c.v()||c}}if(h[0].nodeType==e.e){n=h[0].childNodes.length;if(n>v)h=(new y(h[0].childNodes[v])).ga(q);else if(n<1)h=h.ga();else{for(h=h[0];h.lastChild;)h=h.lastChild;h=new y(h)}}if(c.La(h)&r.da)c=
h;return{ba:c,Q:h}},ob:function(c,h){var m=this.O(),v=new y(this.document.createElement(h));this.collapse(c);this.Oa(i.Ib);v[0].appendChild(this.extractContents());v.hb();g.ie||v.Ob();for(var n=v[0].childNodes,D=0;D<n.length;D++){var P=n[D];P.nodeType==8&&this.insertNode(new y(P))}this.insertNode(v);this.moveToBookmark(m);return v},Bc:function(c){var h=new B(this.startContainer),m=new B(this.endContainer),v=h.w,n=m.w,D=d;if(!h.D.g(m.D))return d;if(c!="br"){if(!v){v=this.ob(q,c);n=(new B(this.endContainer)).w}n||
(n=this.ob(l,c))}c=v&&this.wa();h=n&&this.ja();this.deleteContents();if(v&&a.g(v,n))if(h){D=new B(this.startContainer);this.G(n,i.r);n=d}else if(c){D=new B(this.startContainer);this.G(v,i.B);v=d}else{n=this.Cc(v);!g.ie&&!f.inArray(v.d(),["ul","ol"])&&v.Ob()}return{bh:v,$g:n,Qf:c,Pf:h,Sg:D}},Cc:function(c){if(!this.collapsed)return d;this.U(c,i.J);var h=this.extractContents(),m=c.K(l);m[0].appendChild(h);m.insertAfter(c);this.G(c,i.r);return m},tb:function(c,h){var m,v=k.m;if(v.Db[c.d()])return l;
for(;c&&c[0].nodeType==e.e;){if(m=c.Rc())this.G(c,h?i.J:i.Z);else if(v.Eb[c.d()]){this.G(c,h?i.r:i.B);return q}if((c=v.Db[c.d()]?c[h?"_4e_previous":"_4e_next"](I):c[h?"_4e_last":"_4e_first"](I))&&c[0].nodeType==e.f){this.G(c,h?i.r:i.B);return q}}return m},selectNodeContents:function(c){this.setStart(c,0);this.setEnd(c,c[0].nodeType==e.f?c[0].nodeValue.length:c[0].childNodes.length)}});var w={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,
small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},z=new j.Va,J=new j.Na;k.Range=x;k.Range=x;var t=x.prototype;k.k.o(t,{updateCollapsed:t.Ua,optimize:t.vc,setStartAfter:t.setStartAfter,setEndAfter:t.setEndAfter,setStartBefore:t.setStartBefore,setEndBefore:t.setEndBefore,optimizeBookmark:t.wc,setStart:t.setStart,setEnd:t.setEnd,setStartAt:t.V,setEndAt:t.U,execContentsAction:t.hc,collapse:t.collapse,clone:t.clone,getEnclosedNode:t.yd,shrink:t.Ta,getTouchedStartNode:t.mf,createBookmark2:t.nd,
createBookmark:t.O,moveToPosition:t.G,trim:t.trim,insertNode:t.insertNode,moveToBookmark:t.moveToBookmark,getCommonAncestor:t.Aa,enlarge:t.Oa,checkStartOfBlock:t.wa,checkEndOfBlock:t.ja,deleteContents:t.deleteContents,extractContents:t.extractContents,checkBoundaryOfElement:t.dc,getBoundaryNodes:t.vd,fixBlock:t.ob,splitBlock:t.Bc,splitElement:t.Cc,moveToElementEditablePosition:t.tb,selectNodeContents:t.selectNodeContents})});
KISSY.Editor.add("domiterator",function(k){function x(j){if(!(arguments.length<1)){this.Ea=j;this.jc=I;this.sd=p;this.gc=I;this.c||(this.c={})}}var p=T,I=Y,C=KISSY,A=C.UA,u=k.Ia,q=k.Range,l=k.na,d=k.n,f=k.Za,e=C.Node,i=C.DOM,r=/^[\r\n\t ]*$/;C.augment(x,{lf:function(j){var a,b,g,o,B;if(!this.c.I){b=this.Ea.clone();b.Ta(l.fa,p);b.Oa(this.jc||!this.sd?l.Ya:l.Ib);var y=new u(b),s=u.Na(p,p);y.R=s;this.c.ka=y.next();y=new u(b);y.R=s;y=y.yb();this.c.I=y.v(p);if(this.c.I&&this.c.I[0].nodeType==d.f&&!C.trim(this.c.I[0].nodeValue)&&
this.c.I.parent().qa()){s=new q(b.document);s.G(this.c.I,l.r);if(s.ja()){s=new f(s.endContainer);this.c.I=(s.w||s.D).v(p)}}if(!this.c.I){this.c.I=this.c.qd=new e(b.document.createTextNode(""));i.insertAfter(this.c.I[0],y[0])}b=V}s=this.c.ka;y=this.c.I;for(this.c.ka=V;s;){var w=I,z=s[0].nodeType!=d.e,J=I;if(z){if(s[0].nodeType==d.f)if(r.test(s[0].nodeValue))z=I}else{var t=s.d();if(s.qa(this.jc&&{bc:1})){if(t=="br")z=p;else if(!b&&!s[0].childNodes.length&&t!="hr"){a=s;g=s.g(y);break}if(b){b.U(s,l.B);
if(t!="br")this.c.ka=s}w=p}else{if(s[0].firstChild){if(!b){b=new q(this.Ea.document);b.V(s,l.B)}s=new e(s[0].firstChild);continue}z=p}}if(z&&!b){b=new q(this.Ea.document);b.V(s,l.B)}g=(!w||z)&&s.g(y);if(b&&!w)for(;!s[0].nextSibling&&!g;){t=s.parent();if(t.qa(this.jc&&{bc:1})){w=p;g||t.g(y);break}s=t;z=p;g=s.g(y);J=p}z&&b.U(s,l.r);s=s.v(J,V,y);if((g=!s)||w&&b)break}if(!a){if(!b){this.c.qd&&this.c.qd.j();return this.c.ka=V}a=new f(b.startContainer);s=a.D;w={Ng:1,ih:1,hh:1};a=a.w;if((!a||!a[0])&&!this.gc&&
w[s.d()]&&b.wa()&&b.ja())a=s;else if(!a||this.gc&&a.d()=="li"){a=new e(this.Ea.document.createElement(j||"p"));a[0].appendChild(b.extractContents());a.hb();b.insertNode(a);o=B=p}else if(a.d()!="li"){if(!b.wa()||!b.ja()){a=a.K(I);a[0].appendChild(b.extractContents());a.hb();B=b.Bc();o=!B.Qf;B=!B.Pf;b.insertNode(a)}}else if(!g)this.c.ka=a.g(y)?V:b.vd().Q.v(p,V,y)}if(o){b=new e(a[0].previousSibling);if(b[0]&&b[0].nodeType==d.e)if(b.d()=="br")b.j();else b[0].lastChild&&i.d(b[0].lastChild)=="br"&&i.j(b[0].lastChild)}if(B){b=
u.Na(I,p);o=new e(a[0].lastChild);if(o[0]&&o[0].nodeType==d.e&&o.d()=="br")if(A.ie||o.sa(b)||o.Ka(b))o.j()}if(!this.c.ka)this.c.ka=g||a.g(y)?V:a.v(p,V,y);return a}});q.prototype.Ze=function(){return new x(this)}});
KISSY.Editor.add("selection",function(k){function x(w){this.document=this.document=w;this.c={M:{}};if(a){var z=this.z().createRange();if(!z||z.item&&z.item(0).ownerDocument!=w||z.parentElement&&z.parentElement().ownerDocument!=w)this.Fd=C}}function p(w){w=new x(w);return!w||w.Fd?u:w}function I(w){function z(N){return Q(N)&&N&&N[0].nodeType!=8}var J=w.document,t=new e(J.body),c=new e(J.documentElement);if(l.ie){l.Ba<8&&c.on("click",function(N){(new e(N.target)).d()==="html"&&w.getSelection().z().createRange().select()});
var h,m,v=1;c.on("mousedown",function(){v=0});c.on("mouseup",function(){v=1});t.on("focusin",function(N){if((new e(N.target)).d()=="body")if(h){try{v&&h.select()}catch(W){}h=u}});t.on("focus",function(){m=C;D()});t.on("beforedeactivate",function(N){if(!N.relatedTarget){n();v=1}});w.on("blur",function(){try{var N=document.documentElement||document.body,W=N.scrollTop,R=N.scrollLeft;J&&J.selection.empty();N.scrollTop=W;N.scrollLeft=R}catch(X){}});t.on("mousedown",function(){n()});t.on("mouseup",function(){m=
C;setTimeout(function(){D(C)},0)});var n=function(){m=A},D=function(N){if(m){var W=w.document,R=w.getSelection(),X=R&&R.qb(),aa=R&&W.selection;if(N&&aa&&X==i.Lb)if(!W.queryCommandEnabled("InsertImage")){setTimeout(function(){D(C)},50);return}var ca;if(!(aa&&X==i.oa&&(ca=d.d(R.pb()))&&ca in{input:1,textarea:1})){h=aa&&aa.createRange();w.kb()}}};t.on("keydown",n);t.on("keyup",function(){m=C;D()});f.on(J,"selectionchange",D)}else{f.on(J,"mouseup",w.kb,w);f.on(J,"keyup",w.kb,w)}var P={table:1,pre:1},
O=/\s*<(p|div|address|h\d|center)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;|(<!--[\s\S]*?--\>))?\s*(:?<\/\1>)?(?=\s*$|<\/body>)/gi,Q=k.Ia.Va(C);w.on("selectionChange",function(N){var W=N.path;N=(N=N.selection)&&N.H()[0];if(!(!N||!N.collapsed||W.w))if(W.D.d()=="body")if(W=N.ob(C,"p")){if(W.gb().match(O)){var R=W.Ka(z);if(R&&R[0].nodeType==j.e&&!P[R.d()]){N.tb(R);W.j()}else if((R=W.sa(z))&&R[0].nodeType==j.e&&!P[R.d()]){N.tb(R,R.gb().match(O)?A:C);W.j()}}N.select();a||w.vb()}})}k.je={Lb:1,oa:2,ab:3};
var C=T,A=Y,u=V,q=KISSY,l=q.UA,d=q.DOM,f=q.Event,e=q.Node,i=k.je,r=k.na,j=k.n,a=!window.getSelection,b=k.Ia,g=k.Range,o={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};q.augment(x,{z:!a?function(){var w=this.c.M;return w.tc||(w.tc=d.pa(this.document).getSelection())}:function(){var w=this.c.M;return w.tc||(w.tc=this.document.selection)},qb:!a?function(){var w=this.c.M;if(w.type)return w.type;var z=i.oa,
J=this.z();if(J){if(J.rangeCount==1){J=J.getRangeAt(0);var t=J.startContainer;if(t==J.endContainer&&t.nodeType==j.e&&J.endOffset-J.startOffset===1&&o[t.childNodes[J.startOffset].nodeName.toLowerCase()])z=i.ab}}else z=i.Lb;return w.type=z}:function(){var w=this.c.M;if(w.type)return w.type;var z=i.Lb;try{var J=this.z(),t=J.type;if(t=="Text")z=i.oa;if(t=="Control")z=i.ab;if(J.createRange().parentElement)z=i.oa}catch(c){}return w.type=z},H:a?function(){function w(z,J){z=z.duplicate();z.collapse(J);for(var t=
z.parentElement(),c=t.childNodes,h,m=0;m<c.length;m++){var v=c[m];if(v.nodeType==j.e){h=z.duplicate();h.moveToElementText(v);v=h.compareEndPoints("StartToStart",z);var n=h.compareEndPoints("EndToStart",z);h.collapse();if(v>0)break;else if(!v||n==1&&v==-1)return{xa:t,offset:m};else if(!n)return{xa:t,offset:m+1};h=u}}if(!h){h=z.duplicate();h.moveToElementText(t);h.collapse(A)}h.setEndPoint("StartToStart",z);h=String(h.text).replace(/\r\n|\r/g,"\n").length;try{for(;h>0;)h-=c[--m].nodeValue.length}catch(D){h=
0}return h===0?{xa:t,offset:m}:{xa:c[m],offset:-h}}return function(){var z=this.c.M;if(z.ma)return z.ma;var J=this.z(),t=J&&J.createRange(),c=this.qb();if(!J)return[];if(c==i.oa){J=new g(this.document);c=w(t,C);J.setStart(new e(c.xa),c.offset);c=w(t);J.setEnd(new e(c.xa),c.offset);return z.ma=[J]}else if(c==i.ab){z=z.ma=[];for(c=0;c<t.length;c++){var h=t.item(c),m=h.parentNode,v=0;for(J=new g(this.document);v<m.childNodes.length&&m.childNodes[v]!=h;v++);J.setStart(new e(m),v);J.setEnd(new e(m),v+
1);z.push(J)}return z}return z.ma=[]}}():function(){var w=this.c.M;if(w.ma)return w.ma;var z=[],J=this.z();if(!J)return[];for(var t=0;t<J.rangeCount;t++){var c=J.getRangeAt(t),h=new g(this.document);h.setStart(new e(c.startContainer),c.startOffset);h.setEnd(new e(c.endContainer),c.endOffset);z.push(h)}return w.ma=z},pb:function(){var w=this.c.M;if(w.Wd!==undefined)return w.Wd;var z,J=this.z();switch(this.qb()){case i.ab:return this.mc();case i.oa:var t=this.H()[0];if(t)if(!t.collapsed){for(t.vc();C;){z=
t.startContainer;if(t.startOffset==(z[0].nodeType===j.e?z[0].childNodes.length:z[0].nodeValue.length)&&!z.qa())t.setStartAfter(z);else break}z=t.startContainer;if(z[0].nodeType!=j.e)return z.parent();z=new e(z[0].childNodes[t.startOffset]);if(!z[0]||z[0].nodeType!=j.e)return t.startContainer;for(t=z[0].firstChild;t&&t.nodeType==j.e;){z=new e(t);t=t.firstChild}return z}if(a){t=J.createRange();t.collapse(C);z=t.parentElement()}else if((z=J.anchorNode)&&z.nodeType!=j.e)z=z.parentNode}return w.Wd=z?d.C(z):
u},mc:function(){var w=this,z,J=w.c.M;if(J.Ud!==undefined)return J.Ud;if(a){z=w.z().createRange();z=z.item&&z.item(0)}z||(z=function(){for(var t=w.H()[0],c,h,m=2;m&&!((c=t.yd())&&c[0].nodeType==j.e&&o[c.d()]&&(h=c));m--)t.Ta(r.fa);return h&&h[0]}());return J.Ud=d.C(z)},reset:function(){this.c.M={}},Ac:function(w){var z,J=this.document;if(a)try{z=J.body.createControlRange();z.addElement(w[0]);z.select()}catch(t){z=J.body.createTextRange();z.moveToElementText(w[0]);z.select()}finally{}else{z=J.createRange();
z.selectNode(w[0]);w=this.z();w.removeAllRanges();w.addRange(z)}this.reset()},Bb:function(w){if(a){if(w.length>1){var z=w[w.length-1];w[0].setEnd(z.endContainer,z.endOffset);w.length=1}w[0]&&w[0].select()}else{z=this.z();if(!z)return;z.removeAllRanges();for(var J=0;J<w.length;J++){var t=w[J],c=this.document.createRange(),h=t.startContainer;t.collapsed&&l.gecko&&l.gecko<1.09&&h[0].nodeType==j.e&&!h[0].childNodes.length&&h[0].appendChild(this.document.createTextNode(""));c.setStart(h[0],t.startOffset);
c.setEnd(t.endContainer[0],t.endOffset);z.addRange(c)}}this.reset()},Ye:function(w){for(var z=[],J=this.H(),t=0;t<J.length;t++)z.push(J[t].nd(w));return z},Xe:function(w,z){var J=[],t=this.document,c;z=z||this.H();for(var h=z.length,m=0;m<h;m++){J.push(c=z[m].O(w,C));var v=(w=c.Vd)?q.one("#"+c.ba,t):c.ba;c=w?q.one("#"+c.Q,t):c.Q;for(var n=m+1;n<h;n++){var D=z[n],P=D.startContainer,O=D.endContainer;d.g(P,v.parent())&&D.startOffset++;d.g(P,c.parent())&&D.startOffset++;d.g(O,v.parent())&&D.endOffset++;
d.g(O,c.parent())&&D.endOffset++}}return J},Td:function(w){for(var z=[],J=0;J<w.length;J++){var t=new g(this.document);t.moveToBookmark(w[J]);z.push(t)}this.Bb(z);return this},Aa:function(){var w=this.H();return w[0].startContainer.Qb(w[w.length-1].endContainer)},scrollIntoView:function(){var w=this.pb();w&&w.Vb()},removeAllRanges:function(){var w=this.z();if(a)w&&w.clear();else w&&w.removeAllRanges()}});var B={table:1,tbody:1,tr:1},y=b.Va(C),s=/\ufeff|\u00a0/;g.prototype.select=g.prototype.select=
!a?function(){var w=this.startContainer;this.collapsed&&w[0].nodeType==j.e&&!w[0].childNodes.length&&w[0].appendChild(this.document.createTextNode(""));var z=this.document.createRange();z.setStart(w[0],this.startOffset);try{z.setEnd(this.endContainer[0],this.endOffset)}catch(J){if(J.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0){this.collapse(C);z.setEnd(this.endContainer[0],this.endOffset)}else throw J;}w=p(this.document).z();w.removeAllRanges();w.addRange(z)}:function(w){var z=this.collapsed,
J,t;if(this.startContainer[0]===this.endContainer[0]&&this.endOffset-this.startOffset==1){var c=this.startContainer[0].childNodes[this.startOffset];if(c.nodeType==j.e){(new x(this.document)).Ac(new e(c));return}}if(this.startContainer[0].nodeType==j.e&&this.startContainer.d()in B||this.endContainer[0].nodeType==j.e&&this.endContainer.d()in B)this.Ta(r.fa,C);var h=this.O();c=h.ba;var m;if(!z)m=h.Q;h=this.document.body.createTextRange();h.moveToElementText(c[0]);h.moveStart("character",1);if(m){w=this.document.body.createTextRange();
w.moveToElementText(m[0]);h.setEndPoint("EndToEnd",w);h.moveEnd("character",-1)}else{for(J=c[0].nextSibling;J&&!y(J);)J=J.nextSibling;J=!(J&&J.nodeValue&&J.nodeValue.match(s))&&(w||!c[0].previousSibling||c[0].previousSibling&&d.d(c[0].previousSibling)=="br");t=new e(this.document.createElement("span"));t.html("&#65279;");t.insertBefore(c);J&&d.insertBefore(this.document.createTextNode("\ufeff"),c)}this.setStartBefore(c);c.j();if(z){if(J){h.moveStart("character",-1);h.select();this.document.selection.clear()}else h.select();
if(t){this.G(t,r.B);t.j()}}else{this.setEndBefore(m);m.j();h.select()}};x.getSelection=p;k.Nc=x;k.Selection=x;b=x.prototype;k.k.o(b,{getNative:b.z,getType:b.qb,getRanges:b.H,getStartElement:b.pb,getSelectedElement:b.mc,reset:b.reset,selectElement:b.Ac,selectRanges:b.Bb,createBookmarks2:b.Ye,createBookmarks:b.Xe,getCommonAncestor:b.Aa,scrollIntoView:b.scrollIntoView,selectBookmarks:b.Td,removeAllRanges:b.removeAllRanges});k.on("instanceCreated",function(w){I(w.cf)})});
KISSY.Editor.add("styles",function(k){function x(F){return!F.attr("_ke_bookmark")}function p(F,K){for(var E in F)if(F.hasOwnProperty(E))if(J.isString(F[E]))F[E]=F[E].replace(aa,function(H,G){return K[G]});else p(F[E],K)}function I(F,K){if(K){F=J.clone(F);p(F,K)}var E=this.element=this.element=(F.element||"*").toLowerCase();this.type=this.type=E=="#"||W[E]?h.Mb:R[E]?h.cb:h.Ha;this.c={definition:F}}function C(F,K){var E=K?this.zc:this.Xb;F.body.focus();for(var H=new v(F),G=H.H(),M=0;M<G.length;M++)E.call(this,
G[M]);H.Bb(G)}function A(F,K,E){var H=F.element;if(H=="*")H="span";K=new O(K.createElement(H));E&&E.Qc(K);return u(K,F)}function u(F,K){var E=K.c.definition,H=E.attributes;E=I.zd(E);if(H)for(var G in H)F.attr(G,H[G]);if(E)F[0].style.cssText=E;return F}function q(F){var K=F.O(s),E=F.Ze();E.gc=s;E.sd=s;for(var H,G=F.document;H=E.lf();){var M=A(this,G,H);H=H;var L=M;M=L.d=="pre";var S=H.d=="pre",U=!M&&S;if(M&&!S){S=H;L=L;U=S.html();U=l(U,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");U=U.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,
"$1");U=U.replace(/([ \t\n\r]+|&nbsp;)/g," ");U=U.replace(/<br\b[^>]*>/gi,"\n");if(Q.ie){S=S[0].ownerDocument.createElement("div");S.appendChild(L[0]);L[0].outerHTML="<pre>"+U+"</pre>";L=new O(S.firstChild);L.j()}else L.html(U);L=L}else if(U)L=f(d(H),L);else H.Tb(L);H[0].parentNode.replaceChild(L[0],H[0]);if(M){H=L;M=void 0;if((M=H.ga(s,n.e))&&M.d()=="pre"){L=l(M.html(),/\n$/,"")+"\n\n"+l(H.html(),/^\n/,"");if(Q.ie)H[0].outerHTML="<pre>"+L+"</pre>";else H.html(L);M.j()}}}F.moveToBookmark(K)}function l(F,
K,E){var H="",G="";F=F.replace(/(^<span[^>]+_ke_bookmark.*?\/span>)|(<span[^>]+_ke_bookmark.*?\/span>$)/gi,function(M,L,S){L&&(H=L);S&&(G=S);return""});return H+F.replace(K,E)+G}function d(F){var K=[];l(F.gb(),/(\S\s*)\n(?:\s|(<span[^>]+_ck_bookmark.*?\/span>))*\n(?!$)/gi,function(E,H,G){return H+"</pre>"+G+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(E,H){K.push(H)});return K}function f(F,K){for(var E=K[0].ownerDocument.createDocumentFragment(),H=0;H<F.length;H++){var G=F[H];G=G.replace(/(\r\n|\r)/g,
"\n");G=l(G,/^[ \t]*\n/,"");G=l(G,/\n$/,"");G=l(G,/^[ \t]+|[ \t]+$/g,function(L,S){return L.length==1?"&nbsp;":S?" "+Array(L.length).join("&nbsp;"):Array(L.length).join("&nbsp;")+" "});G=G.replace(/\n/g,"<br>");G=G.replace(/[ \t]{2,}/g,function(L){return Array(L.length).join("&nbsp;")+" "});var M=K.K();M.html(G);E.appendChild(M[0])}return E}function e(F){var K=F.document;if(F.collapsed){K=A(this,K,undefined);F.insertNode(K);F.G(K,m.J)}else{var E=this.element,H=this.c.definition,G,M=k.m[E]||(G=s,k.m.span),
L=F.O();F.Oa(m.Jb);F.trim();var S=F.O(),U=S.ba;S=S.Q;for(var $=U,da;$&&$[0];){var Z=w;if(c.g($,S)){$=z;Z=s}else{var ba=$[0].nodeType,fa=ba==n.e?$.d():z;if(fa&&$.attr("_ke_bookmark")){$=$.v(s);continue}if(!fa||M[fa]&&($.La(S)|D.aa|D.ea|D.$)==D.aa+D.ea+D.$&&(!H.childRule||H.childRule($))){var ha=$.parent();if(ha&&ha[0]&&((k.m[ha.d()]||k.m.span)[E]||G)&&(!H.parentRule||H.parentRule(ha))){if(!da&&(!fa||!k.m.ca[fa]||($.La(S)|D.aa|D.ea|D.$)==D.aa+D.ea+D.$)){da=new P(K);da.setStartBefore($)}if(ba==n.f||
ba==n.e&&!$[0].childNodes.length){ba=$;for(var ga;(Z=!ba.Ka(x))&&(ga=ba.parent(),M[ga.d()])&&(ga.La(U)|D.da|D.ea|D.$)==D.da+D.ea+D.$&&(!H.childRule||H.childRule(ga));)ba=ga;da.setEndAfter(ba)}}else Z=s}else Z=s;$=$.v()}if(Z&&da&&!da.collapsed){Z=A(this,K,undefined);ba=da.Aa();fa={Lf:{},Oe:{},gd:{},fd:{}};for(var ea,ia,ja;Z&&ba&&Z[0]&&ba[0];){if(ba.d()==E){for(ea in H.attributes)if(!(fa.fd[ea]||!(ja=ba.attr(ia))))if(Z.attr(ea)==ja)Z.removeAttr(ea);else fa.fd[ea]=1;for(ia in H.styles)if(!(fa.gd[ia]||
!(ja=ba.L(ia))))if(Z.L(ia)==ja)Z.L(ia,"");else fa.gd[ia]=1;if(!Z.fb()){Z=z;break}}ba=ba.parent()}if(Z){Z[0].appendChild(da.extractContents());o(this,Z);da.insertNode(Z);Z.ra();Q.ie||Z[0].normalize()}else{Z=new O(K.createElement("span"));Z[0].appendChild(da.extractContents());da.insertNode(Z);o(this,Z);Z.j(T)}da=z}}U.j();S.j();F.moveToBookmark(L);F.Ta(m.Lc)}}function i(F){F.Oa(m.Jb);var K=F.O(),E=K.ba;if(F.collapsed){for(var H=new N(E.parent()),G,M=0,L;M<H.elements.length&&(L=H.elements[M]);M++){if(L==
H.w||L==H.D)break;if(this.ia(L)){var S=F.dc(L,m.de),U=!S&&F.dc(L,m.bb);if(U||S){G=L;G.match=U?"start":"end"}else{L.ra();if(L.d()!=this.element){S=a(this);B(L,S[L.d()]||S["*"])}else b(this,L)}}}if(G&&G[0]){L=E;for(M=0;;M++){S=H.elements[M];if(c.g(S,G))break;else if(S.match)continue;else S=S.K();S[0].appendChild(L[0]);L=S}c[G.match=="start"?"insertBefore":"insertAfter"](L,G)}}else{var $=K.Q,da=this;H=function(){for(var Z=new N(E.parent()),ba=new N($.parent()),fa=z,ha=z,ga=0;ga<Z.elements.length;ga++){var ea=
Z.elements[ga];if(ea==Z.w||ea==Z.D)break;if(da.ia(ea))fa=ea}for(ga=0;ga<ba.elements.length;ga++){ea=ba.elements[ga];if(ea==ba.w||ea==ba.D)break;if(da.ia(ea))ha=ea}ha&&$.Pb(ha);fa&&E.Pb(fa)};H();for(G=new O(E[0].nextSibling);G[0]!==$[0];){M=G.v();if(G[0]&&G[0].nodeType==n.e&&this.ia(G)){if(G.d()==this.element)b(this,G);else{L=a(this);B(G,L[G.d()]||L["*"])}if(M[0].nodeType==n.e&&M.contains(E)){H();M=new O(E[0].nextSibling)}}G=M}}F.moveToBookmark(K)}function r(F){F=String(F);var K={};F.replace(/&quot;/g,
'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(E,H,G){K[H]=G});return K}function j(F,K){var E="";if(K!==w){E=document.createElement("span");E.style.cssText=F;E=E.style.cssText||""}else E=F;return E.replace(/\s*([;:])\s*/,"$1").replace(/([^\s;])$/,"$1;").replace(/,\s+/g,",").toLowerCase()}function a(F){if(F.c.Sd)return F.c.Sd;var K=F.c.Sd={},E=F.c.definition.overrides;if(E){J.isArray(E)||(E=[E]);for(var H=0;H<E.length;H++){var G=E[H],M,L,S;if(typeof G=="string")M=G.toLowerCase();else{M=
G.element?G.element.toLowerCase():F.element;L=G.attributes;S=G.styles}G=K[M]||(K[M]={});if(L){M=G.attributes=G.attributes||[];for(var U in L)L.hasOwnProperty(U)&&M.push([U.toLowerCase(),L[U]])}if(S){G=G.styles=G.styles||[];for(var $ in S)S.hasOwnProperty($)&&G.push([$.toLowerCase(),S[$]])}}}return K}function b(F,K){var E=F.c.definition,H=a(F),G=t.mix(E.attributes,(H[K.d()]||H["*"]||{}).attributes);E=t.mix(E.styles,(H[K.d()]||H["*"]||{}).styles);H=J.isEmptyObject(G)&&J.isEmptyObject(E);for(var M in G)if(G.hasOwnProperty(M))if(!((M==
"class"||F.c.definition.fullMatch)&&K.attr(M)!=g(M,G[M]))){H=H||!!K.eb(M);K.removeAttr(M)}for(var L in E)if(E.hasOwnProperty(L))if(!(F.c.definition.fullMatch&&K.L(L)!=g(L,E[L],s))){H=H||!!K.L(L);K.L(L,"")}y(K)}function g(F,K,E){var H=new O("<span>");H[E?"_4e_style":"attr"](F,K);return H[E?"_4e_style":"attr"](F)}function o(F,K){for(var E=a(F),H=K.all(F.element),G=H.length;--G>=0;)b(F,new O(H[G]));for(var M in E)if(M!=F.element){H=K.all(M);for(G=H.length-1;G>=0;G--){var L=new O(H[G]);B(L,E[M])}}}function B(F,
K){var E,H=K&&K.attributes;if(H)for(E=0;E<H.length;E++){var G=H[E][0],M;if(M=F.attr(G)){var L=H[E][1];if(L===z||L.test&&L.test(M)||typeof L=="string"&&M==L)F[0].removeAttribute(G)}}if(H=K&&K.styles)for(E=0;E<H.length;E++){G=H[E][0];if(L=F.css(G)){var S=H[E][1];if(S===z||S.test&&S.test(M)||typeof S=="string"&&L==S)F.css(G,"")}}y(F)}function y(F){if(!F.fb()){var K=F[0].firstChild,E=F[0].lastChild;F.j(s);if(K){K.nodeType==n.e&&c.ra(K);E&&K!=E&&E.nodeType==n.e&&c.ra(E)}}}var s=T,w=Y,z=V,J=KISSY,t=k.k,
c=J.DOM,h={Mb:1,Ha:2,cb:3},m=k.na,v=k.Nc,n=k.n,D=k.$a,P=k.Range,O=J.Node,Q=J.UA,N=k.Za,W={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1},R={embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1},X=/\s*(?:;\s*|$)/g,aa=/#\((.+?)\)/g;k.lg=h;I.prototype={apply:function(F){C.call(this,F,w)},remove:function(F){C.call(this,F,s)},Xb:function(F){return(this.Xb=this.type==h.Ha?e:this.type==h.Mb?q:this.type==h.cb?z:z).call(this,F)},zc:function(F){return(this.zc=this.type==
h.Ha?i:z).call(this,F)},Le:function(F){u(F,this)},ia:function(F,K){if(!F)return w;var E=this.c.definition,H;if(F.d()==this.element){if(!K&&!F.fb())return s;var G=E.se;if(G)E=G;else{G={};var M=0,L=E.attributes;if(L)for(var S in L){M++;G[S]=L[S]}if(L=I.zd(E)){G.style||M++;G.style=L}G._length=M;E=E.se=G}if(E._length){for(var U in E)if(U!="_length"){M=F.attr(U)||"";if(U=="style")a:{G=E[U];M=j(M,w);typeof G=="string"&&(G=r(G));typeof M=="string"&&(M=r(M));L=void 0;for(L in G)if(!(L in M&&(M[L]==G[L]||
G[L]=="inherit"||M[L]=="inherit"))){G=w;break a}G=s}else G=E[U]==M;if(G){if(!K)return s}else if(K)return w}if(K)return s}else return s}U=a(this);if(U=U[F.d()]||U["*"]){if(!(E=U.attributes)&&!(H=U.Lf))return s;if(E)for(G=0;G<E.length;G++){U=E[G][0];if(U=F.attr(U)){M=E[G][1];if(M===z||typeof M=="string"&&U==M||M.test&&M.test(U))return s}}if(H)for(G=0;G<H.length;G++)if(U=F.css(H[G][0])){E=H[G][1];if(E===z||typeof E=="string"&&U==E||E.test&&E.test(U))return s}}return w},Te:function(F){switch(this.type){case h.Mb:return this.ia(F.w||
F.D,s);case h.cb:case h.Ha:for(var K=F.elements,E=0,H;E<K.length;E++){H=K[E];if(!(this.type==h.Ha&&(c.g(H,F.w)||c.g(H,F.D))))if(!(this.type==h.cb&&!(H.d()in R)))if(this.ia(H,s))return s}}return w}};I.zd=function(F){var K=F.te;if(K)return K;K=F.styles;var E=F.attributes&&F.attributes.style||"",H="";if(E.length)E=E.replace(X,";");for(var G in K){var M=K[G],L=(G+":"+M).replace(X,";");if(M=="inherit")H+=L;else E+=L}if(E.length)E=j(E);E+=H;return F.te=E};k.mg=I;k.Style=I;var ca=I.prototype;k.k.o(ca,{apply:ca.apply,
remove:ca.remove,applyToRange:ca.Xb,removeFromRange:ca.zc,applyToObject:ca.Le,checkElementRemovable:ca.ia,checkActive:ca.Te})});
KISSY.Editor.add("htmlparser",function(){function k(){}function x(){this.c={Cd:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)--\>)|(?:([^\\s>]+)\\s*((?:(?:[^\"'>]+)|(?:\"[^\"]*\")|(?:'[^']*'))*)\\/?>))","g")}}var p=KISSY,I=p.Editor,C=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,A={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},u=I.m;p.augment(x,{Da:k,Rd:k,la:k,Nd:k,Ra:k,parse:function(q){for(var l,
d,f=0,e;l=this.c.Cd.exec(q);){d=l.index;if(d>f){f=q.substring(f,d);e?e.push(f):this.la(f)}f=this.c.Cd.lastIndex;if(d=l[1]){d=d.toLowerCase();if(e&&u.Fc[d]){this.Nd(e.join(""));e=V}if(!e){this.Rd(d);continue}}if(e)e.push(l[0]);else if(d=l[3]){d=d.toLowerCase();if(!/="/.test(d)){var i={},r;l=l[4];var j=!!(l&&l.charAt(l.length-1)=="/");if(l)for(;r=C.exec(l);){var a=r[1].toLowerCase();r=r[2]||r[3]||r[4]||"";i[a]=!r&&A[a]?a:r}this.Da(d,i,j);if(!e&&u.Fc[d])e=[]}}else if(d=l[2])this.Ra(d)}q.length>f&&this.la(q.substring(f,
q.length))}});I.h=x;I.HtmlParser=x});
KISSY.Editor.add("htmlparser-basicwriter",function(){function k(){this.c={l:[]}}var x=KISSY,p=x.Editor,I=p.k;x.augment(k,{wb:function(C){this.c.l.push("<",C)},xb:function(C,A){A?this.c.l.push(" />"):this.c.l.push(">")},lb:function(C,A){if(typeof A=="string")A=I.pc(A);this.c.l.push(" ",C,'="',A,'"')},mb:function(C){this.c.l.push("</",C,">")},text:function(C){this.c.l.push(C)},N:function(C){this.c.l.push("<!--",C,"--\>")},write:function(C){this.c.l.push(C)},reset:function(){this.c.l=[];this.c.A=Y},
kc:function(C){var A=this.c.l.join("");C&&this.reset();return A}});p.h.Hb=k;p.h.BasicWriter=k;x=k.prototype;p.k.o(x,{openTag:x.wb,openTagClose:x.xb,attribute:x.lb,closeTag:x.mb,text:x.text,comment:x.N,write:x.write,reset:x.reset,getHtml:x.kc})});
KISSY.Editor.add("htmlparser-htmlwriter",function(){function k(){k.superclass.constructor.call(this);this.Dd="\t";this.Gf=" />";this.xf="\n";this.gf=A;this.Hf=C;this.c.A=A;this.c.F="";this.c.rules={};var u=p.m,q;for(q in I.mix({},u.Gb,u.Xa,u.Fb,u.Ic))this.Fa(q,{A:C,Qe:C,cc:C,hd:!u[q]["#"],Pe:C});this.Fa("br",{cc:C});this.Fa("title",{A:A,cc:A});this.Fa("style",{A:A,hd:C});this.Fa("pre",{A:A})}var x=KISSY,p=x.Editor,I=p.k,C=T,A=Y;x.extend(k,p.h.Hb,{wb:function(u){var q=this.c.rules[u];if(this.c.A)this.F();
else if(q&&q.Qe){this.Pa();this.F()}this.c.l.push("<",u)},xb:function(u,q){var l=this.c.rules[u];if(q)this.c.l.push(this.Gf);else{this.c.l.push(">");if(l&&l.A)this.c.F+=this.Dd}l&&l.cc&&this.Pa()},lb:function(u,q){if(typeof q=="string"){this.gf&&(q=q.replace(/&amp;/g,"&"));q=I.pc(q)}this.c.l.push(" ",u,'="',q,'"')},mb:function(u){var q=this.c.rules[u];if(q&&q.A)this.c.F=this.c.F.substr(this.Dd.length);if(this.c.A)this.F();else if(q&&q.hd){this.Pa();this.F()}this.c.l.push("</",u,">");q&&q.Pe&&this.Pa()},
text:function(u){if(this.c.A){this.F();u=I.Qa(u)}this.c.l.push(u)},N:function(u){this.c.A&&this.F();this.c.l.push("<!--",u,"--\>")},Pa:function(){this.c.l.length>0&&this.c.l.push(this.xf);this.c.A=C},F:function(){this.c.l.push(this.c.F);this.c.A=A},Fa:function(u,q){var l=this.c.rules[u];if(l)I.mix(l,q);else this.c.rules[u]=q}});p.h.$f=k;p.h.HtmlWriter=k;x=k.prototype;p.k.o(x,{openTag:x.wb,openTagClose:x.xb,attribute:x.lb,closeTag:x.mb,text:x.text,comment:x.N,lineBreak:x.Pa,indentation:x.F,setRules:x.Fa})});
KISSY.Editor.add("htmlparser-fragment",function(){function k(){this.children=[];this.parent=I;this.c={S:x,oc:p}}var x=T,p=Y,I=V,C=KISSY.Editor,A={colgroup:1,dd:1,dt:1,li:1,option:1,p:1,td:1,tfoot:1,th:1,thead:1,tr:1},u=KISSY,q=C.k,l=C.n,d=C.m;q.mix({table:1,ul:1,ol:1,dl:1},d.table,d.ul,d.ol,d.dl);var f=d.$d,e=d.Fb;k.Kb=function(i,r){function j(c){var h;if(B.length>0)for(var m=0;m<B.length;m++){var v=B[m],n=v.name,D=d[n],P=s.name&&d[s.name];if((!P||P[n])&&(!c||!D||D[c]||!d[c])){if(!h){a();h=1}v=v.clone();
v.parent=s;s=v;B.splice(m,1);m--}}}function a(){for(;y.length;)s.add(y.shift())}function b(c,h,m){h=h||s||o;if(r&&!h.type){var v,n;if((v=c.attributes&&(n=c.attributes._ke_real_element_type)?n:c.name)&&!(v in d.Ec)&&!(v in d.Gb)){n=s;s=h;g.Da({Yg:"ul",Pg:"dl",Kg:"dl"}[v]||r,{});h=s;if(m)s=n}}if(c.c.S&&c.name!="pre"){m=c.children.length;if((v=c.children[m-1])&&v.type==l.f)if(n=q.Sa(v.value))v.value=n;else c.children.length=m-1}h.add(c);if(c.zb){s=c.zb;delete c.zb}}var g=new C.h,o=new k,B=[],y=[],s=
o,w=p,z;g.Da=function(c,h,m){var v=new C.h.Jc(c,h);if(v.rc&&m)v.sb=x;if(d.ca[c])B.push(v);else{if(c==="pre")w=x;else if(c==="br"&&w){s.add(new C.h.Nb("\n"));return}if(c==="br")y.push(v);else{var n=s.name,D=n&&(d[n]||(s.c.S?d.div:d.span));if(D&&!v.rc&&!s.rc&&!D[c]){D=p;var P;if(c in f&&n in f){n=s.children;(n=n[n.length-1])&&n.name in e||b(n=new C.h.Jc("li"),s);z=s;P=n}else if(c==n)b(s,s.parent);else{b(s,s.parent,x);!A[n]&&n in d.Eb&&B.unshift(s);D=x}s=P?P:s.zb||s.parent;if(D){g.Da.apply(this,arguments);
return}}j(c);a();v.parent=s;v.zb=z;z=0;if(v.sb)b(v);else s=v}}};g.Rd=function(c){for(var h=B.length-1;h>=0;h--)if(c==B[h].name){B.splice(h,1);return}for(var m=[],v=[],n=s;n.type&&n.name!=c;){n.c.S||v.unshift(n);m.push(n);n=n.parent}if(n.type){for(h=0;h<m.length;h++){var D=m[h];b(D,D.parent)}s=n;if(s.name=="pre")w=p;n.c.S&&a();b(n,n.parent);if(n==s)s=s.parent;B=B.concat(v)}if(c=="body")r=p};g.la=function(c){if(!s.c.oc&&!w){c=q.Qa(c);if(c.length===0)return}a();j();if(r&&(!s.type||s.name=="body")&&q.trim(c))this.Da(r,
{});w||(c=c.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));s.add(new C.h.Nb(c))};g.Nd=function(c){s.add(new C.h.jd(c))};g.Ra=function(c){s.add(new C.h.be(c))};g.parse(i);for(a();s.type;){var J=s.parent,t=s;if(r&&(!J.type||J.name=="body")&&!d.Ec[t.name]){s=J;g.Da(r,{});J=s}J.add(t);s=J}return o};u.augment(k,{add:function(i){var r=this.children.length;if(r=r>0&&this.children[r-1]||I){if(i.c.S&&r.type==l.f){r.value=q.Sa(r.value);if(r.value.length===0){this.children.pop();this.add(i);return}}r.next=i}i.yb=r;
i.parent=this;this.children.push(i);this.c.oc=i.type==l.f||i.type==l.e&&!i.c.S},Y:function(i,r){var j;this.filterChildren=this.ic=function(){var a=new C.h.Hb;this.X.call(this,a,r,x);a=a.kc();this.children=(new k.Kb(a)).children;j=1};!this.name&&r&&r.Pd(this);this.X(i,j?I:r)},X:function(i,r){for(var j=0;j<this.children.length;j++)this.children[j].Y(i,r)}});C.h.Ga=k;C.h.Fragment=k;k.FromHtml=k.Kb;u=k.prototype;C.k.o(u,{add:u.add,writeHtml:u.Y,writeChildrenHtml:u.X})});
KISSY.Editor.add("htmlparser-element",function(){function k(A,u){A=A[0];u=u[0];return A<u?-1:A>u?1:0}function x(A,u){this.name=A;this.attributes=u||(u={});this.children=[];var q=u.sg||A,l=p.m;q=!!(l.Gb[q]||l.Xa[q]||l.Fb[q]||l.Ic[q]||l.Hc[q]||q=="br");var d=!!l.Db[A];this.sb=d;this.rc=!l[A];this.c={S:q,oc:d||!q}}var p=KISSY.Editor,I=p.n;KISSY.augment(x,{type:I.e,add:p.h.Ga.prototype.add,clone:function(){return new x(this.name,this.attributes)},Y:function(A,u){var q=this.attributes,l=this,d=l.name,
f,e,i,r;l.ic=function(){if(!r){var b=new p.h.Hb;p.h.Ga.prototype.X.call(l,b,u);l.children=(new p.h.Ga.Kb(b.kc())).children;r=1}};l.filterChildren=l.ic;if(u){for(;;){if(!(d=u.Od(d)))return;l.name=d;if(!(l=u.uc(l)))return;l.parent=this.parent;if(l.name==d)break;if(l.type!=I.e){l.Y(A,u);return}d=l.name;if(!d){this.X.call(l,A,r?V:u);return}}q=l.attributes}A.wb(d,q);for(var j=[],a=0;a<2;a++)for(f in q){e=f;i=q[f];if(a==1)j.push([f,i]);else if(u){for(;;)if(e=u.Md(f))if(e!=f){delete q[f];f=e}else break;
else{delete q[f];break}if(e)if((i=u.Ld(l,e,i))===Y)delete q[e];else q[e]=i}}A.Hf&&j.sort(k);q=j.length;for(a=0;a<q;a++){f=j[a];A.lb(f[0],f[1])}A.xb(d,l.sb);if(!l.sb){this.X.call(l,A,r?V:u);A.mb(d)}},X:function(){p.h.Ga.prototype.X.apply(this,arguments)}});p.h.Jc=x;p.h.Element=x;var C=x.prototype;p.k.o(C,{type:C.type,add:C.add,clone:C.clone,writeHtml:C.Y,writeChildrenHtml:C.X})});
KISSY.Editor.add("htmlparser-filter",function(){function k(f){this.c={fc:[],Zb:[],elements:{Gc:0},attributes:{Gc:0}};f&&this.ed(f,10)}function x(f,e){for(var i=0;f&&i<e.length;i++){var r=e[i];f=f.replace(r[0],r[1])}return f}function p(f,e,i){if(typeof e=="function")e=[e];var r,j;j=f.length;var a=e&&e.length;if(a){for(r=0;r<j&&f[r].yc<i;r++);for(j=a-1;j>=0;j--)if(a=e[j]){a.yc=i;f.splice(r,0,a)}}}function I(f,e,i){if(e)for(var r in e){var j=f[r];f[r]=C(j,e[r],i);j||f.Gc++}}function C(f,e,i){if(e){e.yc=
i;if(f){if(f.splice)p(f,e,i);else{f=f.yc>i?[e,f]:[f,e];f.filter=A}return f}else return e.filter=e}}function A(f){for(var e=f.type||f instanceof q.h.Ga,i=0;i<this.length;i++){if(e)var r=f.type,j=f.name;var a=this[i].apply(window,arguments);if(a===d)return a;if(e){if(a&&(a.name!=j||a.type!=r))return a}else if(typeof a!="string")return a;a!=undefined&&(f=a)}return f}var u=KISSY,q=u.Editor,l=q.n,d=Y;u.augment(k,{ed:function(f,e){if(typeof e!="number")e=10;p(this.c.fc,f.fc,e);p(this.c.Zb,f.Zb,e);I(this.c.elements,
f.elements,e);I(this.c.attributes,f.attributes,e);this.c.text=C(this.c.text,f.text,e)||this.c.text;this.c.N=C(this.c.N,f.N,e)||this.c.N;this.c.Ab=C(this.c.Ab,f.Ab,e)||this.c.Ab},Od:function(f){return x(f,this.c.fc)},Md:function(f){return x(f,this.c.Zb)},la:function(f){var e=this.c.text;return e?e.filter(f):f},Ra:function(f,e){var i=this.c.N;return i?i.filter(f,e):f},Pd:function(f){var e=this.c.Ab;return e?e.filter(f):f},uc:function(f){for(var e=[this.c.elements["^"],this.c.elements[f.name],this.c.elements.Rf],
i,r=0;r<3;r++)if(i=e[r]){i=i.filter(f,this);if(i===d)return V;if(i&&i!=f)return this.Qd(i);if(f.parent&&!f.name)break}return f},Qd:function(f){var e=f.type;return e==l.e?this.uc(f):e==l.f?new q.h.Nb(this.la(f.value)):V},Ld:function(f,e,i){if(e=this.c.attributes[e]){f=e.filter(i,f,this);if(f===d)return d;if(typeof f!="undefined")return f}return i}});q.h.Zf=k;u=k.prototype;q.k.o(u,{addRules:u.ed,onElementName:u.Od,onAttributeName:u.Md,onText:u.la,onComment:u.Ra,onFragment:u.Pd,onElement:u.uc,onNode:u.Qd,
onAttribute:u.Ld});q.h.Filter=k});KISSY.Editor.add("htmlparser-text",function(){function k(C){this.value=C;this.c={S:I}}var x=KISSY,p=x.Editor,I=Y;x.augment(k,{type:p.n.f,Y:function(C,A){var u=this.value;A&&!(u=A.la(u,this))||C.text(u)}});p.h.Nb=k;p.h.Text=k});KISSY.Editor.add("htmlparser-cdata",function(k){k.h.jd=function(x){this.value=x};k.h.jd.prototype={type:k.n.f,Y:function(x){x.write(this.value)}}});
KISSY.Editor.add("htmlparser-comment",function(){function k(I){this.value=I;this.c={S:Y}}var x=KISSY.Editor,p=x.n;x.h.be=k;x.h.Comment=k;k.prototype={constructor:k,type:p.ee,Y:function(I,C){var A=this.value;if(C){if(!(A=C.Ra(A,this)))return;if(typeof A!="string"){A.parent=this.parent;A.Y(I,C);return}}I.N(A)}}});
KISSY.Editor.add("button",function(){var k=KISSY,x=k.Editor;if(x.le)k.log("TripleButton attach twice","warn");else{k=k.UIBase.create([k.UIBase.Box],{Fg:function(){var p=this,I=p.get("el");I.on("click",p.ve,p);I.on("mousedown",function(){p.get("state")=="off"&&I.addClass("ke-triplebutton-active")});I.on("mouseup mouseleave",function(){p.get("state")=="off"&&I.hasClass("ke-triplebutton-active")&&setTimeout(function(){I.removeClass("ke-triplebutton-active")},300)})},zg:function(){this.get("el").attr("title",
this.get("title"))},wg:function(p){var I=this.get("el");if(p!==undefined){I.html("<span class='ke-toolbar-item "+p+"'>");I.ta()}},yg:function(p){var I=this.get("el");p!==undefined&&I.html(p)},xg:function(p){this["_"+p]()},pd:function(){this.De=this.get("state");this.set("state","disabled")},rd:function(){this.get("state")=="disabled"&&this.set("state",this.De)},ve:function(p){this.fire(this.get("state")+"Click",{og:p});this.fire("click",{ng:this.get("state")+"Click"});p&&p.halt()},Hg:function(){this.set("state",
"on")},Gg:function(){this.set("state","off")},ug:function(){var p=this.get("el");p.removeClass("ke-triplebutton-off ke-triplebutton-disabled");p.addClass("ke-triplebutton-on")},tg:function(){var p=this.get("el");p.removeClass("ke-triplebutton-on ke-triplebutton-disabled");p.addClass("ke-triplebutton-off")},qg:function(){var p=this.get("el");p.removeClass("ke-triplebutton-off ke-triplebutton-on");p.addClass("ke-triplebutton-disabled")}},{ae:{Jf:{value:"off"},ef:{value:"ke-triplebutton ke-triplebutton-off"},
Qg:{value:{hideFocus:T,tabIndex:-1}},Rg:{value:"a"},title:{},Ig:{},text:{}}});k.gg="on";k.eg="off";k.ce="disabled";k.hg="ke-triplebutton-on";k.fg="ke-triplebutton-off";k.Xf="ke-triplebutton-disabled";x.le=k}});
KISSY.Editor.add("select",function(){function k(d){k.superclass.constructor.call(this,d);this.ye()}var x=KISSY,p=x.Node,I=x.Event,C=x.DOM,A=x.Editor;if(A.ke)x.log("ke select attach more");else{k.ce=0;k.Yf=1;var u=A.m;k.ae={gh:{},P:{},We:{},xa:{},Og:{},value:{},width:{},title:{},vf:{},Tg:{},align:{value:["l","b"]},Zg:{lh:function(){for(var d=this.P.parent();d;){var f=d.d();if(u[f]&&u[f].div)return d;d=d.parent()}return new p(document.body)}},Jf:{value:1}};k.Lg=function(d){for(var f=d.width(),e=[],
i=d.all("option"),r=0;r<i.length;r++){var j=i[r];e.push({name:C.html(j),value:C.attr(j,"value")})}return new k({width:f+"px",P:d,vf:e,We:"ke-combox",value:d.val()})};var q=A.k.Ke,l=A.k.$e;x.extend(k,x.Base,{ye:function(){var d=this.get("container"),f=this.get("el"),e=new p("<span class='ke-select-wrap'><a onclick='return false;' class='ke-select'><span class='ke-select-text'><span class='ke-select-text-inner'></span></span><span class='ke-select-drop-wrap'><span class='ke-select-drop'></span></span></a></span>"),
i=this.get("title")||"",r=this.get("cls"),j=e.one(".ke-select-text"),a=e.one(".ke-select-text-inner");e.one(".ke-select-drop");this.get("value")!==undefined?a.html(this.Xc(this.get("value"))):a.html(i);j.css("width",this.get("width"));e.ta();i&&e.attr("title",i);r&&e.addClass(r);if(f)f[0].parentNode.replaceChild(e[0],f[0]);else d&&e.appendTo(d);e.on("click",this.xe,this);this.P=e;this.title=a;this.Yc=e.one("a.ke-select");A.k.Id(this,"_prepare","_real");this.on("afterValueChange",this.Ge,this);this.on("afterStateChange",
this.Fe,this)},Xc:function(d){var f=this.get("title")||"",e=this.get("items");if(this.get("showValue"))return d||f;for(var i=0;i<e.length;i++){var r=e[i];if(r.value==d){f=r.name;break}}return f},Ge:function(d){this.title.html(this.Xc(d.ub))},Zc:function(d){var f;f=d.ub;d=this.bd;d.html("");if(f&&f.length)for(var e=0;e<f.length;e++){var i=f[e];(new p("<a class='ke-select-menu-item' href='#' data-value='"+i.value+"'>"+i.name+"</a>",i.Oe)).appendTo(d).ta()}else if(f=this.get("emptyText"))(new p("<a class='ke-select-menu-item' href='#'>"+
f+"</a>")).appendTo(d).ta();this.Yb=d.all("a")},val:function(d){if(d!==undefined){this.set("value",d);return this}else return this.get("value")},ad:function(){this.T.get("visible")&&this.Ce()},ze:function(){function d(b){b=new p(b.target);e.contains(b)||e.g(b)||j.hide()}var f=this,e=f.P,i=f.get("popUpWidth"),r=f.Yc,j=new A.fe({Dg:T,fh:f.get("menuContainer"),content:"<div>",Ug:Y,ef:"ke-menu",width:i?i:e.width(),zIndex:A.$b(A.Dc.he),Vg:Y}),a=f.get("items");q.call(f,j);i=j.get("contentEl").one("div");
f.T=j;I.on(window,"resize",f.ad,f);q.call(f,function(){I.remove(window,"resize",f.ad,f)});f.get("title")&&(new p("<div class='ke-menu-title ke-select-menu-item' style='margin-top:-6px;' >"+f.get("title")+"</div>")).appendTo(i);f.bd=(new p("<div>")).appendTo(i);f.Zc({ub:a});j.on("show",function(){r.addClass("ke-select-active")});j.on("hide",function(){r.removeClass("ke-select-active")});I.on(document,"click",d);q.call(f,function(){I.remove(document,"click",d)});f.get("doc")&&I.on(f.get("doc"),"click",
d);i.on("click",f.Ee,f);f.Yb=f.bd.all("a");I.on(i[0],"mouseenter",function(){f.Yb.removeClass("ke-menu-selected")});q.call(f,i);f.on("afterItemsChange",f.Zc,f);f.zf=i},Fe:function(d){var f=this.P;d.ub==1?f.removeClass("ke-select-disabled"):f.addClass("ke-select-disabled")},rd:function(){this.set("state",1)},pd:function(){this.set("state",0)},Ee:function(d){d&&d.halt();var f=this.T,e=this.zf;if((d=(new p(d.target)).Oc(function(j){return e.contains(j)&&j.d()=="a"},T))&&d.eb("data-value")){var i=this.get("value"),
r=d.attr("data-value");this.set("value",r);this.fire("click",{ub:r,ah:i,name:d.html()});f.hide()}},Ce:function(){var d=this.P,f=d.offset(),e=x.clone(f),i=this.T.get("el").height(),r=this.T.get("el").width(),j=C.scrollTop(),a=C.scrollLeft(),b=C.viewportHeight(),g=C.viewportWidth();g=a+g-60;b=j+b;var o=f.top+(d.height()-2);d=f.left+d.width()-2;var B=this.get("align"),y=B[0];if(B[1]=="b"){f.top=o;if(f.top+i>b&&e.top-j>b-o)f.top=e.top-i}else{f.top=e.top-i;if(f.top<j&&e.top-j<b-o)f.top=o}if(y=="l"){if(f.left+
r>g&&d-a>g-e.left)f.left=d-r}else{f.left=d-r;if(f.left<a&&d-a<g-e.left)f.left=e.left}this.T.set("xy",[f.left,f.top]);this.T.show()},xe:function(d){if(!this.sc){d&&d.halt();var f=this;d=f.P;var e=f.get("value");if(!d.hasClass("ke-select-disabled"))if(f.Yc.hasClass("ke-select-active"))f.T&&f.T.hide();else{f.sc=T;A.use("overlay",function(){f.sc=Y;f.ze();e&&f.T&&f.Yb.each(function(i){i.attr("data-value")==e?i.addClass("ke-menu-selected"):i.removeClass("ke-menu-selected")})})}}},za:function(){l.call(this);
this.P.detach();this.P.remove()}});A.ke=k}});
