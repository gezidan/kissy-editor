KISSY.Editor.add("bubbleview",function(){function d(a){d.superclass.constructor.apply(this,arguments);a.init&&a.init.call(this)}var f=KISSY.Editor,h=KISSY,k=h.Event,m=h.DOM,n=h.Node;if(!f.BubbleView){var i={};d.attach=function(a){var g=a.pluginInstance,j=a.pluginName;a=g.editor;var l=i[j];if(l){var o=l.cfg.func,b=i[j].bubble;a.on("selectionChange",function(c){c=c.path;var e=c.elements;if(c&&e)if(c=c.lastElement)if(c=o(c)){e=i[j];if(!e.bubble)e.bubble=new d(e.cfg);b=e.bubble;b._selectedEl=c;b._plugin=
g;b.show()}else if(b){b._selectedEl=b._plugin=null;b.hide()}});k.on(m._4e_getWin(a.document),"scroll blur",function(){b&&b.hide()});k.on(document,"click",function(){b&&b.hide()})}};d.register=function(a){i[a.pluginName]={cfg:a}};d.ATTRS={focusMgr:{value:false},draggable:{value:false},zIndex:{value:f.baseZIndex(f.zIndexManager.BUBBLE_VIEW)}};h.extend(d,f.SimpleOverlay,{_createEl:function(){var a=(new n('<div class="ke-bubbleview-bubble" onmousedown="return false;"></div>')).appendTo(document.body);
this.el=a;this.set("el",a)},show:function(){var a=this._selectedEl,g=a._4e_getOffset(document);g.top+=a.height()+5;d.superclass.show.call(this,g)}});f.BubbleView=d}});
