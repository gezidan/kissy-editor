KISSY.Editor.add("bubbleview",function(){var g=KISSY.Editor,h=KISSY,j=h.Event,l=h.DOM;if(!g.BubbleView){var f=h.Base.create(g.Overlay,[],{init:function(){this.on("renderUI",this._renderUIBubbleView,this)},_renderUIBubbleView:function(){this.get("el").addClass("ke-bubbleview-bubble")},show:function(){var a=this._selectedEl,c=a._4e_getOffset(document);c.top+=a.height()+5;f.superclass.show.call(this);this.set("xy",[c.left,c.top])}},{ATTRS:{focus4e:false,zIndex:{value:g.baseZIndex(g.zIndexManager.BUBBLE_VIEW)}}}),
i={};f.attach=function(a){var c=a.pluginName;h.mix(a,i[c].cfg,false);var m=a.pluginContext,n=a.func,k=a.editor,b=a.bubble;k.on("selectionChange",function(d){d=d.path;var e=d.elements;if(d&&e)if(d=d.lastElement)if(d=n(d)){e=i[c];if(!e.bubble){e.bubble=new f;e.bubble.renderer();e.cfg.init&&e.cfg.init.call(e.bubble)}b=e.bubble;b._selectedEl=d;b._plugin=m;b.hide();b.show()}else if(b){b._selectedEl=b._plugin=null;b.hide()}});j.on(l._4e_getWin(k.document),"scroll blur",function(){b&&b.hide()})};f.register=
function(a){var c=a.pluginName;i[c]=i[c]||{cfg:a};j.on(document,"click",function(){a.bubble&&a.bubble.hide()});a.editor&&f.attach(a)};g.BubbleView=f}});
