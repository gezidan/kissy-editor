KISSY.Editor.add("font",function(e){var c=KISSY.Editor,i=KISSY,j=c.Style,k=c.TripleButton,l=e.cfg.pluginConfig["font-size"]||{};i.mix(l,{items:["8px","10px","12px","14px","18px","24px","36px","48px","60px","72px","84px","96px","108px"],width:"55px"},false);var r={},s=[],h={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]},p=e.cfg.pluginConfig["font-family"]||["宋体","黑体","隶书","楷体_GB2312","微软雅黑","Georgia","Times New Roman","Impact","Courier New","Arial",
"Verdana","Tahoma"],t={},u=[],x={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},f;e.cfg.pluginConfig["font-size"]=l;e.cfg.pluginConfig["font-family"]=p;for(f=0;f<l.items.length;f++){var g=l.items[f],v=g;if(!i.isString(g)){v=g.name;g=g.value}r[g]=new j(h,{size:g});s.push({name:v,value:g})}for(f=0;f<p.length;f++){h=p[f];t[h]=new j(x,{family:h});u.push({name:h,value:h,attrs:{style:"font-family:"+h}})}c.Font||function(){function m(a){m.superclass.constructor.call(this,
a);this._init()}function o(a){o.superclass.constructor.call(this,a);this._init()}m.ATTRS={title:{},html:{},styles:{},editor:{}};var q=c.Select;i.extend(m,i.Base,{_init:function(){var a=this.get("editor"),b=a.toolBarDiv;this.get("html");this.el=new q({container:b,doc:a.document,width:this.get("width"),popUpWidth:this.get("popUpWidth"),title:this.get("title"),items:this.get("html")});this.el.on("click",this._vChange,this);a.on("selectionChange",this._selectionChange,this);c.Utils.sourceDisable(a,this)},
disable:function(){this.el.set("state",q.DISABLED)},enable:function(){this.el.set("state",q.ENABLED)},_vChange:function(a){var b=this.get("editor"),d=a.newVal;a=a.preVal;var n=this.get("styles");b.focus();b.fire("save");if(d==a){n[d].remove(b.document);this.el.set("value","")}else n[d].apply(b.document);b.fire("save")},_selectionChange:function(a){this.get("editor");a=a.path.elements;for(var b=this.get("styles"),d=0,n;d<a.length;d++){n=a[d];for(var w in b)if(b[w].checkElementRemovable(n,true)){this.el.set("value",
w);return}}this.el.reset("value")}});o.ATTRS={editor:{},text:{},contentCls:{},title:{},style:{}};i.extend(o,i.Base,{_init:function(){var a=this.get("editor"),b=this.get("text");this.get("style");var d=this.get("title");this.el=new k({text:b,title:d,contentCls:this.get("contentCls"),container:a.toolBarDiv});this.el.on("offClick",this._on,this);this.el.on("onClick",this._off,this);a.on("selectionChange",this._selectionChange,this);c.Utils.sourceDisable(a,this)},disable:function(){this.el.set("state",
k.DISABLED)},enable:function(){this.el.set("state",k.OFF)},_on:function(){var a=this.get("editor");this.get("text");var b=this.get("style");this.get("title");a.fire("save");b.apply(a.document);a.fire("save");a.notifySelectionChange();a.focus()},_off:function(){var a=this.get("editor");this.get("text");var b=this.get("style");this.get("title");a.fire("save");b.remove(a.document);a.fire("save");a.notifySelectionChange();a.focus()},_selectionChange:function(a){this.get("editor");this.get("text");var b=
this.get("style");this.get("title");var d=this.el;a=a.path;if(d.get("state")!=k.DISABLED)b.checkActive(a)?d.set("state",k.ON):d.set("state",k.OFF)}});m.SingleFont=o;c.Font=m}();e.addPlugin(function(){new c.Font({editor:e,title:"大小",width:"30px",popUpWidth:l.width,styles:r,html:s});new c.Font({editor:e,title:"字体",width:"110px",popUpWidth:"130px",styles:t,html:u});new c.Font.SingleFont({contentCls:"ke-toolbar-bold",title:"粗体 ",editor:e,style:new j({element:"strong",overrides:[{element:"b"},{element:"span",
attributes:{style:"font-weight: bold;"}}]})});new c.Font.SingleFont({contentCls:"ke-toolbar-italic",title:"斜体 ",editor:e,style:new j({element:"em",overrides:[{element:"i"},{element:"span",attributes:{style:"font-style: italic;"}}]})});new c.Font.SingleFont({contentCls:"ke-toolbar-underline",title:"下划线 ",editor:e,style:new j({element:"u",overrides:[{element:"span",attributes:{style:"text-decoration: underline;"}}]})});new c.Font.SingleFont({contentCls:"ke-toolbar-strikeThrough",title:"删除线 ",editor:e,
style:new j({element:"del",overrides:[{element:"span",attributes:{style:"text-decoration: line-through;"}},{element:"s"}]})})})});
