KISSY.Editor.add("font",function(i){function y(d){for(var b=[],a=0;a<d.length;a++)b.push({name:d[a],value:d[a]});return b}var e=KISSY,h=e.Editor,o=h.Style,s=h.TripleButton,f=i.cfg.pluginConfig,z=e.Node,j=f["font-size"],c,q,m;if(j!==false){j=j||{};e.mix(j,{items:y(["8px","10px","12px","14px","18px","24px","36px","48px","60px","72px","84px","96px"]),width:"55px"},false);var t={},u=[],r={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]};for(k=0;k<j.items.length;k++){c=
j.items[k];q=c.name;m=c.attrs;c=c.value;t[c]=new o(r,{size:c});u.push({name:q,value:c,attrs:m})}f["font-size"]=j}var l=f["font-family"];if(l!==false){l=l||{};e.mix(l,{items:[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u96b6\u4e66",value:"LiSu"},{name:"\u6977\u4f53",value:"KaiTi_GB2312"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft YaHei"},{name:"Georgia",value:"Georgia"},{name:"Times New Roman",value:"Times New Roman"},{name:"Impact",value:"Impact"},{name:"Courier New",value:"Courier New"},{name:"Arial",value:"Arial"},
{name:"Verdana",value:"Verdana"},{name:"Tahoma",value:"Tahoma"}],width:"130px"},false);var v={},w=[];r={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]};var k;f["font-family"]=l;for(k=0;k<l.items.length;k++){c=l.items[k];q=c.name;m=c.attrs||{};c=c.value;m.style=m.style||"";m.style+=";font-family:"+c;v[c]=new o(r,{family:c});w.push({name:q,value:c,attrs:m})}}h.FontSelect||function(){function d(a){d.superclass.constructor.call(this,a);this._init()}
d.ATTRS={title:{},html:{},styles:{},editor:{}};var b=h.Select;e.extend(d,e.Base,{_init:function(){var a=this.get("editor"),g=a.toolBarDiv;this.get("html");this.el=new b({container:g,doc:a.document,width:this.get("width"),popUpWidth:this.get("popUpWidth"),title:this.get("title"),items:this.get("html"),showValue:this.get("showValue"),menuContainer:new z(document.body)});this.el.on("click",this._vChange,this);a.on("selectionChange",this._selectionChange,this);h.Utils.sourceDisable(a,this)},disable:function(){this.el.set("state",
b.DISABLED)},enable:function(){this.el.set("state",b.ENABLED)},_vChange:function(a){var g=this.get("editor"),p=a.newVal;a=a.prevVal;var n=this.get("styles");g.focus();g.fire("save");n=n[p];if(p==a){n.remove(g.document);this.el.set("value","")}else n.apply(g.document);g.fire("save")},_selectionChange:function(a){this.get("editor");a=a.path.elements;for(var g=this.get("styles"),p=0,n;p<a.length;p++){n=a[p];for(var x in g)if(g[x].checkElementRemovable(n,true)){this.el.set("value",x);return}}this.el.reset("value")}});
h.FontSelect=d}();i.ready(function(){false!==f["font-size"]&&new h.FontSelect({editor:i,title:"\u5927\u5c0f",width:"30px",showValue:true,popUpWidth:j.width,styles:t,html:u});false!==f["font-family"]&&new h.FontSelect({editor:i,title:"\u5b57\u4f53",width:"110px",popUpWidth:l.width,styles:v,html:w});var d={mode:h.WYSIWYG_MODE,offClick:function(){var b=this.editor,a=this.cfg.style;b.fire("save");a.apply(b.document);b.fire("save");b.notifySelectionChange();b.focus()},onClick:function(){var b=this.editor,a=this.cfg.style;
b.fire("save");a.remove(b.document);b.fire("save");b.notifySelectionChange();b.focus()},selectionChange:function(b){var a=this.btn;this.cfg.style.checkActive(b.path)?a.set("state",s.ON):a.set("state",s.OFF)}};false!==f["font-bold"]&&i.addButton("font-bold",e.mix({contentCls:"ke-toolbar-bold",title:"\u7c97\u4f53 ",style:new o({element:"strong",overrides:[{element:"b"},{element:"span",attributes:{style:"font-weight: bold;"}}]})},d));false!==f["font-italic"]&&i.addButton("font-italic",e.mix({contentCls:"ke-toolbar-italic",
title:"\u659c\u4f53 ",style:new o({element:"em",overrides:[{element:"i"},{element:"span",attributes:{style:"font-style: italic;"}}]})},d));false!==f["font-underline"]&&i.addButton("font-underline",e.mix({contentCls:"ke-toolbar-underline",title:"\u4e0b\u5212\u7ebf ",style:new o({element:"u",overrides:[{element:"span",attributes:{style:"text-decoration: underline;"}}]})},d));false!==f["font-strikeThrough"]&&i.addButton("font-underline",e.mix({contentCls:"ke-toolbar-strikeThrough",title:"\u5220\u9664\u7ebf ",style:new o({element:"del",overrides:[{element:"span",
attributes:{style:"text-decoration: line-through;"}},{element:"s"}]})},d))})});
