KISSY.Editor.add("font",function(d){d.addPlugin("font",function(){function v(a){for(var c=[],e=0;e<a.length;e++)c.push({name:a[e],value:a[e]});return c}var i=KISSY,f=i.Editor,n=f.Style,o=f.TripleButton,g=d.cfg.pluginConfig,j=g["font-size"],b,l,m;if(j!==false){j=j||{};i.mix(j,{items:v(["8px","10px","12px","14px","18px","24px","36px","48px","60px","72px","84px","96px"]),width:"55px"},false);var p={},q=[],h={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]};
for(k=0;k<j.items.length;k++){b=j.items[k];l=b.name;m=b.attrs;b=b.value;p[b]=new n(h,{size:b});q.push({name:l,value:b,attrs:m})}g["font-size"]=j}h=g["font-family"];if(h!==false){h=h||{};i.mix(h,{items:[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u96b6\u4e66",value:"LiSu"},{name:"\u6977\u4f53",value:"KaiTi_GB2312"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft YaHei"},{name:"Georgia",value:"Georgia"},{name:"Times New Roman",value:"Times New Roman"},{name:"Impact",value:"Impact"},{name:"Courier New",value:"Courier New"},
{name:"Arial",value:"Arial"},{name:"Verdana",value:"Verdana"},{name:"Tahoma",value:"Tahoma"}],width:"130px"},false);var r={},s=[],w={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},k;g["font-family"]=h;for(k=0;k<h.items.length;k++){b=h.items[k];l=b.name;m=b.attrs||{};b=b.value;m.style=m.style||"";m.style+=";font-family:"+b;r[b]=new n(w,{family:b});s.push({name:l,value:b,attrs:m})}}l={click:function(a){var c=a.newVal;a=a.prevVal;var e=this.cfg.styles;
d.focus();d.fire("save");e=e[c];if(c==a){e.remove(d.document);this.btn.set("value","")}else e.apply(d.document);d.fire("save")},selectionChange:function(a){a=a.path.elements;for(var c=this.cfg.styles,e=0,t;e<a.length;e++){t=a[e];for(var u in c)if(c[u].checkElementRemovable(t,true)){this.btn.set("value",u);return}}this.btn.reset("value")}};false!==g["font-size"]&&d.addSelect("font-size",i.mix({title:"\u5927\u5c0f",width:"30px",mode:f.WYSIWYG_MODE,showValue:true,popUpWidth:j.width,items:q,styles:p},l));false!==
g["font-family"]&&d.addSelect("font-family",i.mix({title:"\u5b57\u4f53",width:"110px",mode:f.WYSIWYG_MODE,popUpWidth:h.width,items:s,styles:r},l));f={mode:f.WYSIWYG_MODE,offClick:function(){var a=this.editor,c=this.cfg.style;a.fire("save");c.apply(a.document);a.fire("save");a.notifySelectionChange();a.focus()},onClick:function(){var a=this.editor,c=this.cfg.style;a.fire("save");c.remove(a.document);a.fire("save");a.notifySelectionChange();a.focus()},selectionChange:function(a){var c=this.btn;this.cfg.style.checkActive(a.path)?
c.set("state",o.ON):c.set("state",o.OFF)}};false!==g["font-bold"]&&d.addButton("font-bold",i.mix({contentCls:"ke-toolbar-bold",title:"\u7c97\u4f53 ",style:new n({element:"strong",overrides:[{element:"b"},{element:"span",attributes:{style:"font-weight: bold;"}}]})},f));false!==g["font-italic"]&&d.addButton("font-italic",i.mix({contentCls:"ke-toolbar-italic",title:"\u659c\u4f53 ",style:new n({element:"em",overrides:[{element:"i"},{element:"span",attributes:{style:"font-style: italic;"}}]})},f));false!==g["font-underline"]&&
d.addButton("font-underline",i.mix({contentCls:"ke-toolbar-underline",title:"\u4e0b\u5212\u7ebf ",style:new n({element:"u",overrides:[{element:"span",attributes:{style:"text-decoration: underline;"}}]})},f));false!==g["font-strikeThrough"]&&d.addButton("font-underline",i.mix({contentCls:"ke-toolbar-strikeThrough",title:"\u5220\u9664\u7ebf ",style:new n({element:"del",overrides:[{element:"span",attributes:{style:"text-decoration: line-through;"}},{element:"s"}]})},f))})},{attach:false});
