KISSY.Editor.add("font",function(h){function A(g){for(var o=[],i=0;i<g.length;i++)o.push({name:g[i],value:g[i]});return o}var j=KISSY,c=j.Editor,k=c.Style,r=c.TripleButton,f=h.cfg.pluginConfig,B=j.Node,l=f["font-size"];if(l!==false){l=l||{};j.mix(l,{items:A(["8px","10px","12px","14px","18px","24px","36px","48px","60px","72px","84px","96px"]),width:"55px"},false);var t={},w=[],p={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]};for(m=0;m<l.items.length;m++){var e=
l.items[m],u=e.name,s=e.attrs;e=e.value;t[e]=new k(p,{size:e});w.push({name:u,value:e,attrs:s})}f["font-size"]=l}t.inherit=new k(p,{size:"inherit"});var n=f["font-family"];if(n!==false){n=n||{};j.mix(n,{items:[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u96b6\u4e66",value:"LiSu"},{name:"\u6977\u4f53",value:"KaiTi_GB2312"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft YaHei"},{name:"Georgia",value:"Georgia"},{name:"Times New Roman",value:"Times New Roman"},{name:"Impact",value:"Impact"},{name:"Courier New",value:"Courier New"},
{name:"Arial",value:"Arial"},{name:"Verdana",value:"Verdana"},{name:"Tahoma",value:"Tahoma"}],width:"130px"},false);var v={},x=[],y={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},m;f["font-family"]=n;for(m=0;m<n.items.length;m++){e=n.items[m];u=e.name;s=e.attrs||{};p=e.value;s.style=s.style||"";s.style+=";font-family:"+p;v[p]=new k(y,{family:p});x.push({name:u,value:p,attrs:s})}}v.inherit=new k(y,{family:"inherit"});c.Font||function(){function g(a){g.superclass.constructor.call(this,
a);this._init()}function o(a){o.superclass.constructor.call(this,a);this._init()}g.ATTRS={title:{},html:{},styles:{},editor:{}};var i=c.Select;j.extend(g,j.Base,{_init:function(){var a=this.get("editor"),b=a.toolBarDiv;this.get("html");this.el=new i({container:b,doc:a.document,width:this.get("width"),popUpWidth:this.get("popUpWidth"),title:this.get("title"),items:this.get("html"),showValue:this.get("showValue"),menuContainer:new B(document.body)});this.el.on("click",this._vChange,this);a.on("selectionChange",
this._selectionChange,this);c.Utils.sourceDisable(a,this)},disable:function(){this.el.set("state",i.DISABLED)},enable:function(){this.el.set("state",i.ENABLED)},_vChange:function(a){var b=this.get("editor"),d=a.newVal;a=a.prevVal;var q=this.get("styles");b.focus();b.fire("save");q=q[d];if(d==a){q.remove(b.document);this.el.set("value","")}else q.apply(b.document);b.fire("save")},_selectionChange:function(a){this.get("editor");a=a.path.elements;for(var b=this.get("styles"),d=0,q;d<a.length;d++){q=
a[d];for(var z in b)if(b[z].checkElementRemovable(q,true)){this.el.set("value",z);return}}this.el.reset("value")}});o.ATTRS={editor:{},text:{},contentCls:{},title:{},style:{}};j.extend(o,j.Base,{_init:function(){var a=this.get("editor"),b=this.get("text");this.get("style");var d=this.get("title");this.el=new r({text:b,title:d,contentCls:this.get("contentCls"),container:a.toolBarDiv});this.el.on("offClick",this._on,this);this.el.on("onClick",this._off,this);a.on("selectionChange",this._selectionChange,
this);c.Utils.sourceDisable(a,this)},disable:function(){this.el.set("state",r.DISABLED)},enable:function(){this.el.set("state",r.OFF)},_on:function(){var a=this.get("editor");this.get("text");var b=this.get("style");this.get("title");a.fire("save");b.apply(a.document);a.fire("save");a.notifySelectionChange();a.focus()},_off:function(){var a=this.get("editor");this.get("text");var b=this.get("style");this.get("title");a.fire("save");b.remove(a.document);a.fire("save");a.notifySelectionChange();a.focus()},
_selectionChange:function(a){this.get("editor");this.get("text");var b=this.get("style");this.get("title");var d=this.el;a=a.path;if(d.get("state")!=r.DISABLED)b.checkActive(a)?d.set("state",r.ON):d.set("state",r.OFF)}});g.SingleFont=o;c.Font=g}();h.addPlugin(function(){false!==f["font-size"]&&new c.Font({editor:h,title:"\u5927\u5c0f",width:"30px",showValue:true,popUpWidth:l.width,styles:t,html:w});false!==f["font-family"]&&new c.Font({editor:h,title:"\u5b57\u4f53",width:"110px",popUpWidth:n.width,styles:v,html:x});
false!==f["font-bold"]&&new c.Font.SingleFont({contentCls:"ke-toolbar-bold",title:"\u7c97\u4f53 ",editor:h,style:new k({element:"strong",overrides:[{element:"b"},{element:"span",attributes:{style:"font-weight: bold;"}}]})});false!==f["font-italic"]&&new c.Font.SingleFont({contentCls:"ke-toolbar-italic",title:"\u659c\u4f53 ",editor:h,style:new k({element:"em",overrides:[{element:"i"},{element:"span",attributes:{style:"font-style: italic;"}}]})});false!==f["font-underline"]&&new c.Font.SingleFont({contentCls:"ke-toolbar-underline",
title:"\u4e0b\u5212\u7ebf ",editor:h,style:new k({element:"u",overrides:[{element:"span",attributes:{style:"text-decoration: underline;"}}]})});false!==f["font-strikeThrough"]&&new c.Font.SingleFont({contentCls:"ke-toolbar-strikeThrough",title:"\u5220\u9664\u7ebf ",editor:h,style:new k({element:"del",overrides:[{element:"span",attributes:{style:"text-decoration: line-through;"}},{element:"s"}]})})})});
