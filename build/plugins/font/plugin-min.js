KISSY.Editor.add("font",function(i){function z(h){for(var n=[],j=0;j<h.length;j++)n.push({name:h[j],value:h[j]});return n}var f=KISSY,d=f.Editor,o=d.Style,p=d.TripleButton,g=i.cfg.pluginConfig,A=f.Node,k=g["font-size"];if(k!==false){k=k||{};f.mix(k,{items:z(["8px","10px","12px","14px","18px","24px","36px","48px","60px","72px","84px","96px","108px"]),width:"55px"},false);var v={},w=[],s={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]};for(l=0;l<k.items.length;l++){var c=
k.items[l],t=c.name,q=c.attrs;c=c.value;v[c]=new o(s,{size:c});w.push({name:t,value:c,attrs:q})}g["font-size"]=k}var m=g["font-family"];if(m!==false){m=m||{};f.mix(m,{items:[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u96b6\u4e66",value:"LiSu"},{name:"\u6977\u4f53",value:"KaiTi_GB2312"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft YaHei"},{name:"Georgia",value:"Georgia"},{name:"Times New Roman",value:"Times New Roman"},{name:"Impact",value:"Impact"},{name:"Courier New",value:"Courier New"},{name:"Arial",value:"Arial"},
{name:"Verdana",value:"Verdana"},{name:"Tahoma",value:"Tahoma"}],width:"130px"},false);var x={},y=[];s={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]};var l;g["font-family"]=m;for(l=0;l<m.items.length;l++){c=m.items[l];t=c.name;q=c.attrs||{};c=c.value;q.style=q.style||"";q.style+=";font-family:"+c;x[c]=new o(s,{family:c});y.push({name:t,value:c,attrs:q})}}d.Font||function(){function h(a){h.superclass.constructor.call(this,a);this._init()}function n(a){n.superclass.constructor.call(this,
a);this._init()}h.ATTRS={title:{},html:{},styles:{},editor:{}};var j=d.Select;f.extend(h,f.Base,{_init:function(){var a=this.get("editor"),b=a.toolBarDiv;this.get("html");this.el=new j({container:b,doc:a.document,width:this.get("width"),popUpWidth:this.get("popUpWidth"),title:this.get("title"),items:this.get("html"),showValue:this.get("showValue"),menuContainer:new A(document.body)});this.el.on("click",this._vChange,this);a.on("selectionChange",this._selectionChange,this);d.Utils.sourceDisable(a,
this)},disable:function(){this.el.set("state",j.DISABLED)},enable:function(){this.el.set("state",j.ENABLED)},_vChange:function(a){var b=this.get("editor"),e=a.newVal;a=a.prevVal;var r=this.get("styles");b.focus();b.fire("save");if(e==a){r[e].remove(b.document);this.el.set("value","")}else r[e].apply(b.document);b.fire("save")},_selectionChange:function(a){this.get("editor");var b=a.path.elements,e=this.get("styles");f.log(a);a=0;for(var r;a<b.length;a++){r=b[a];for(var u in e)if(e[u].checkElementRemovable(r,
true)){f.log(u);this.el.set("value",u);return}}this.el.reset("value")}});n.ATTRS={editor:{},text:{},contentCls:{},title:{},style:{}};f.extend(n,f.Base,{_init:function(){var a=this.get("editor"),b=this.get("text");this.get("style");var e=this.get("title");this.el=new p({text:b,title:e,contentCls:this.get("contentCls"),container:a.toolBarDiv});this.el.on("offClick",this._on,this);this.el.on("onClick",this._off,this);a.on("selectionChange",this._selectionChange,this);d.Utils.sourceDisable(a,this)},disable:function(){this.el.set("state",
p.DISABLED)},enable:function(){this.el.set("state",p.OFF)},_on:function(){var a=this.get("editor");this.get("text");var b=this.get("style");this.get("title");a.fire("save");b.apply(a.document);a.fire("save");a.notifySelectionChange();a.focus()},_off:function(){var a=this.get("editor");this.get("text");var b=this.get("style");this.get("title");a.fire("save");b.remove(a.document);a.fire("save");a.notifySelectionChange();a.focus()},_selectionChange:function(a){this.get("editor");this.get("text");var b=
this.get("style");this.get("title");var e=this.el;a=a.path;if(e.get("state")!=p.DISABLED)b.checkActive(a)?e.set("state",p.ON):e.set("state",p.OFF)}});h.SingleFont=n;d.Font=h}();i.addPlugin(function(){false!==g["font-size"]&&new d.Font({editor:i,title:"\u5927\u5c0f",width:"30px",showValue:true,popUpWidth:k.width,styles:v,html:w});false!==g["font-family"]&&new d.Font({editor:i,title:"\u5b57\u4f53",width:"110px",popUpWidth:m.width,styles:x,html:y});false!==g["font-bold"]&&new d.Font.SingleFont({contentCls:"ke-toolbar-bold",
title:"\u7c97\u4f53 ",editor:i,style:new o({element:"strong",overrides:[{element:"b"},{element:"span",attributes:{style:"font-weight: bold;"}}]})});false!==g["font-italic"]&&new d.Font.SingleFont({contentCls:"ke-toolbar-italic",title:"\u659c\u4f53 ",editor:i,style:new o({element:"em",overrides:[{element:"i"},{element:"span",attributes:{style:"font-style: italic;"}}]})});false!==g["font-underline"]&&new d.Font.SingleFont({contentCls:"ke-toolbar-underline",title:"\u4e0b\u5212\u7ebf ",editor:i,style:new o({element:"u",overrides:[{element:"span",
attributes:{style:"text-decoration: underline;"}}]})});false!==g["font-strikeThrough"]&&new d.Font.SingleFont({contentCls:"ke-toolbar-strikeThrough",title:"\u5220\u9664\u7ebf ",editor:i,style:new o({element:"del",overrides:[{element:"span",attributes:{style:"text-decoration: line-through;"}},{element:"s"}]})})})});
