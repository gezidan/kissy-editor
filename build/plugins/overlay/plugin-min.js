KISSY.add("overlay",function(a){var b=a.Base.create([a.Ext.Box,a.Ext.ContentBox,a.Ext.Position,a.Ext.Loading,a.UA.ie==6?a.Ext.Shim:null,a.Ext.Align,a.Ext.Mask],{init:function(){a.log("Overlay init");this.on("bindUI",this._bindUIOverlay,this);this.on("renderUI",this._renderUIOverlay,this);this.on("syncUI",this._syncUIOverlay,this)},_renderUIOverlay:function(){a.log("_renderUIOverlay");this.get("el").addClass("ks-overlay")},_syncUIOverlay:function(){a.log("_syncUIOverlay")},_bindUIOverlay:function(){a.log("_bindUIOverlay")},
destructor:function(){a.log("overlay destructor")}},{ATTRS:{elOrder:0}});a.Overlay=b},{requires:["core"]});
KISSY.add("dialog",function(a){a.Dialog=a.Base.create(a.Overlay,[a.Ext.StdMod,a.Ext.Close,a.Ext.Drag,a.Ext.Constrain],{init:function(){a.log("dialog init");this.on("renderUI",this._rendUIDialog,this);this.on("bindUI",this._bindUIDialog,this);this.on("syncUI",this._syncUIDialog,this)},_rendUIDialog:function(){a.log("_rendUIDialog");this.get("el").addClass("ks-dialog");this.set("handlers",[this.get("header")])},_bindUIDialog:function(){a.log("_bindUIDialog")},_syncUIDialog:function(){a.log("_syncUIDialog")},
destructor:function(){a.log("Dialog destructor")}})},{host:"overlay"});
KISSY.Editor.add("ext-focus",function(){function a(){b.log("FocusExt init");this.on("renderUI",this._renderUIFocusExt,this);this.on("bindUI",this._bindUIFocusExt,this);this.on("syncUI",this._syncUIFocusExt,this)}var b=KISSY,f=b.UA,e=b.Editor,d=e.focusManager;e.namespace("Ext");a.ATTRS={focus4e:{value:true}};a.prototype={_uiSetFocus4e:function(c){if(c){this.on("show",this._show4FocusExt,this);this.on("hide",this._hide4FocusExt,this)}else{this.detach("show",this._show4FocusExt,this);this.detach("hide",
this._hide4FocusExt,this)}},_syncUIFocusExt:function(){b.log("_syncUIFocusExt")},_renderUIFocusExt:function(){b.log("_renderUIFocusExt")},_bindUIFocusExt:function(){this._focus4e=(new b.Node("<a href='#' class='ke-focus' style='width:0;height:0;margin:0;padding:0;overflow:hidden;outline:none;font-size:0;'></a>")).appendTo(this.get("el"))},_show4FocusExt:function(){var c=this._focusEditor=d.currentInstance();window.focus();document.body.focus();this._focus4e[0].focus();if(f.ie&&c){var g=c.document.selection.createRange();
if(g)if(g.item&&g.item(0).ownerDocument==c.document){c=document.body.createTextRange();c.moveToElementText(this.get("el")._4e_first()[0]);c.collapse(true);c.select()}}},_hide4FocusExt:function(){var c=this._focusEditor;c&&c.focus()}};e.Ext.Focus=a},{host:"overlay"});
KISSY.Editor.add("overlay",function(){var a=KISSY,b=a.Editor;if(!b.Overlay){var f=a.Base.create(a.Overlay,[b.Ext.Focus],{init:function(){a.log("Overlay4E init");this.on("syncUI",this._syncUIOverlay4E,this)},_syncUIOverlay4E:function(){a.log("_syncUIOverlay4E");b.Utils.preventFocus(this.get("contentEl"))}},{ATTRS:{zIndex:{value:b.baseZIndex(b.zIndexManager.OVERLAY)}}}),e=a.Base.create(a.Dialog,[b.Ext.Focus],{show:function(){this.center();var c=this.get("y");if(c-a.DOM.scrollTop()>200){c=a.DOM.scrollTop()+
200;this.set("y",c)}e.superclass.show.call(this)}},{ATTRS:{constrain:{value:true},zIndex:{value:b.baseZIndex(b.zIndexManager.OVERLAY)}}});b.Overlay=f;b.Dialog=e;var d;b.Overlay.loading=function(){d||(d=new b.Overlay({x:0,focus4e:false,width:"100%",y:0,zIndex:b.baseZIndex(b.zIndexManager.LOADING),elCls:"ke-global-loading"}));d.set("height",a.DOM.docHeight());d.show();d.loading()};b.Overlay.unloading=function(){d&&d.hide()}}});
