KISSY.Editor.add("bangpai-music",function(w){var k=KISSY,o=k.UA,v=k.Event,m=k.Editor,y=k.DOM,p=k.Node,x=m.Config.base+"theme/loading.gif",z=m.Flash,f="ke_xiami",a=w.htmlDataProcessor,e=a&&a.dataFilter;e&&e.addRules({elements:{object:function(g){var c=g.attributes,d=g.attributes.title,l;if(!(c.classid&&String(c.classid).toLowerCase())){for(c=0;c<g.children.length;c++){l=g.children[c];if(l.name=="embed"){if(!z.isFlashEmbed(l))break;if(/xiami\.com/i.test(l.attributes.src))return a.createFakeParserElement(g,
f,"bangpai-music",true,{title:d})}}return null}for(c=0;c<g.children.length;c++){l=g.children[c];if(l.name=="param"&&l.attributes.name=="movie")if(/xiami\.com/i.test(l.attributes.value))return a.createFakeParserElement(g,f,"bangpai-music",true,{title:d})}},embed:function(g){if(!z.isFlashEmbed(g))return null;if(/xiami\.com/i.test(g.attributes.src))return a.createFakeParserElement(g,f,"bangpai-music",true,{title:g.attributes.title})}}},4);m.BangPaiMusic||function(){function g(h){g.superclass.constructor.apply(this,
arguments);h.cfg.disableObjectResizing||v.on(h.document.body,o.ie?"resizestart":"resize",function(b){y.hasClass(b.target,f)&&b.preventDefault()})}function c(h){return u.replace(/\${([^}]+)}/g,function(b,i){return h[i]})}function d(h,b,i){return"<a class='ke-xiami-page-item ke-button"+(h==b?" ke-xiami-curpage":"")+"' data-value='"+b+"' href='#'>"+(i||b)+"</a>"}function l(h){return h._4e_name()==="img"&&!!h.hasClass(f)&&h}y.addStyleSheet(".ke-xiami-list {margin:10px 0 10px 0;padding:10px 40px 0 40px;border-top:1px solid #CED5E0;display:none;}.ke-xiami-list li{border:1px solid #CED5E0;border-width:0 0 1px 0;overflow:hidden;zoom:1;padding:2px;}.ke-xiami-list .ke-xiami-add {float:right;}.ke-xiami-list .ke-xiami-song {float:left;width:300px;white-space:nowrap;overflow:hidden;}.ke-xiami-paging a{display: inline-block; zoom: 1;  *display: inline; padding:1px 7px;margin:0 3px;}.ke-xiami-paging a:hover,.ke-xiami-paging a.ke-xiami-curpage {color:red;text-decoration:none;}.ke-xiami-paging {text-align:center;margin:20px -10px 0 -10px;}.ke-xiami-page-more {padding:0 10px;}",
"BangPaiMusic");window.bangpai_xiami=function(h){var b=bangpai_xiami.instance;h.page=bangpai_xiami.page;b._listSearch(h)};var u="http://www.xiami.com/app/nineteen/search/key/${key}/page/${page}?random=${random}&callback=bangpai_xiami";k.extend(g,z,{_config:function(){this._cls=f;this._type="bangpai-music";this._title="\u867e\u7c73\u5c5e\u6027";this._bodyHtml="<div style='padding:20px 0;'><form action='#' class='ke-xiami-form' style='margin:0 20px;'><p class='ke-xiami-title'></p><p class='ke-xiami-url-wrap'><input class='ke-xiami-url ke-input' style='width:350px;vertical-align:middle;'/> &nbsp;  <button class='ke-xiami-submit'>\u641c \u7d22</button></p><p style='margin:10px 0'><label>\u5bf9 \u9f50\uff1a <select class='ke-xiami-align'><option value=''>\u65e0</option><option value='left'>\u5de6\u5bf9\u9f50</option><option value='right'>\u53f3\u5bf9\u9f50</option></select></label><label style='margin-left:45px;'>\u95f4\u8ddd\uff1a  <input  data-verify='^\\d+$'  data-warning='\u95f4\u8ddd\u8bf7\u8f93\u5165\u975e\u8d1f\u6574\u6570' class='ke-xiami-margin ke-input' style='width:60px' value='5'/> \u50cf\u7d20</label></p></form><div class='ke-xiami-list'></div></div>";
this._footHtml="<a class='ke-xiami-ok ke-button' style='margin-right:20px;'>\u786e&nbsp;\u5b9a</a><a class='ke-xiami-cancel ke-button'>\u53d6&nbsp;\u6d88</a>";this._contentCls="ke-toolbar-music";this._tip="\u63d2\u5165\u867e\u7c73\u97f3\u4e50";this._contextMenu=s;this._flashRules=["img."+f];this._config_dwidth="480px"},_updateTip:function(h,b){var i=this.editor.restoreRealElement(b);if(i){h.html(b.attr("title"));h.attr("href",this._getFlashUrl(i))}},_initD:function(){function h(r){var q=n.val();if(q.replace(/[^\x00-\xff]/g,"@@").length>30)alert("\u957f\u5ea6\u4e0a\u965030\u4e2a\u5b57\u7b26\uff081\u4e2a\u6c49\u5b57=2\u4e2a\u5b57\u7b26\uff09");
else if(k.trim(q)){b._xiami_submit.disable();q={key:encodeURIComponent(n.val()),page:r,random:(new Date).valueOf()};q=c(q);bangpai_xiami.instance=b;bangpai_xiami.page=r;b._xiamia_list.html("<img style='display:block;width:32px;height:32px;margin:5px auto 0 auto;'src='"+x+"'/><p style='width: 130px; margin: 15px auto 0; color: rgb(150, 150, 150);'>\u6b63\u5728\u641c\u7d22\uff0c\u8bf7\u7a0d\u5019......</p>");b._xiamia_list.show();var t=k.getScript(q,{timeout:10,success:function(){},error:function(){t.src="";b._xiami_submit.enable();b._xiamia_list.html("<p style='text-align:center;margin:10px 0;'>\u4e0d\u597d\u610f\u601d\uff0c\u8d85\u65f6\u4e86\uff0c\u8bf7\u91cd\u8bd5\uff01</p>")}})}else alert("\u4e0d\u80fd\u4e3a\u7a7a\uff01")}
var b=this,i=b.editor,j=b.d;j.el.one(".ke-xiami-form");var n=j.el.one(".ke-xiami-url");b.dAlign=m.Select.decorate(j.el.one(".ke-xiami-align"));b._xiami_input=n;m.Utils.placeholder(n,"\u8f93\u5165\u6b4c\u66f2\u540d\u3001\u4e13\u8f91\u540d\u3001\u827a\u4eba\u540d");b._xiamia_list=j.el.one(".ke-xiami-list");b._xiami_submit=new m.TripleButton({el:j.el.one(".ke-xiami-submit"),cls:"ke-button",text:"\u641c&nbsp;\u7d22"});b._xiami_submit.on("offClick",function(){h(1)});n.on("keydown",function(r){r.keyCode===13&&h(1)});b.dMargin=j.el.one(".ke-xiami-margin");b._xiami_url_wrap=j.el.one(".ke-xiami-url-wrap");
b._xiamia_title=j.el.one(".ke-xiami-title");var A=j.foot.one(".ke-xiami-ok");j.foot.one(".ke-xiami-cancel").on("click",function(){j.hide()});A.on("click",function(){var r=b.selectedFlash,q=i.restoreRealElement(r);b._dinfo={url:b._getFlashUrl(q),attrs:{title:r.attr("title"),align:b.dAlign.val(),style:"margin:"+(parseInt(b.dMargin.val())||0)+"px;"}};b._gen()},b);b._xiamia_list.on("click",function(r){r.preventDefault();var q=new p(r.target);r=q._4e_ascendant(function(t){return b._xiamia_list._4e_contains(t)&&
t.hasClass("ke-xiami-add")},true);q=q._4e_ascendant(function(t){return b._xiamia_list._4e_contains(t)&&t.hasClass("ke-xiami-page-item")},true);if(r){b._dinfo={url:"http://www.xiami.com/widget/"+r.attr("data-value")+"/singlePlayer.swf",attrs:{title:r.attr("title"),align:b.dAlign.val(),style:"margin:"+(parseInt(b.dMargin.val())||0)+"px;"}};b._gen()}else q&&h(parseInt(q.attr("data-value")))})},_listSearch:function(h){var b,i=h.results,j="";if(h.key==k.trim(this._xiami_input.val())){this._xiami_submit.enable();
if(i&&i.length){j="<ul>";for(b=0;b<i.length;b++){var n=i[b],A=decodeURIComponent(n.song_name)+" - "+decodeURIComponent(n.artist_name);j=j;var r="<li title='"+A+"'><span class='ke-xiami-song'>",q=A;if(q.length>35)q=q.substring(0,35)+"...";j=j+(r+q+"</span><a href='#' title='"+A+"' class='ke-xiami-add' data-value='"+(n.album_id+"_"+n.song_id)+"'>\u6dfb\u52a0</a></li>")}j+="</ul>";i=h.page;h=Math.floor(h.total/8);b=i-1;n=i+1;if(h>1){j+="<p class='ke-xiami-paging'>";if(b<=2){n=Math.min(2-b+n,h-1);b=2}n=Math.min(n,
h-1);if(n==h-1)b=Math.max(2,n-3);if(i!=1)j+=d(i,i-1,"\u4e0a\u4e00\u9875");j+=d(i,1,"1");if(b!=2)j+="<span class='ke-xiami-page-more'>...</span>";for(b=b;b<=n;b++)j+=d(i,b);if(n!=h){if(n!=h-1)j+="<span class='ke-xiami-page-more'>...</span>";j+=d(i,h,h)}if(i!=h)j+=d(i,i+1,"\u4e0b\u4e00\u9875");j+="</p>"}}else j="<p style='text-align:center;margin:10px 0;'>\u4e0d\u597d\u610f\u601d\uff0c\u6ca1\u6709\u627e\u5230\u7ed3\u679c\uff01</p>";this._xiamia_list.html(j)}},_updateD:function(){var h=this.selectedFlash;if(h){this._xiami_input.val(h.attr("title"));this._xiamia_title.html(h.attr("title"));
this.dAlign.val(h.attr("align"));this.dMargin.val(parseInt(h._4e_style("margin"))||0);this._xiami_url_wrap.hide();this.d.foot.show();this._xiamia_title.show()}else{m.Utils.resetInput(this._xiami_input);this.dAlign.val("");this.dMargin.val("5");this._xiami_url_wrap.show();this.d.foot.hide();this._xiamia_title.hide();this._xiami_submit.enable()}this._xiamia_list.hide();this._xiamia_list.html("")},_getDInfo:function(){k.mix(this._dinfo.attrs,{width:257,height:33});return this._dinfo}});var s={"\u867e\u7c73\u5c5e\u6027":function(h){var b=
h.getSelection();b=b&&b.getStartElement();b=l(b);h=h._toolbars["bangpai-music"];b&&h.show(null,b)}};z.registerBubble("bangpai-music","\u867e\u7c73\u97f3\u4e50\uff1a ",l);m.BangPaiMusic=g}();w.addPlugin(function(){new m.BangPaiMusic(w)})},{attach:false,requires:["flashsupport"]});
KISSY.Editor.add("bangpai-sourcearea",function(w){var k=KISSY.Editor,o=KISSY,v=o.Node;UA=o.UA;TripleButton=k.TripleButton;if(!(UA.gecko<1.92)){k.BangPaiSourceArea||function(){function m(x){this.editor=x;this._init()}var y=k.SOURCE_MODE,p=k.WYSIWYG_MODE;o.augment(m,{_init:function(){var x=this.editor,z=x.statusDiv,f=this.el=(new v("<span style='zoom:1;display:inline-block;height:22px;line-height:22px;'><input style='margin:0 5px;vertical-align:middle;' type='checkbox' /><span style='vertical-align:middle;'>\u7f16\u8f91\u6e90\u4ee3\u7801</span></span>")).appendTo(z).one("input");
f.on("click",this._check,this);x.on("sourcemode",function(){f[0].checked=true});x.on("wysiwygmode",function(){f[0].checked=false})},_check:function(){this.el[0].checked?this._show():this._hide()},_show:function(){this.editor.execCommand("sourceAreaSupport",y)},_hide:function(){this.editor.execCommand("sourceAreaSupport",p)}});k.BangPaiSourceArea=m}();w.addPlugin(function(){new k.BangPaiSourceArea(w)})}},{attach:false,requires:["sourceareasupport"]});
KISSY.Editor.add("bangpai-upload",function(w){var k=KISSY,o=k.Editor;if(!o.BangPaiUpload){(function(){function v(a){this.editor=a;this._init()}var m=k.DOM,y=k.JSON,p=k.Node,x=o.SimpleOverlay,z=o.Config.base+o.Utils.debugUrl("plugins/uploader/uploader.swf"),f={};name="ke-bangpai-upload";m.addStyleSheet(".ke-upload-head {background-color: #f4f7fc;background: -webkit-gradient(linear, left top, left bottom, from(rgb(244, 247, 252)), to(rgb(235, 239, 244)));background: -moz-linear-gradient(top, rgb(244, 247, 252), rgb(235, 239, 244));filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#f4f7fc', endColorstr = '#ebeff4');height:40px;border-bottom:1px solid #CED5E0;padding-top:1px;}.ke-upload-head-text {height:30px;line-height:30px;width:120px;margin-top:8px;margin-left:30px;text-align:center;border:1px solid #CED5E0;border-bottom-color:#FDFDFD;background:#FDFDFD;padding-bottom:2px;margin-bottom:-2px;position:relative;}.ke-upload-btn-wrap {position:relative;padding:15px 20px 15px 10px;text-align:right;}.ke-upload-list {width:100%;}.ke-upload-list th {border-top:1px solid #c1c8d1;background-color:#EBEDF1;}.ke-upload-list td,.ke-upload-list th {padding:0.5em;text-align:center;border-bottom:1px solid #c1c8d1;}",
"ke-BangPaiUpload");k.augment(v,k.EventTarget,{_prepareShow:function(){var a=this,e=a.editor,g=e.cfg.pluginConfig["bangpai-upload"];a.dialog=new x({title:"\u6279\u91cf\u4e0a\u4f20",mask:false,focusMgr:false,width:"700px"});var c=a.dialog;c.foot.hide();var d=c.body,l=(new p("<div class='ke-upload-btn-wrap'><span style='margin:0 15px 0 0px;color:#969696;display:inline-block;vertical-align:middle;width:80%;'></span></div>")).appendTo(d),u=(new p("<div style='display:none'>")).appendTo(d),s=new o.TripleButton({text:"\u6d4f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u89c8",
cls:"ke-button",container:l}),h=s.el.offset(),b=s.el.width()*2,i=s.el.height()*1.5;d=(new p("<div style='"+("position:absolute;width:"+b+"px;height:"+i+"px;z-index:9999;")+"'>")).appendTo(l);var j=(new p("<div><table class='ke-upload-list'><thead><tr><th>\u5e8f\u53f7</th><th>\u56fe\u7247</th><th>\u5927\u5c0f</th><th style='width:30%'>\u4e0a\u4f20\u8fdb\u5ea6</th><th>\u56fe\u7247\u64cd\u4f5c</th></tr></thead><tbody></tbody></table></div>")).appendTo(u),n=j.one("tbody"),A=(new p("<p style='margin:15px 20px 35px; 0;text-align:right;'><a class='ke-button ke-bangpiaupload-ok'>\u786e\u5b9a\u4e0a\u4f20</a><a class='ke-button ke-bangpiaupload-insertall' style='margin-left:20px;'>\u5168\u90e8\u63d2\u5165</a></p>")).appendTo(u),
r=A.one(".ke-bangpiaupload-ok");A=A.one(".ke-bangpiaupload-insertall");k.guid(name);var q=(new p("<span></span>")).insertBefore(r);g.extraHtml&&j.append(g.extraHtml);a.statusText=q;a.btn=s;a.up=r;d.offset(h);s=new o.FlashBridge({movie:z,methods:["removeFile","cancel","removeFile","disable","enable","setAllowMultipleFiles","setFileFilters","uploadAll"],holder:d,attrs:{width:b,height:i},params:{wmode:"transparent"},flashVars:{allowedDomain:location.hostname,menu:true}});a.flashPos=d;a.uploader=s;a._list=
n;a._listTable=n.parent("table");a._listWrap=u;a._ds=g.serverUrl;a._dsp=g.serverParams||{};a._fileInput=g.fileInput||"Filedata";a._sizeLimit=g.sizeLimit||1E3;a._numberLimit=g.numberLimit||15;l.one("span").html("\u5141\u8bb8\u7528\u6237\u540c\u65f6\u4e0a\u4f20"+a._numberLimit+"\u5f20\u56fe\u7247\uff0c\u5355\u5f20\u56fe\u7247\u5bb9\u91cf\u4e0d\u8d85\u8fc7"+a._sizeLimit/1E3+"M");A.on("click",function(){trs=n.all("tr");for(var t=0;t<trs.length;t++){var B=new p(trs[t]),C=B.attr("url");if(C){e.insertElement(new p("<p>&nbsp;<img src='"+C+"'/>&nbsp;</p>",null,e.document));a._removeTrFile(B)}}if(C){u.hide();
c.hide()}});n.on("click",function(t){var B=new p(t.target);t.halt();if(B.hasClass("ke-upload-insert")){t=B.parent("tr");url=t.attr("url");e.insertElement(new p("<img src='"+url+"'/>",null,e.document))}if(B.hasClass("ke-upload-delete")||B.hasClass("ke-upload-insert")){t=B.parent("tr");a._removeTrFile(t)}});s.on("fileSelect",a._onSelect,a);s.on("uploadStart",a._onUploadStart,a);s.on("uploadProgress",a._onProgress,a);s.on("uploadComplete",a._onComplete,a);s.on("uploadCompleteData",a._onUploadCompleteData,
a);s.on("swfReady",a._ready,a);s.on("uploadError",a._uploadError,a)},_removeTrFile:function(a){var e=a.attr("fid"),g=this.uploader;try{g.cancel(e)}catch(c){}g.removeFile(e);if(f[e]){f[e].destroy();delete f[e]}a._4e_remove();this.denable();this._seqPics()},_init:function(){var a=this.editor,e=new o.TripleButton({contentCls:"ke-toolbar-mul-image",title:"\u6279\u91cf\u63d2\u56fe",container:a.toolBarDiv});e.on("offClick",this.show,this);this.el=e;o.Utils.lazyRun(this,"_prepareShow","_realShow");o.Utils.sourceDisable(a,this)},
disable:function(){this.el.disable()},enable:function(){this.el.boff()},_realShow:function(){this.dialog.show()},show:function(){this._prepareShow()},_uploadError:function(a){var e=a.id,g=this._getFileTr(e);e=f[e];if(g){e&&e.destroy();g.one(".ke-upload-progress").html("<div style='color:red;'>"+a.status+"</div>")}},_getFileTr:function(a){for(var e=this._list.all("tr"),g=0;g<e.length;g++){var c=new p(e[g]);if(c.attr("fid")==a)return c}},_onUploadStart:function(a){this.uploader.removeFile(a.id)},_onComplete:function(){},
_onUploadCompleteData:function(a){var e=k.trim(a.data).replace(/\\r||\\n/g,"");a=a.id;if(e){e=y.parse(e);if(e.error)this._uploadError({id:a,status:e.error});else{if(a=this._getFileTr(a)){a.one(".ke-upload-insert").show();a.attr("url",e.imgUrl)}this._seqPics()}}},_onProgress:function(a){var e=Math.floor(a.bytesLoaded*100/a.bytesTotal);(a=f[a.id])&&a.set("progress",e)},ddisable:function(){this.uploader.disable();this.btn.disable();this.flashPos.offset({left:-9999,top:-9999})},denable:function(){this.uploader.enable();
this.btn.enable();this.flashPos.offset(this.btn.el.offset())},_seqPics:function(){var a=this._list,e=1,g=a.all("tr");a.all(".ke-upload-seq").each(function(d){d.html(e++)});for(var c=a=0;c<g.length;c++)(new p(g[c])).attr("url")||a++;this.statusText.html("\u961f\u5217\u4e2d\u5269\u4f59"+a+"\u5f20\u56fe\u7247\uff0c\u70b9\u51fb\u786e\u5b9a\u4e0a\u4f20\uff0c\u5f00\u59cb\u4e0a\u4f20\u3002 ")},_getFilesSize:function(a){var e=0,g;for(g in a)a.hasOwnProperty(g)&&e++;return e},_onSelect:function(a){var e=this.uploader,g=this._list,c=0;a=a.fileList;var d=this._numberLimit;if(a){var l=this._getFilesSize(a);l>d&&
alert("\u7cfb\u7edf\u5c06\u53ea\u4fdd\u7559 n \u5f20".replace(/n/,this._numberLimit));l>=d&&this.ddisable();d=g.children("tr");for(g=0;g<d.length;g++)(l=m.attr(d[g],"fid"))&&a[l]&&delete a[l];d=this._numberLimit-d.length;this._listWrap.show();l=this._list[0];for(g in a)if(a.hasOwnProperty(g)){c++;var u=a[g],s=Math.floor(u.size/1E3),h=u.id;if(c>d)e.removeFile(h);else{var b=l.insertRow(-1);m.attr(b,"fid",h);var i=b.insertCell(-1);m.attr(i,"class","ke-upload-seq");i=b.insertCell(-1);m.html(i,u.name);i=b.insertCell(-1);m.html(i,s+"k");
i=b.insertCell(-1);m.attr(i,"class","ke-upload-progress");i=b.insertCell(-1);m.html(i,"<a href='#' class='ke-upload-insert' style='display:none'>[\u63d2\u5165]</a> &nbsp; <a href='#' class='ke-upload-delete'>[\u5220\u9664]</a> &nbsp;");b=new p(b);b.one(".ke-upload-progress");if(s>this._sizeLimit){this._uploadError({id:h,status:"\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 n M".replace(/n/,this._sizeLimit/1E3)});e.removeFile(h)}else f[h]=new o.ProgressBar({container:b.one(".ke-upload-progress"),width:"100px",height:"18px"})}}this._seqPics()}},_ready:function(){var a=
this,e=a.uploader,g=a.up,c=a.btn,d=a.flashPos,l=o.Utils.normParams;c.enable();d.offset(c.el.offset());e.setAllowMultipleFiles(true);e.setFileFilters([{extensions:"*.jpeg;*.jpg;*.png;*.gif",description:"\u56fe\u7247\u6587\u4ef6( png,jpg,jpeg,gif )"}]);g.on("click",function(u){u.halt();e.uploadAll(a._ds,"POST",l(a._dsp),a._fileInput)})}});o.BangPaiUpload=v})();w.addPlugin(function(){new o.BangPaiUpload(w)})}},{attach:false,requires:["flashutils","progressbar","flashbridge","overlay"]});
KISSY.Editor.add("bangpai-video",function(w){function k(f){for(var a=0;a<z.length;a++){var e=z[a];if(e.reg.test(f))return e}}var o=KISSY,v=o.Editor,m="ke_video",y=v.Flash,p=w.htmlDataProcessor,x=p&&p.dataFilter;x&&x.addRules({elements:{object:function(f){var a=f.attributes;if(!(a.classid&&String(a.classid).toLowerCase())){for(a=0;a<f.children.length;a++)if(f.children[a].name=="embed"){if(!y.isFlashEmbed(f.children[a]))break;if(k(f.children[a].attributes.src))return p.createFakeParserElement(f,m,"bangpai-video",
true)}return null}for(a=0;a<f.children.length;a++){var e=f.children[a];if(e.name=="param"&&e.attributes.name=="movie")if(k(e.attributes.value))return p.createFakeParserElement(f,m,"bangpai-video",true)}},embed:function(f){if(!y.isFlashEmbed(f))return null;if(k(f.attributes.src))return p.createFakeParserElement(f,m,"bangpai-video",true)}}},4);var z=[{reg:/youku\.com/i,width:480,height:400,detect:function(f){var a=f.match(/id_([^.]+)\.html$/);if(a)return"http://player.youku.com/player.php/sid/"+a[1]+
"/v.swf";f.match(/v_playlist\/([^.]+)\.html$/);return f}},{reg:/tudou\.com/i,width:480,height:400,detect:function(f){return f}},{reg:/ku6\.com/i,width:480,height:400,detect:function(f){var a=f.match(/show[^\/]*\/([^.]+)\.html$/);if(a)return"http://player.ku6.com/refer/"+a[1]+"/v.swf";return f}}];v.BangPaiVideo||function(){function f(){f.superclass.constructor.apply(this,arguments)}function a(c){return c._4e_name()==="img"&&!!c.hasClass(m)&&c}var e=["img."+m];o.extend(f,y,{_config:function(){var c=
this.editor.cfg.pluginConfig;this._cls=m;this._type="bangpai-video";this._title="\u89c6\u9891\u5c5e\u6027";this._bodyHtml="<div style='padding:20px 20px 0 20px'><p><label>\u94fe\u63a5\uff1a <input class='ke-video-url ke-input' style='width:300px'/></label></p><table style='margin:10px 0 5px  40px;width:300px;'><tr><td><label>\u5bbd\u5ea6\uff1a  <input  data-verify='^(\u81ea\u52a8|((?!0$)\\d+))$'  data-warning='\u5bbd\u5ea6\u8bf7\u8f93\u5165\u6b63\u6574\u6570' class='ke-video-width ke-input' style='width:60px' value='\u81ea\u52a8'/> \u50cf\u7d20</label></td><td><label> \u9ad8\u5ea6\uff1a  <input  data-verify='^(\u81ea\u52a8|((?!0$)\\d+))$'  data-warning='\u9ad8\u5ea6\u8bf7\u8f93\u5165\u6b63\u6574\u6570' class='ke-video-height ke-input' style='width:60px' value='\u81ea\u52a8'/> \u50cf\u7d20</label></td></tr><tr><td><label>\u5bf9\u9f50\uff1a <select class='ke-video-align'><option value=''>\u65e0</option><option value='left'>\u5de6\u5bf9\u9f50</option><option value='right'>\u53f3\u5bf9\u9f50</option></select></td><td><label>\u95f4\u8ddd\uff1a <input  data-verify='^\\d+$'  data-warning='\u95f4\u8ddd\u8bf7\u8f93\u5165\u975e\u8d1f\u6574\u6570' class='ke-video-margin ke-input' style='width:60px' value='5'/> \u50cf\u7d20</label></td></tr></table></div>";
this._footHtml="<a class='ke-video-ok ke-button' style='margin-left:40px;margin-right:20px;'>\u786e\u5b9a</button> <a class='ke-video-cancel ke-button'>\u53d6\u6d88</a>";this._contentCls="ke-toolbar-video";this._tip="\u63d2\u5165\u89c6\u9891";this._contextMenu=g;this._flashRules=e;this.urlCfg=c["bangpai-video"]&&c["bangpai-video"].urlCfg;this._urlTip="\u652f\u6301 \u571f\u8c46\uff0c\u4f18\u9177\uff0cku6 \u89c6\u9891\u5206\u4eab";this._config_dwidth="400px"},_initD:function(){var c=this.d,d=c.el;this.dUrl=d.one(".ke-video-url");this.dAlign=v.Select.decorate(d.one(".ke-video-align"));this.dMargin=
d.one(".ke-video-margin");this.dWidth=d.one(".ke-video-width");this.dHeight=d.one(".ke-video-height");var l=d.one(".ke-video-ok");d=d.one(".ke-video-cancel");l.on("click",this._gen,this);d.on("click",function(){c.hide()});v.Utils.placeholder(this.dUrl,this._urlTip)},_getDInfo:function(){var c=this.dUrl.val(),d=k(c);if(d){if(c=d.detect(c))return{url:c,attrs:{height:parseInt(this.dHeight.val())||d.height,width:parseInt(this.dWidth.val())||d.width,align:this.dAlign.val(),style:"margin:"+(parseInt(this.dMargin.val())||
0)+"px;"}}}else alert("\u4e0d\u652f\u6301\u8be5\u94fe\u63a5\u6765\u6e90!")},_gen:function(){var c=this.dUrl.val(),d=this.urlCfg;if(d)for(var l=0;l<d.length;l++){var u=d[l];if(u.reg.test(c)){this.d.loading();f.dynamicUrl.origin=c;f.dynamicUrl.instance=this;o.getScript(u.url.replace(/@url@/,encodeURIComponent(c)).replace(/@callback@/,encodeURIComponent("KISSY.Editor.BangPaiVideo.dynamicUrl")));return}}f.superclass._gen.call(this)},_dynamicUrlPrepare:function(c){this.dUrl.val(c);this.d.unloading();f.superclass._gen.call(this)},_updateD:function(){var c=
this.editor,d=this.selectedFlash;if(d){c=c.restoreRealElement(d);this.dUrl.val(this._getFlashUrl(c));this.dAlign.val(c.attr("align"));this.dMargin.val(parseInt(c._4e_style("margin"))||0);d.css("width")&&this.dWidth.val(parseInt(d.css("width")));d.css("height")&&this.dHeight.val(parseInt(d.css("height")))}else{v.Utils.resetInput(this.dUrl);this.dAlign.val("");this.dMargin.val("5");this.dWidth.val("\u81ea\u52a8");this.dHeight.val("\u81ea\u52a8")}}});f.dynamicUrl=function(c,d){c===f.dynamicUrl.origin&&f.dynamicUrl.instance._dynamicUrlPrepare(d)};
y.registerBubble("bangpai-video","\u89c6\u9891\u94fe\u63a5\uff1a ",a);v.BangPaiVideo=f;var g={"\u89c6\u9891\u5c5e\u6027":function(c){var d=c.getSelection();d=(d=d&&d.getStartElement())&&a(d);c=c._toolbars["bangpai-video"];d&&c.show(null,d)}}}();w.addPlugin(function(){new v.BangPaiVideo(w)})},{attach:false,requires:["flashsupport"]});
