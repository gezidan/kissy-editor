KISSY.Editor.add("bangpai-video",function(k){function i(a){for(var b=0;b<l.length;b++){var c=l[b];if(c.reg.test(a))return c}}var m=KISSY,f=m.Editor,g="ke_video",j=f.Flash,h=k.htmlDataProcessor,n=h&&h.dataFilter,l=[{reg:/youku\.com/i,width:480,height:400,detect:function(a){var b=a.match(/id_([^.]+)\.html$/);if(b)return"http://player.youku.com/player.php/sid/"+b[1]+"/v.swf";a.match(/v_playlist\/([^.]+)\.html$/);return a}},{reg:/tudou\.com/i,width:480,height:400,detect:function(a){return a}},{reg:/ku6\.com/i,
width:480,height:400,detect:function(a){var b=a.match(/show[^\/]*\/([^.]+)\.html$/);if(b)return"http://player.ku6.com/refer/"+b[1]+"/v.swf";return a}}];n&&n.addRules({elements:{object:function(a){var b=a.attributes;if(!(b.classid&&String(b.classid).toLowerCase())){for(b=0;b<a.children.length;b++)if(a.children[b].name=="embed"){if(!j.isFlashEmbed(a.children[b]))break;if(i(a.children[b].attributes.src))return h.createFakeParserElement(a,g,"bangpai-video",true)}return null}for(b=0;b<a.children.length;b++){var c=
a.children[b];if(c.name=="param"&&c.attributes.name=="movie")if(i(c.attributes.value))return h.createFakeParserElement(a,g,"bangpai-video",true)}},embed:function(a){if(!j.isFlashEmbed(a))return null;if(i(a.attributes.src))return h.createFakeParserElement(a,g,"bangpai-video",true)}}},4);f.BangPaiVideo||function(){function a(){a.superclass.constructor.apply(this,arguments)}function b(d){return d._4e_name()==="img"&&!!d.hasClass(g)&&d}var c=["img."+g];a.getProvider=i;m.extend(a,j,{_config:function(){this._cls=
g;this._type="bangpai-video";this._contentCls="ke-toolbar-video";this._tip="\u63d2\u5165\u89c6\u9891";this._contextMenu=o;this._flashRules=c}});j.registerBubble("bangpai-video","\u89c6\u9891\u94fe\u63a5\uff1a ",b);f.BangPaiVideo=a;var o={"\u89c6\u9891\u5c5e\u6027":function(d){var e=d.getSelection();e=(e=e&&e.getStartElement())&&b(e);d=d._toolbars["bangpai-video"];e&&d.show(null,e)}};f.add({"bangpai-video/dialog":{attach:false,charset:"utf-8",requires:["flash/dialog"],path:f.Utils.debugUrl("biz/bangpai/plugins/video/dialog/plugin.js?t=2010-10-25 21:09:11")}})}();k.addPlugin(function(){new f.BangPaiVideo(k)})},
{attach:false,requires:["flash/support"]});
