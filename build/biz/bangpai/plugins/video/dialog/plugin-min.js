KISSY.Editor.add("bangpai-video/dialog",function(h){var e=KISSY,d=e.Editor,c=d.BangPaiVideo;c.Dialog||function(){function f(){f.superclass.constructor.apply(this,arguments)}var j=c.getProvider;e.extend(f,d.Flash.FlashDialog,{_config:function(){var b=this.editor.cfg.pluginConfig;this._cls="ke_video";this._type="bangpai-video";this._title="\u89c6\u9891";this._bodyHtml="<div style='padding:20px 20px 0 20px'><p><label>\u94fe\u63a5\uff1a <input class='ke-video-url ke-input' style='width:410px;vertical-align:middle;'/></label></p><table style='margin:10px 0 5px  40px;width:400px;'><tr><td><label>\u5bbd\u5ea6\uff1a  <input  data-verify='^(\u81ea\u52a8|((?!0$)\\d+))$'  data-warning='\u5bbd\u5ea6\u8bf7\u8f93\u5165\u6b63\u6574\u6570' class='ke-video-width ke-input' style='width:60px;margin-left:2px;vertical-align:middle;' value='\u81ea\u52a8'/> \u50cf\u7d20</label></td><td><label> \u9ad8\u5ea6\uff1a  <input  data-verify='^(\u81ea\u52a8|((?!0$)\\d+))$'  data-warning='\u9ad8\u5ea6\u8bf7\u8f93\u5165\u6b63\u6574\u6570' class='ke-video-height ke-input' style='width:60px;vertical-align:middle;' value='\u81ea\u52a8'/> \u50cf\u7d20</label></td></tr><tr><td><label>\u5bf9\u9f50\uff1a <select class='ke-video-align'><option value='none'>\u65e0</option><option value='left'>\u5de6\u5bf9\u9f50</option><option value='right'>\u53f3\u5bf9\u9f50</option></select></td><td><label>\u95f4\u8ddd\uff1a <input  data-verify='^\\d+$'  data-warning='\u95f4\u8ddd\u8bf7\u8f93\u5165\u975e\u8d1f\u6574\u6570' class='ke-video-margin ke-input' style='width:60px;vertical-align:middle;' value='5'/> \u50cf\u7d20</label></td></tr></table></div>";
this._footHtml="<a class='ke-video-ok ke-button' style='margin-left:40px;margin-right:20px;'>\u786e\u5b9a</button> <a class='ke-video-cancel ke-button'>\u53d6\u6d88</a>";this.urlCfg=b["bangpai-video"]&&b["bangpai-video"].urlCfg;this._urlTip="\u8bf7\u8f93\u5165\u4f18\u9177\u7f51\u3001\u571f\u8c46\u7f51\u3001\u91776\u7f51\u7684\u89c6\u9891\u64ad\u653e\u9875\u94fe\u63a5..."},_initD:function(){var b=this.d,a=b.el;this.dUrl=a.one(".ke-video-url");this.dAlign=d.Select.decorate(a.one(".ke-video-align"));this.dMargin=a.one(".ke-video-margin");this.dWidth=a.one(".ke-video-width");this.dHeight=a.one(".ke-video-height");var g=a.one(".ke-video-ok");
a=a.one(".ke-video-cancel");g.on("click",this._gen,this);a.on("click",function(){b.hide()});d.Utils.placeholder(this.dUrl,this._urlTip)},_getDInfo:function(){var b=this.dUrl.val(),a=j(b);if(a)if(b=a.detect(b))return{url:b,attrs:{height:parseInt(this.dHeight.val())||a.height,width:parseInt(this.dWidth.val())||a.width,style:"margin:"+(parseInt(this.dMargin.val())||0)+"px;float:"+this.dAlign.val()+";"}};else alert("\u4e0d\u652f\u6301\u8be5\u94fe\u63a5\u6765\u6e90!");else alert("\u4e0d\u652f\u6301\u8be5\u94fe\u63a5\u6765\u6e90!")},_gen:function(){var b=this.dUrl.val(),a=this.urlCfg;
if(a)for(var g=0;g<a.length;g++){var i=a[g];if(i.reg.test(b)){this.d.loading();c.dynamicUrl.origin=b;c.dynamicUrl.instance=this;setTimeout(function(){e.getScript(i.url.replace(/@url@/,encodeURIComponent(b)).replace(/@callback@/,encodeURIComponent("KISSY.Editor.BangPaiVideo.dynamicUrl")))},30);return}}f.superclass._gen.call(this)},_dynamicUrlPrepare:function(b){this.dUrl.val(b);this.d.unloading();f.superclass._gen.call(this)},_updateD:function(){var b=this.editor,a=this.selectedFlash;if(a){b=b.restoreRealElement(a);
this.dUrl.val(this._getFlashUrl(b));this.dAlign.val(a.css("float"));this.dMargin.val(parseInt(b._4e_style("margin"))||0);a.css("width")&&this.dWidth.val(parseInt(a.css("width")));a.css("height")&&this.dHeight.val(parseInt(a.css("height")))}else{d.Utils.resetInput(this.dUrl);this.dAlign.val("none");this.dMargin.val("5");this.dWidth.val("\u81ea\u52a8");this.dHeight.val("\u81ea\u52a8")}}});c.dynamicUrl=function(b,a){e.trim(b)==e.trim(c.dynamicUrl.origin)&&c.dynamicUrl.instance._dynamicUrlPrepare(a)};c.Dialog=f}();h.addDialog("bangpai-video/dialog",
new d.BangPaiVideo.Dialog(h))});
