KISSY.Editor.add("bangpai-upload",function(k){var e=KISSY,g=e.Editor;if(!g.BangPaiUpload){(function(){function i(a){this.editor=a;this._init()}var j=[],l=g.Config.base+g.Utils.debugUrl("biz/bangpai/plugins/upload/uploader.swf"),f=e.Node;e.augment(i,e.EventTarget,{_init:function(){var a=this.editor.cfg.pluginConfig["bangpai-upload"].holder,b=e.isString(a)?e.one(a):a,c=(new f("<div style='position:relative'>")).appendTo(b);a=(new f("<button disabled='disabled'>选择文件</button>")).appendTo(c);var d=a.offset(),
h=c.offset();c=(new f("<div style='"+("position:absolute;top:"+(h.top-d.top)+"px;left:"+(h.left-d.left)+"px;width:"+a.width()+"px;height:"+a.height()+"px;z-index:9999;")+"'>")).appendTo(c);d=(new f("<table>")).appendTo(b);b=(new f("<p><button>开始上传</button></p>")).appendTo(b);h=e.guid("ke-bangpai-upload");d=(new f("<tbody>")).appendTo(d);j[h]=this;this.btn=a;this.up=b;this.on("contentReady",this._ready,this);this.flash=g.Utils.flash.createSWFRuntime(l,{holder:c,attrs:{allowScriptAccess:"always",allowNetworking:"all",
scale:"noScale",width:a.width(),height:a.height()},flashVars:{allowedDomain:location.hostname,shareData:true,swfID:h,jsEntry:"KISSY.Editor.BangPaiUpload.EventHandler",browser:"ke-bangpai-upload",useCompression:true,hand:true,btn:true}});this._list=d;this.on("select",this._onSelect,this)},_onSelect:function(a){var b=this._list;if(a=a.files)for(var c=0;c<a.length;c++){var d=a[c];(new f("<tr><td>"+d.name+"</td><td>"+d.name+"</td></tr>")).appendTo(b)}},_ready:function(){var a=this.flash;this.btn[0].disabled=
false;a.browse(false,[{desc:"图片文件( png,jpg,jpeg,gif )",ext:"*.jpeg;*.jpg;*.png;*.gif"}])},_eventHandler:function(a){var b=a.type;if(b==="log")e.log(a.message);else b&&this.fire(b,a)}});i.EventHandler=function(a,b){j[a]._eventHandler.call(j[a],b)};g.BangPaiUpload=i})();k.addPlugin(function(){new g.BangPaiUpload(k)})}},{attach:false,requires:["flashutils"]});
